var WSB;(function(n){var t;(function(t){var i;(function(i){i.FileRequestCard=({answer:n})=>{const{answerId:t,answerType:u}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerId:t,answerType:u,wrappedComponentName:"FileRequestCard"},React.createElement(i.M365HeaderCard,null,React.createElement(r,{answer:n})))};const r=({answer:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("FileRequest");const[h,y]=React.useState(!1),[e,c]=React.useState(!1),p=()=>c(!0),w=()=>c(!1),l="mdbdsb-fr-see-more-less-text-button";i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel(!0)},[h,e]);const{answerId:b,answerType:k,preview:o,requestedFile:d,link:g,title:nt,requestor:s,modality:tt,instrumentedItem:it,subItemInstrumentedItem:rt}=r,a=n.msbDsbHost.getLocString("RequestedFileText"),ut=n.msbDsbHost.getLocString("SingleFileSuggestionText"),ft=i.useDispatchLaunchUriAction(),f=React.useRef(null),v=React.useRef(null),[et,ot]=i.useSuggestionsInfoTooltipDimensions(v);return React.useEffect(()=>{const n=new IntersectionObserver((n,t)=>{var i;if((i=n[0])===null||i===void 0?void 0:i.isIntersecting){const n=f.current;(n===null||n===void 0?void 0:n.clientWidth)&&y(n.clientHeight<n.scrollHeight||n.clientWidth<n.scrollWidth);t.disconnect()}});return f.current?(n.observe(f.current),()=>{n.disconnect()}):()=>{}},[f.current]),React.createElement("div",null,React.createElement(i.FeedCardBase,{onClick:()=>{ft(g)},additionalCssClasses:"msbdsb_filerequest_card msbdsb_selectable",isClickable:!0,accessibilityProps:{role:"article",ariaLabel:i.combineLabelAndHintText(s.fullName+", "+a,n.msbDsbHost.getLocString("OpenInOutlookHintText"))},instrumentedItem:it,dismissalInstrumentedItem:rt,answerId:b,answerType:k},React.createElement("div",{className:"msbdsb_feed_item_header"},React.createElement("div",{id:"msbdsb_feed_item_title",className:"msbdsb_feed_item_title"},React.createElement("span",{className:"person_icon_container"},React.createElement(i.PersonIcon,{additionalCssClass:"small_person_icon",person:s})),React.createElement("div",{className:"msbdsb_person_name requestor_name_text"},s.fullName),React.createElement("div",{className:"msbdsb_annotation"},a))),React.createElement("div",{className:"horizontal_stack filerequest_info_header extra_margin"},React.createElement("div",{className:"horizontal_stack hideable"},tt==="Email"?React.createElement(i.OutlookIcon,{cssClasses:"filerequest_icon"}):React.createElement(i.TeamsIcon,{cssClasses:"filerequest_icon"}),React.createElement("div",{className:"filerequest_title"},nt))),React.createElement("div",{className:`filerequest_preview_body ${e?"longer_version":"short_version"}`,ref:f},h&&!e&&React.createElement(React.Fragment,null,React.createElement("div",{className:"see_more_pusher"}),React.createElement("button",{id:l,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:"text_snippet_button see_more_text msbdsb_button",onClick:n=>{n.stopPropagation(),p()}},n.msbDsbHost.getLocString("SeeMoreButtonText"))),o.isHtml?React.createElement("span",{className:"filerequest_text",dangerouslySetInnerHTML:{__html:o.messageContent}}):React.createElement("span",{className:"filerequest_text"},o.messageContent),e&&React.createElement("div",null,React.createElement("button",{id:l,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:"text_snippet_button msbdsb_button",onClick:n=>{n.stopPropagation(),w()}},n.msbDsbHost.getLocString("SeeLessButtonText")))),React.createElement("hr",{className:"msbdsb_divider"}),React.createElement("div",{className:"file_suggestion",ref:v},React.createElement("div",{className:"suggestion_header_container"},React.createElement("span",{className:"suggestion_header"},ut),React.createElement(i.SuggestedInfoIcon,{containerLeft:et,containerRight:ot})),React.createElement(u,{file:d,answer:r}))))},u=({file:u,answer:r})=>{const l=i.useDispatchLaunchUriAction(),{title:o,url:s,fileExtension:a}=u,{answerId:v}=r,y=()=>{l(s)},p=n.msbDsbHost.getLocString("CopyLinkButtonToolTipText"),w=n.msbDsbHost.getLocString("CopyLinkButtonHintText",o),c=n.msbDsbHost.getLocString("CopiedIconToolTipText"),b=()=>{f&&(SearchAppWrapper.CortanaApp.copyToClipboard(s,s),h(!1))},k=i.useFileIcon(a),[f,h]=React.useState(!0),e=React.useRef(null);return React.createElement("button",{ref:e,onMouseLeave:()=>h(!0),onBlur:()=>h(!0),id:"msbdsb-file-request-suggested-file",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:"link","aria-label":i.combineLabelAndHintText(o,n.msbDsbHost.getLocString("OpenInBrowserHintText")),className:"suggested_entity file_request_file msbdsb_nested_button msb-dsb-tooltip msb-dsb-item-with-feedback",onClick:n=>{n.stopPropagation(),y()}},React.createElement("div",{className:"horizontal_stack hideable"},React.createElement(n.View.Icon,{additionalCssClass:"file_request_icon",icon:k}),React.createElement("div",{className:"entity_title file_request_file_title"},o)),React.createElement("div",null,React.createElement("button",{className:"msb-dsb-tooltip copy_button_container msbdsb_nested_button",id:"msbdsb-suggested-file-copy-button",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,"aria-label":f?w:c,"aria-live":"polite",onClick:n=>{n.stopPropagation(),b()},onFocus:()=>{sb_st(()=>{var n;(n=e.current)===null||n===void 0?void 0:n.classList.add(t.VISIBLE_TOOLTIP_CLASS)},0)},onBlur:()=>{var n;(n=e.current)===null||n===void 0?void 0:n.classList.remove(t.VISIBLE_TOOLTIP_CLASS)}},React.createElement("span",{className:"msb-dsb-tooltip-text small-tooltip right-aligned-tooltip hide-tail copy-tooltip"},f?p:c),React.createElement("div",{className:"copy_button"},f?React.createElement(i.FluentIcon,{icon:"linkIcon",additionalCssClasses:"link_icon"}):React.createElement(i.FluentIcon,{icon:"checkIcon",additionalCssClasses:"check_icon"})))),React.createElement(i.FeedbackTooltip,{parentButtonRef:e,propertyIndex:0,answer:r,itemId:v}))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))})(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function c(){var n;return((n=o())===null||n===void 0?void 0:n.errorBoundaryResetKey)||0}function r(){const{mainPageState:n}=e();return n.mainPageData}function l(){const{mainPageState:n}=e();return n.mainPageLayout}function a(){var n;if((n=r())!==null&&n!==void 0)return n.dynamicAnswer}function h(n){var t;const i=(t=r())===null||t===void 0?void 0:t.feedAnswers;return i?React.useMemo(()=>i.filter(t=>t.answerPlacement==n),[i,n]):[]}function s(){return h("Default")}function v(){return h("Hero")}function y(){var n;if((n=r())!==null&&n!==void 0)return n.learningAnswer}function p(){var n;if((n=r())!==null&&n!==void 0)return n.popularSearchesAnswer}function w(){const n=s();return n.find(n=>n.answerPlacement=="Hero")}function b(){var n;if((n=r())!==null&&n!==void 0)return n.fileSearchSuggestionsAnswer}function k(){var n;if((n=r())!==null&&n!==void 0)return n.acronymsAnswer}function d(){var n;if((n=r())!==null&&n!==void 0)return n.dynamicAnswerState}function g(){var n;if((n=r())!==null&&n!==void 0)return n.eduAssignmentAnswer}function nt(){var n;if((n=r())!==null&&n!==void 0)return n.eduClassAnswer}function tt(n){var t,i,r;switch(n){case"MyOrgChart":return(t=o())===null||t===void 0?void 0:t.isMyOrgChartExpanded;case"EduClasses":return(i=o())===null||i===void 0?void 0:i.isEduClassesExpanded;case"EduAssignments":return(r=o())===null||r===void 0?void 0:r.isEduAssignmentsExpanded}}function it(){var n;if((n=r())!==null&&n!==void 0)return n.eduCardAnswer}function rt(){var n;if((n=r())!==null&&n!==void 0)return n.recommendedPeopleAnswer}function ut(){var n;if((n=r())!==null&&n!==void 0)return n.myOrgChart}function ft(){var n;if((n=ri())!==null&&n!==void 0)return n.recommendedPeoplePaginationSetting}function et(){const n=u();return React.useCallback((i,r)=>n(t.DataContext.setWsbRequeryAction(i,r)),[])}function ot(n){const i=u();return React.useCallback(r=>{switch(n){case"MyOrgChart":i(t.DataContext.setMyOrgChartExpansionAction(r));break;case"EduClasses":i(t.DataContext.setEduClassesExpansionAction(r));break;case"EduAssignments":i(t.DataContext.setEduAssignmentsExpansionAction(r))}},[])}function st(){const n=u();return React.useCallback((i,r,u)=>{n(t.DataContext.dismissAnswerAction(i,r,u))},[])}function ht(){const n=u();return React.useCallback((i,r)=>{n(t.DataContext.hideAnswerAction(i,r))},[])}function ct(){const n=u();return React.useCallback(i=>{n(t.DataContext.launchUriAction(i))},[])}function lt(){const n=u();return React.useCallback(i=>{n(t.DataContext.launchProactiveWorkSearch(i))},[])}function at(){const n=u();return React.useCallback(()=>{n(t.DataContext.forceDSBRefreshAction())},[])}function vt(){const n=u();return React.useCallback((i,r)=>{n(t.DataContext.navigatePageAction(i,r))},[])}function yt(){const n=u();return React.useCallback(i=>{n(t.DataContext.setLastSelectedScopeAction(i))},[])}function pt(){const{state:{imageOfTheDay:i},dispatch:r}=f(),n=i.imageOfTheDay;return React.useEffect(()=>{n===undefined&&r(t.DataContext.fetchImageOfTheDayAction())},[n]),n}function wt(n){const{state:{personPhotos:r},dispatch:u}=f();if(!n)return null;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchPersonPhotoAction(n))},[i]),(i===null||i===void 0?void 0:i.imageInBase64)||null}function bt(n){const{state:{groupPhotos:r},dispatch:u}=f();if(!n)return null;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchGroupPhotoAction(n))},[i]),i===null||i===void 0?void 0:i.imageInBase64}function kt(n,i="Medium"){const{itemId:u}=n;if(!u)return null;const{state:{feedItemPreviews:e},dispatch:o}=f(),r=e[u];return React.useEffect(()=>{r===undefined&&o(t.DataContext.fetchFeedItemPreviewAction(n,i))},[r]),(r===null||r===void 0?void 0:r.imageInBase64)||null}function dt(n){const{state:{fileIcons:r},dispatch:u}=f();if(!n)return t.DEFAULT_FILE_ICON;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchFileIconAction(n))},[i]),i||t.DEFAULT_FILE_ICON}function gt(n){const{state:{fluentIconSvgHtmls:r},dispatch:u}=f();if(!n)return null;const i=r[n];return React.useEffect(()=>{i===undefined&&u(t.DataContext.fetchFluentIconSvgHtmlAction(n))},[i]),i}function ni(){const{chatUpsellState:n}=e();return n}function ti(){const t=n.msbDsbHost.getLocString("CompanyNamePlaceholder");return n.msbHost.getTenantName()||t}function ii(){const t=s();return n.msbDsbHost.isWideLayoutEnabled()&&t.length>0}function o(){const{uiOptions:n}=e();return n}function ri(){const{paginationSettings:n}=e();return n}function e(){const{state:n}=f();return n}function u(){const{dispatch:n}=f();return n}function f(){return React.useContext(t.DataContext.ViewDataContext)}i.useErrorBoundaryResetKey=c;i.useMainPageData=r;i.useMainPageLayout=l;i.useDynamicAnswer=a;i.useFeedAnswers=s;i.useHeroAnswers=v;i.useLearningAnswer=y;i.usePopularSearchesAnswer=p;i.useHeroAnswer=w;i.useFileSearchSuggestionsAnswer=b;i.useAcronymsAnswer=k;i.useDynamicAnswerState=d;i.useEduAssignmentAnswer=g;i.useEduClassAnswer=nt;i.useIsElementExpanded=tt;i.useEduCardAnswer=it;i.useRecommendedPeopleAnswer=rt;i.useOrgChartAnswer=ut;i.useRecommendedPeoplePaginationSetting=ft;i.useDispatchSetWsbRequeryAction=et;i.useDispatchSetElementExpansionAction=ot;i.useDispatchDismissAnswerAction=st;i.useDispatchHideAnswerAction=ht;i.useDispatchLaunchUriAction=ct;i.useDispatchLaunchProactiveWorkSearchAction=lt;i.useDispatchForceDsbRefreshAction=at;i.useDispatchNavigatePageAction=vt;i.useDispatchSetLastSelectedScopeAction=yt;i.useImageOfTheDay=pt;i.usePersonPhotoBase64=wt;i.useGroupPhotoBase64=bt;i.useFeedItemPreviewBase64=kt;i.useFileIcon=dt;i.useFluentIconSvgHtml=gt;i.useChatUpsell=ni;i.useTenantDisplayName=ti;i.useShouldShowWideLayout=ii})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){i.MainPageTemplate=()=>React.createElement(i.MsbDsbErrorBoundary,{fallback:React.createElement(h,null),fallbackInstrumentSectionName:"MainPageErrorBoundaryFallback",wrappedComponentName:"MainPageTemplateWrapper"},React.createElement(f,null));const f=()=>{const t=i.useMainPageData();if(!t)return null;const r=!!n.config.msbDsbInformationArchitecture&&!n.msbDsbHost.isWideLayoutEnabled(),u=!!n.msbHost.isEduTenant();return u?React.createElement(i.EduMainPageTemplateImpl,null):r?React.createElement(o,null):React.createElement(e,null)},e=()=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("MainPage");const f=i.useMainPageData(),r=i.useDynamicAnswerState(),u=i.useShouldShowWideLayout();React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[f]);n.msbDsbHost.setWideModeStyle(!!u);const e=r===null||r===void 0?void 0:r.isAnswerStatusSucceeded;return React.createElement("div",{className:"msbdsb-mp","data-id":t.MAINPAGE_CONTAINER_ID},React.createElement("div",{className:"msbdsb-mp-header"},React.createElement(i.HeaderSection,null)),React.createElement("div",{className:"msbdsb-mp-content",id:t.MAINPAGE_CONTAINER_SCROLL},u&&React.createElement(c,null),!u&&(e?React.createElement(l,null):React.createElement(a,null))))},o=()=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("MainPage");const u=i.useMainPageData(),r=i.useMainPageLayout();if(r.length==0)throw new Error("Empty main page layout");return React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[u]),React.createElement("div",{className:"msbdsb-mp","data-id":t.MAINPAGE_CONTAINER_ID},React.createElement("div",{className:"msbdsb-mp-header"},React.createElement(i.HeaderSection,null)),React.createElement("div",{className:"msbdsb-mp-content",id:t.MAINPAGE_CONTAINER_SCROLL},r.map(n=>React.createElement(s,{component:n}))))},s=({component:t})=>{switch(t){case"SearchBox":return React.createElement(i.WorkSearchBox,{isIndependent:!0});case"ScopeSwitch":return React.createElement(i.ScopeEntrySection,null);case"Feed":return React.createElement(i.MicrosoftFeedCard,null);case"FileHero":return React.createElement(i.HeroSection,null);case"RecommendedPeople":return React.createElement(i.RecommendedPeopleSection,null);case"OrgChart":return React.createElement(i.OrgChart,{isIndependent:!0});case"Dynamic":return React.createElement(i.DynamicAnswerCard,null);case"SearchSuggestions":return React.createElement(u,null);case"PopularSearch":return React.createElement(i.PopularTenantSearchesCard,null);case"FileSearchSuggestions":return React.createElement(i.FileSearchSuggestionsCard,null);case"Acronyms":return React.createElement(i.AcronymsCard,null);case"WorkChatCard":return React.createElement(i.WorkChatCard,{chatEligibility:n.msbHost.getChatEligibility()});default:return null}},h=()=>React.createElement("div",{className:"msbdsb_mainpage_fallback_boundary msbdsb-mp-content"},React.createElement(i.MsbDsbErrorBoundaryDefaultFallback,null)),c=()=>React.createElement(React.Fragment,null,React.createElement("div",{className:"left-col"},React.createElement(i.DynamicAnswerCard,null),React.createElement(i.MicrosoftFeedCard,null)),React.createElement(r,{isOnDsbTop:!1})),l=()=>{const n=i.useDynamicAnswerState();return React.createElement(React.Fragment,null,React.createElement(i.DynamicAnswerCard,null),!(n===null||n===void 0?void 0:n.isAnswerM365Content)&&React.createElement(i.MicrosoftFeedCard,null),React.createElement(r,{isOnDsbTop:!1}))},a=()=>React.createElement(React.Fragment,null,React.createElement(r,{isOnDsbTop:!0}),React.createElement(i.MicrosoftFeedCard,null)),r=({isOnDsbTop:t})=>{const f=i.useShouldShowWideLayout(),e=f?"right-col":"msbdsb_card_background",o=i.useHeroAnswers(),r=n.config.msbDsbFileHero&&o.length>0&&!f&&t;return React.createElement("div",{className:e},r?React.createElement("div",null,n.config.msbHideDsbSearchBox?null:React.createElement(i.WorkSearchBox,{isIndependent:!0}),React.createElement(i.HeroSection,null)):undefined,n.msbDsbHost.isPeopleExplanationEnabled()?React.createElement(i.SplitPeopleSection,{hidePeopleSearchBox:r||n.config.msbHideDsbSearchBox}):React.createElement(i.PeopleCard,{hideSearchBox:r||n.config.msbHideDsbSearchBox}),React.createElement(u,null))},u=()=>{var t;const r=i.useShouldShowWideLayout(),u=!r,f=!r&&n.config.msbDsbFileSearchSuggestionsEnabled,e=r||n.config.msbDsbPopularSearchSuggestionCardEnabled;return React.createElement(React.Fragment,null,((t=n.msbHost.msbWorkChatUtils)===null||t===void 0?void 0:t.validChatEligibilityStateForCard())&&React.createElement(i.WorkChatCard,{chatEligibility:n.msbHost.getChatEligibility()}),u?React.createElement(i.AcronymsCard,null):undefined,f?React.createElement(i.FileSearchSuggestionsCard,null):undefined,e?React.createElement(i.PopularTenantSearchesCard,null):undefined)}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){const e=6,o=5,s="https://www.bing.com/th?id=ODSWG.b012cfe4-e2fc-482a-a28e-2efadac0fdf3",h="https://www.bing.com/th?id=ODSWG.7336a8ee-7373-4f81-8d7e-5b15cf0d4146";i.PeopleCard=({hideSearchBox:t})=>{const r=i.useTenantDisplayName(),u=n.msbDsbHost.getLocString("PeopleCardTitle",r),f=i.useRecommendedPeopleAnswer(),e=i.useOrgChartAnswer();return React.createElement("div",{className:"msbdsb-mp-ppl","data-region":"PeopleSection",role:"group","aria-label":u},!t&&React.createElement(i.WorkSearchBox,null),(f||e)&&React.createElement("div",{className:"msbdsb_people_box_content"},React.createElement(i.RecommendedPeople,null),React.createElement(i.OrgChart,null)))};i.SplitPeopleSection=({hidePeopleSearchBox:n})=>{const t=i.useRecommendedPeopleAnswer();return React.createElement(React.Fragment,null,!n&&React.createElement(i.WorkSearchBox,{isIndependent:!0}),t&&React.createElement(i.RecommendedPeopleSection,null),React.createElement(i.OrgChart,{isIndependent:!0}))};i.WorkSearchBox=({isIndependent:n})=>React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"WorkSearchBox"},React.createElement(c,{isIndependent:n}));const c=({isIndependent:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("WorkSearchBox");const{searchBoxInstrumentedItem:f}=i.useMainPageData(),e=i.useDispatchSetWsbRequeryAction(),o=t=>{var i;if((i=t.target)===null||i===void 0?void 0:i.value){const i=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.Scope.Work:n.Scope.People;e(t.target.value,i);t.target.value=""}},s=i.useTenantDisplayName(),u=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.msbDsbHost.getLocString("WorkSearchPlaceholder"):n.msbDsbHost.getLocString("PeopleSearchPlaceholder",s);return React.createElement(i.WithInstrumentation,{instrumentedItem:f},React.createElement("div",{className:`msb_dsb_people_search ${!!r&&"msb_dsb_independent_searchbox"}`},React.createElement("input",{id:"msbdsb_people_search_box",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:"msb_dsb_search_box",type:"text","aria-label":u,placeholder:u,onClick:t=>{var i;n.Host.setFocusInWebView("MsbDsb");(i=t.currentTarget)===null||i===void 0?void 0:i.focus()},onChange:o}),React.createElement(n.View.Icon,{icon:{content:"&#xE721",type:2}})))};i.ScopeEntrySection=()=>React.createElement("div",null,React.createElement(u,{scope:n.Scope.People,entryScope:"people",iconSvg:h,buttonText:n.msbDsbHost.getLocString("PeopleScopeOnRampButton")}),React.createElement(u,{scope:n.Scope.Documents,entryScope:"documents",iconSvg:s,buttonText:n.msbDsbHost.getLocString("DocumentScopeOnRampButton")}));const u=({scope:f,entryScope:r,iconSvg:u,buttonText:t})=>{const e=i.useDispatchSetLastSelectedScopeAction(),o=t=>{e(t),n.msbDsbLogger.logClickEvent(`${r}Entry`)};return React.createElement("div",{className:`msb_dsb_scope_entry_button msb_dsb_scope_entry_button_${r}`,onClick:()=>o(f),"aria-label":"onramp-button",role:"button",tabIndex:-1,id:`msb_dsb_scope_entry_button_${r}`},React.createElement(n.View.Icon,{icon:{type:0,content:u}}),React.createElement("div",{className:"msb_dsb_scope_entry_button_text"},t))};i.RecommendedPeopleSection=()=>{const u=i.useRecommendedPeopleAnswer();if(!u)return null;let t="msbdsb-mp-ppl";const r=n.msbDsbHost.isPeopleExplanationEnabled(),f=r?"PeopleExplanationSectionTitle":"recommendedSectionTitle";r&&(t=t+" msbdsb_people_explanations");const e=n.msbDsbHost.getLocString(f);return React.createElement("div",{role:"heading","aria-labelledBy":"recommended-section",className:t},React.createElement("div",{className:"msbdsb-recommended-section-header",id:"recommended-section"},React.createElement(i.FluentIcon,{icon:"peopleIcon",additionalCssClasses:"recommended-header-icon"}),e),React.createElement(i.RecommendedPeople,null))};i.RecommendedPeople=()=>{const n=i.useRecommendedPeopleAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"RecommendedPeople",answerType:t},React.createElement(l,{people:n}))};const l=({people:r})=>{var h,c;t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("RecommendedPeople");const f=i.useRecommendedPeoplePaginationSetting();if(!r.recommendedPeople||r.recommendedPeople.length==0)return null;let e=0,l=r.recommendedPeople.length,u=1,s=0;if(f){const i=n.config.msbDsbPeopleShufflingEnabled?o:r.recommendedPeople.length,a=(h=f.pageSize)!==null&&h!==void 0?h:(c=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbRecommendedPeoplePageSize)!==null&&c!==void 0?c:t.RECOMMENDED_PEOPLE_DISPLAY_COUNT;u=Math.floor(i/a)||1;s=f.currentPageIndex%u;e=Math.min(s*f.pageSize,i-1);l=Math.min(e+f.pageSize,i)}const p=r.recommendedPeople.slice(e,l),w=l-e,y=n.msbDsbHost.isPeopleExplanationEnabled(),b=y?"msb_dsb_peoplehero_container":"msb_dsb_recommendedpeople_container";return React.createElement("div",{className:b},React.createElement("div",{className:"msb_dsb_recommendedpeople_upper"},u>1&&React.createElement(i.PaginationFlippersControl,{paginationId:`RecommendedPeople`,numberOfPages:u,currentPageIndex:s}),React.createElement(i.WithInstrumentation,{instrumentedItem:r.instrumentedItem},React.createElement("ul",{tabIndex:-1,className:`msb_dsb_top_collaborators ${t.MDSB_LIST_CONTAINER_CLASS}`},p.map((t,i)=>{const f=n.msbDsbHost.getLocString("RecentContactsAnnouncementFallback",t.fullName),u=`msbdsb-recommended-person-${e+i}`;return React.createElement(React.Fragment,null,y?React.createElement(v,{person:t,personId:u}):React.createElement(a,{person:t,personId:u,traceId:r===null||r===void 0?void 0:r.traceId,accessibilityProps:{ariaLabel:f,ariaSetPosition:i+1,ariaSetSize:w}}))})))),u>1&&React.createElement(i.PaginationDotList,{paginationId:`RecommendedPeople`,numberOfPages:u,currentPageIndex:s}))},a=({person:t,personId:r,traceId:u,accessibilityProps:n})=>{const{firstName:f,lastName:o,fullName:e,referenceId:s}=t;return React.createElement("li",{key:t.uid},React.createElement(i.WsbPeopleRequery,{id:r,query:e,referenceId:s,answerType:"RecommendedPeople",accessibilityProps:n,isTabbable:!0,traceId:u},React.createElement(i.PersonIcon,{additionalCssClass:"msb_dsb_top_people_icon",person:t}),React.createElement("div",{className:"msb_dsb_recommended_name"},React.createElement("p",null,f!==null&&f!==void 0?f:e),React.createElement("p",{className:"msb_dsb_last_name"},o))))},v=({person:n,personId:t})=>{const{fullName:r,rankingExplanation:u}=n;return React.createElement("div",{id:t,className:"msb_dsb_person_explanation_container"},React.createElement("div",{className:"msb_dsb_person_explanation_header"},React.createElement("div",{className:"msb_dsb_pxai_icon_container"},React.createElement(i.PersonIcon,{additionalCssClass:"msb_dsb_top_people_icon",person:n})),React.createElement("div",{className:"msb_dsb_person_explanation_textsection"},React.createElement("div",{className:"msb_dsb_recommended_name"},React.createElement("p",null,r)),React.createElement("p",{className:"msb_dsb_person_reason_explainer"},u))),React.createElement(i.PeopleCentricSuggestions,{fullName:r,sectionName:"PeopleSection"}))},f=({id:e,person:o,referenceId:s,ariaSetPosition:u,ariaSetSize:f,additionalCssClasses:r,traceId:h})=>{if(!o)return null;const{fullName:c,jobTitle:l,uid:p}=o,a=n.msbDsbHost.getLocString("SearchForNarration"),v=l?`${a} ${c}, ${l}`:`${a} ${c}`,w=n.View.classNames("msb-dsb-tooltip msb-dsb-person-with-tooltip",r),y=React.useRef(null),b=i.makeEnterKeyAsClickInRefComponentHandler(y);return React.createElement("div",{id:e,"aria-label":v,"aria-posinset":u,"aria-setsize":f,className:w,onKeyPress:b,role:"button",tabIndex:t.TAB_NAVIGATION_TAB_INDEX},React.createElement("span",{className:"msb-dsb-tooltip-text"},React.createElement("div",null,c),l&&React.createElement("div",null,l)),React.createElement(i.WsbPeopleRequery,{id:`msbdsb_person_${p}`,query:c,referenceId:s,answerType:"OrgChart",accessibilityProps:{ariaLabel:v},childRef:y,traceId:h},React.createElement(i.PersonIcon,{person:o})))},r=({people:l,numLeftAdjusted:s,numRightAdjusted:h,onSeeMoreClick:c,idPrefix:r,isHeroRow:u,isTabbable:o})=>{if(!(l===null||l===void 0?void 0:l.length))return null;const[a,p]=React.useState(l.slice(0,5));i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel()},[a.length]);const w=React.useRef(null);React.useEffect(()=>{const n=w.current,t=new IntersectionObserver(i=>{const u=i[0],r=n===null||n===void 0?void 0:n.firstElementChild,f=r===null||r===void 0?void 0:r.nextElementSibling;if((u===null||u===void 0?void 0:u.isIntersecting)&&f){const u=n.clientWidth,e=Math.abs(f.getBoundingClientRect().left-r.getBoundingClientRect().left),i=Math.floor(u/e);l.length>i?p(l.slice(0,i-1)):p(l);t.disconnect()}});return n&&t.observe(n),()=>{t.disconnect()}},[l]);const v=l.length-a.length,y=v>0?a.length+1:a.length,b=u?y+1:y,k="msb-dsb-persona dsb-persona-text";return React.createElement("div",{ref:w,tabIndex:o&&t.TAB_NAVIGATION_TAB_INDEX,className:o?t.MDSB_LIST_CONTAINER_CLASS:""},a.map((t,i)=>{const o=s>i,c=i>e-h,l=n.View.classNames(k,o?"leftAdjust":"",c?"rightAdjust":""),a=u?i+2:i+1;return React.createElement(f,{id:`${r}-${i}`,key:t.uid,person:t,ariaSetPosition:a,ariaSetSize:b,additionalCssClasses:l})}),v>0&&React.createElement("div",{className:"msb-dsb-persona"},React.createElement("button",{id:`msbdsb-more-${r}-button`,className:"extra-people-container",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:"link","aria-label":n.msbDsbHost.getLocString("MoreButtonLabel",v.toString()),"aria-posinset":y+1,"aria-setsize":b,onClick:c,"data-msb-dsb-bing-transfer":!0},React.createElement("span",{className:"msb-dsb-extra-people-circle"},"+",v))))};i.OrgChart=({isIndependent:n})=>{const t=i.useOrgChartAnswer();return t?React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"MyOrgChart",answerType:"OrgChart"},React.createElement(y,{orgChart:t,isIndependent:n})):null};const y=({orgChart:u,isIndependent:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("OrgChart");const e="MyOrgChart",f=i.useIsElementExpanded(e),s=i.useDispatchSetElementExpansionAction(e),h={type:2,content:f?"&#xE70E":"&#xE70D"},c=()=>s(!f),o=n.msbDsbHost.getLocString("OrgChartTitle"),l=f?"opened":"collapsed";return i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel()},[f]),React.createElement("div",{className:`msb_dsb_your_organization  ${!!r&&"msb_dsb_independent_orgchart"}`},React.createElement("button",{id:"msbdsb-orgchart-title",className:"msb_dsb_orgchart_title",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,onClick:c,"aria-label":`${o} dropdown ${l}`,"aria-live":"polite"},React.createElement(n.View.Icon,{additionalCssClass:"msb_dsb_chevron",icon:h}),React.createElement("div",{id:"OrgChartTitle"},o)),f&&React.createElement(p,{orgChart:u}))},p=({orgChart:u})=>{var l,a;const k=i.useDispatchLaunchUriAction(),d=i.useDispatchLaunchProactiveWorkSearchAction(),{hero:s,managers:e,peers:o,directReports:h}=u,v=n.msbDsbHost.getLocString("ManagersOrgName",(l=e===null||e===void 0?void 0:e[0])===null||l===void 0?void 0:l.fullName),y=React.useMemo(()=>{var t;return{query:v,intent:"PersonOrgChart",entityId:(t=e===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.userPrincipalName,formCode:n.msbDsbHost.getFormCode()}},[v,(a=e===null||e===void 0?void 0:e[0])===null||a===void 0?void 0:a.userPrincipalName]),nt=React.useCallback(async()=>{if(n.config.msbEnableProactiveSearchTransfers)d(y);else{const t=await n.msbHost.urlUtils.buildBfbSearchUrlAsync(y);k(t)}},[v,y]),p=s===null||s===void 0?void 0:s.fullName,w=React.useMemo(()=>({query:p,intent:"PersonOrgChart",formCode:n.msbDsbHost.getFormCode()}),[p]),b=React.useCallback(async()=>{if(n.config.msbEnableProactiveSearchTransfers)d(w);else{const t=await n.msbHost.urlUtils.buildBfbSearchUrlAsync(w);k(t)}},[p,w]),[c,g]=React.useState(o.slice(0,5));i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel()},[c.length]);const tt=React.useRef(null);React.useEffect(()=>{const n=tt.current,t=new IntersectionObserver(i=>{const u=i[0],r=n.firstElementChild,f=r===null||r===void 0?void 0:r.nextElementSibling;if((u===null||u===void 0?void 0:u.isIntersecting)&&f){const u=n.clientWidth,e=Math.abs(f.getBoundingClientRect().left-r.getBoundingClientRect().left),i=Math.floor(u/e);o.length>i?g(o.slice(0,i-1)):g(o);t.disconnect()}});return n&&t.observe(n),()=>{t.disconnect()}},[o]);const it=o.length-c.length,rt=it>0?c.length+1:c.length;return React.createElement(i.WithInstrumentation,{instrumentedItem:u.instrumentedItem},React.createElement("div",{className:"org-chart-container"},(e===null||e===void 0?void 0:e.length)>0&&React.createElement("div",null,React.createElement("div",{className:"dsb-manager-row"},React.createElement(r,{idPrefix:"msbdsb-orgchart-manager",people:e,numLeftAdjusted:2,numRightAdjusted:1,onSeeMoreClick:b,isTabbable:!0})),React.createElement("svg",{role:"img","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",className:"dsb-orgChartLine dsb-svg"},React.createElement("line",{x1:"50%",y1:"0",x2:"50%",y2:"100%"}))),s&&React.createElement("div",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`${t.MDSB_LIST_CONTAINER_CLASS} dsb-hero-row ${(e===null||e===void 0?void 0:e.length)?"":"dsb-hero-row-no-manager"}`},React.createElement(f,{id:"msbdsb-orgchart-hero",ariaSetPosition:1,ariaSetSize:rt+1,key:s.uid,person:s,additionalCssClasses:"dsb-hero-circle dsb-hero-persona dsb-persona-text leftAdjust"}),o.length>0&&React.createElement("div",{className:`peerPersonaList ${(e===null||e===void 0?void 0:e.length)>0?"":"noManager"}`},React.createElement("div",{className:"ms-search-orgPersonaListLabel ms-search-text-s dsb-label",id:"heroPersonaListHeader",role:"heading"},n.msbDsbHost.getLocString("SharesSameManager")," (",o.length,")"),React.createElement(r,{idPrefix:"msbdsb-orgchart-peer",isHeroRow:!0,people:o,numLeftAdjusted:1,numRightAdjusted:1,onSeeMoreClick:()=>(e===null||e===void 0?void 0:e.length)>0?nt():b()}))),(h===null||h===void 0?void 0:h.length)>0&&React.createElement("div",null,React.createElement("svg",{"aria-hidden":"true",focusable:"false",role:"img",className:"msb-dsb-direct-report-svg",xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"},React.createElement("path",{fill:"none",d:"M 16 0 L 16 45 L 60 45"})),React.createElement("div",{className:"msb_dsb_direct_reports"},React.createElement("div",{className:"ms-search-orgPersonaListLabel ms-search-text-s dsb-label",id:"reportsPersonaListHeader",role:"heading"},n.msbDsbHost.getLocString("YourDirects")," (",h.length,")"),React.createElement(r,{idPrefix:"msbdsb-orgchart-report",people:h,numLeftAdjusted:1,numRightAdjusted:1,onSeeMoreClick:b,isTabbable:!0})))))};i.FileSearchSuggestionsCard=()=>{const n=i.useFileSearchSuggestionsAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerType:t,wrappedComponentName:"FileSearchSuggestionsCard"},React.createElement(w,{fileSearchSuggestionsAnswer:n}))};const w=({fileSearchSuggestionsAnswer:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("FileSuggestions");const{fileSearchSuggestions:u,instrumentedItem:f}=r,e=u.map(t=>({title:t.fileName,scope:n.Scope.Work,icon:"searchIcon"})),o=n.msbDsbHost.getLocString("FileSuggestions");return React.createElement(i.SearchSuggestionsCard,{title:o,icon:"folderIcon",sectionId:"FileSearchSuggestions",suggestions:e,instrumentedItem:f,maxRows:n.config.msbDsbFileSearchSuggestionsRows,maxCharLimit:t.FILE_SEARCH_SUGGESTIONS_CHAR_LIMIT,additionalCssClasses:"msbdsb_file_search_suggestions_card"})};i.AcronymsCard=()=>{const n=i.useAcronymsAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerType:t,wrappedComponentName:"AcronymsCard"},React.createElement(b,{acronymsAnswer:n}))};const b=({acronymsAnswer:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("Acronyms");const{acronyms:s,acronymFeaturedSuggestion:h,instrumentedItem:c,subItemInstrumentedItem:l}=r,e=t=>n.msbDsbHost.getLocString("AcronymsSuggestionsQuery",t.abbreviatedName),u=h,f=s.map(t=>({title:t.abbreviatedName,query:e(t),scope:n.Scope.Work})),a=n.msbDsbHost.getLocString("AcronymsCardTitle"),v=n.msbDsbHost.getLocString("AcronymFeaturedCount",u.numberOfResults.toString()),o=i.useDispatchSetWsbRequeryAction(),y=React.createElement(React.Fragment,null,React.createElement("div",{className:"msbdsb_search_suggestions_acronyms_card_subtitle"},n.msbDsbHost.getLocString("AcronymsCardSubtitle")),React.createElement("div",{className:"msbdsb_search_suggestions_acronyms_pills"},f.map((n,t)=>React.createElement(i.WithInstrumentation,{instrumentedItem:l},React.createElement(i.SuggestionPill,{searchText:n.title,icon:"searchIcon",id:`msbdsb_search_suggestions_acronyms_${t+1}`,key:n.title,accessibilityProps:{ariaSetPosition:t+2,ariaSetSize:f.length+1},onClick:()=>o(n.query,n.scope)})))));return React.createElement(i.SearchSuggestionsContainer,{title:a,icon:"acronymsIcon",sectionId:"acronyms",additionalCssClasses:"msbdsb_search_suggestions_acronyms_card"},u&&React.createElement(i.WithInstrumentation,{instrumentedItem:c},React.createElement("button",{id:`msbdsb_search_suggestions_acronyms_${0}`,className:"msbdsb_search_suggestions_acronyms_card_top",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,"aria-label":`${u.abbreviatedName} ${u.displayName}`,"aria-posinset":1,"aria-setsize":f.length+1,onClick:()=>o(e(u),n.Scope.Work)},React.createElement("div",{className:"msbdsb_search_suggestions_acronyms_card_top_content"},React.createElement("span",{className:"msbdsb_search_suggestions_acronyms_card_top_title"},u.abbreviatedName),React.createElement("div",null,React.createElement("span",{className:"msbdsb_search_suggestions_acronyms_card_top_displayname"},u.displayName),React.createElement("span",{className:"msbdsb_search_suggestions_acronyms_card_top_displayname_count"},v))))),f.length>0&&y)};i.DynamicAnswerCard=()=>{const n=i.useDynamicAnswer();if(!n)return null;switch(n.answerType){case"MeetingPrep":return React.createElement(i.MeetingPrepCard,{answer:n});case"FileRequest":return React.createElement(i.FileRequestCard,{answer:n});case"IndustryNews":return React.createElement(i.IndustryNewsFeed,{answer:n});default:return null}};i.HeroSection=()=>{const n=i.useHeroAnswers();return n.length==0?null:React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"HeroSection"},React.createElement(i.HeroSectionImpl,{heroAnswers:n}))};i.HeroSectionImpl=({heroAnswers:r})=>{const s=r.length,[f,h]=React.useState(n.config.undocked?1.65:1.53);i.useEffectSkipFirstRender(()=>{n.msbDsbHost.updateInteractionModel()},[f]);const u=12,e=React.useRef(null);React.useEffect(()=>{const n=e.current,t=new IntersectionObserver(i=>{const r=i[0],f=_ge("msbdsb-hero-card-1");if((r===null||r===void 0?void 0:r.isIntersecting)&&n&&f){const i=n.offsetWidth+u,r=f.offsetWidth+u;h(i/r);t.disconnect()}});return n&&t.observe(n),()=>{t.disconnect()}},[r]);const o="msbdsb-file-hero-section",c={dsbScenario:"FileHero",tilesToShow:f,showAriaMessage:!1,tileSpacing:u,containerID:o,verticalSpacing:"12px",moveSlides:1,supportLRNav:!0,supportWraparound:!0,instrumentDirection:!0};return React.createElement("div",{"data-msb-dsb-prevent-scroll":!0,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`msbdsb-hero-section ${t.MDSB_LIST_CONTAINER_CLASS}`,id:o,ref:e,role:"feed","aria-label":n.msbDsbHost.getLocString("HeroFilesTitle")},React.createElement(n.View.DSB.Templates.MegaCarouselComponent,Object.assign({},c),r.map((n,t)=>{const r=t+1;return React.createElement(i.HeroCardRouter,{heroAnswer:n,setPosition:r,setSize:s})})))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){i.EduMainPageTemplateImpl=()=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("EduMainPage");const s=i.useMainPageData(),e=i.useShouldShowWideLayout();React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[s]);n.msbDsbHost.setWideModeStyle(!!e);const h=e?"right-col":"",c=e?"left-col":"",l=i.useEduAssignmentAnswer(),a=i.useEduClassAnswer(),o=n.config.msbDsbEnableEduScenario&&(l||a),v=i.useFeedAnswers().length>0,y=!o&&!v;return React.createElement("div",{className:"msbdsb-mp","data-id":t.MAINPAGE_CONTAINER_ID},React.createElement("div",{className:"msbdsb-mp-header"},React.createElement(i.HeaderSection,null)),React.createElement("div",{className:"msbdsb-mp-content",id:t.MAINPAGE_CONTAINER_SCROLL},React.createElement("div",{className:h},React.createElement(u,null),o&&React.createElement(f,null)),y&&React.createElement(r,null),React.createElement("div",{"data-region":"M365",className:c},React.createElement(i.MicrosoftFeedCard,null))))};const r=()=>React.createElement("div",{role:"ImageOfTheDayCard","aria-label":n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.getLocString("ImageOfTheDayCardTitle")},React.createElement(i.ImageOfTheDayCard,null)),u=()=>React.createElement("div",{className:"msbdsb_card_background"},React.createElement("div",{className:"msbdsb-mp-edu-card",role:"EduCard","aria-label":n.msbDsbHost.getLocString("EduCardTitle")},React.createElement(i.EduCard,null))),f=()=>{const t=i.useEduAssignmentAnswer(),r=i.useEduClassAnswer();return React.createElement("div",{"data-region":"Edu"},React.createElement("div",{className:"msbdsb_card_background"},t&&React.createElement(i.EduExpandableCard,{answerType:t.answerType,items:t.entities,elementType:"EduAssignments",instrumentedItem:t.instrumentedItem,subItemInstrumentedItem:t.subItemInstrumentedItem,title:n.msbDsbHost.getLocString("EduAssignmentCardTitle"),cardType:"Assignments",seeMoreQuery:n.Host.getLocString("EduCardAssignmentsQuery"),seeMoreVerticalHash:"EducationAssignment",seeMoreLink:t.seeMoreLink,totalCount:t.totalCount})),React.createElement("div",{className:"msbdsb_card_background"},r&&React.createElement(i.EduExpandableCard,{answerType:r.answerType,items:r.entities,elementType:"EduClasses",instrumentedItem:r.instrumentedItem,subItemInstrumentedItem:r.subItemInstrumentedItem,title:n.msbDsbHost.getLocString("EduClassCardTitle"),cardType:"Classes",seeMoreQuery:n.Host.getEnUsLocString("EduCardClassesQuery"),seeMoreLink:r.seeMoreLink,totalCount:r.totalCount})))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function s(t){switch(t){case"Organizer":return n.msbDsbHost.getLocString("MeetingOrganizer");case"Accepted":return n.msbDsbHost.getLocString("MeetingAccepted");case"Tentative":return n.msbDsbHost.getLocString("MeetingTentative");case"Declined":return n.msbDsbHost.getLocString("MeetingDeclined");case"None":return n.msbDsbHost.getLocString("MeetingNoResponse")}}i.MeetingPrepCard=({answer:t})=>{const{answerType:u,answerId:f}=t;return React.createElement(i.MsbDsbErrorBoundary,{answerId:f,answerType:u,wrappedComponentName:"MeetingPrepCard"},n.config.msbDsbInformationArchitecture?React.createElement(r,{answer:t,isIndependent:!0}):React.createElement(i.M365HeaderCard,null,React.createElement(r,{answer:t})))};const r=({answer:r,isIndependent:u})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("MeetingPrep");const{answerId:c,meetingId:e,answerType:l,subject:a,start:v,topAttendees:y,totalNumberOfAttendees:p,webLink:o,instrumentedItem:w,subItemInstrumentedItem:b,traceId:s}=r,k=t=>{return t.toLocaleString(n.Host.getLanguage(),{hour:"numeric",minute:"numeric"})},h=n.msbDsbHost.getLocString("MeetingUpcomingTitle",k(v)),d=i.useDispatchLaunchUriAction();return React.createElement(i.FeedCardBase,{additionalCssClasses:`msbdsb_selectable msbdsb_meeting_card ${!!u&&"msbdsb_independent_meeting_card"}`,onClick:()=>{n.msbDsbSubstrateLogger.logSearchEntityActions("MeetingPrep",n.getDateWithTimezone(),"entityclicked",e,s),d(o)},isClickable:!0,accessibilityProps:{role:"article",ariaLabel:i.combineLabelAndHintText(h,n.msbDsbHost.getLocString("OpenInOutlookHintText"))},instrumentedItem:w,dismissalInstrumentedItem:b,answerId:c,answerType:l},React.createElement("div",{className:"meeting_info"},React.createElement("div",{className:"upcoming_row horizontal_stack"},React.createElement("div",{className:"horizontal_stack"},React.createElement(i.FluentIcon,{icon:"calendarIcon",additionalCssClasses:"calendar_icon"}),React.createElement("p",{className:"upcoming_meeting_text"},h))),React.createElement("div",{"aria-labelledby":"meeting_title",className:"meeting_details"},React.createElement("rect",{className:"coloured_bar"}),React.createElement("div",{className:"contents"},React.createElement("p",{id:"meeting_title",className:"meeting_title"},a),React.createElement(i.MeetingAttendees,{numberToShow:6,totalNumber:p,attendees:y,meetingUrl:o,referenceId:e,traceId:s})))),React.createElement("hr",{className:"msbdsb_divider"}),React.createElement(f,{answer:r,numberToShow:2}))},f=({answer:r,numberToShow:u})=>{const{fileResults:f,conversationResults:s,totalNumberOfResults:h,webLink:p,meetingId:w}=r;if(!f||!s)return null;const b=h!==null&&h!==void 0?h:f.length+s.length,k=i.useDispatchLaunchUriAction(),c=b-u,l=f.length>0,a=u>f.length&&s.length>0;let v;v=l?a?n.msbDsbHost.getLocString("GenericSuggestionsText"):n.msbDsbHost.getLocString(f.length===1?"SingleFileSuggestionText":"FileSuggestionsText"):n.msbDsbHost.getLocString(s.length===1?"SingleConversationSuggestionText":"ConversationSuggestionsText");const d=()=>{n.msbDsbSubstrateLogger.logSearchEntityActions("MeetingPrep",n.getDateWithTimezone(),"entityclicked",w,r===null||r===void 0?void 0:r.traceId),k(p)},y=React.useRef(null),[g,nt]=i.useSuggestionsInfoTooltipDimensions(y);return React.createElement("div",{ref:y},React.createElement("div",{className:"suggestion_header_container"},React.createElement("span",{className:"suggestion_header"},v),React.createElement(i.SuggestedInfoIcon,{containerLeft:g,containerRight:nt})),React.createElement("div",{className:`suggested_files_list`},l&&f.filter((n,t)=>t<u).map((n,t)=>React.createElement(e,{answer:r,propertyIndex:t,file:n})),a&&s.filter((n,t)=>t<u-f.length).map((n,t)=>React.createElement(o,{answer:r,propertyIndex:t+f.length,message:n})),c>0&&React.createElement("button",{id:"msbdsb-mp-more-suggestions-button",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,"aria-label":i.combineLabelAndHintText(n.msbDsbHost.getLocString("MoreButtonLabel",c.toString()),n.msbDsbHost.getLocString("OpenInOutlookHintText")),className:"more_files_count msbdsb_nested_button",onClick:n=>{n.stopPropagation(),d()}},n.msbDsbHost.getLocString("MoreText",c.toString()))))},e=({propertyIndex:f,file:r,answer:t})=>{const{referenceId:e,title:o,subtitle:s,fileExtension:h,url:c}=r,l=i.useFileIcon(h);return React.createElement(u,{propertyIndex:f,preview:React.createElement(n.View.Icon,{additionalCssClass:"meeting_file_icon",icon:l}),title:o,subtitle:s,url:c,hint:n.msbDsbHost.getLocString("OpenInBrowserHintText"),referenceId:e,answer:t})},o=({propertyIndex:f,message:r,answer:t})=>{const{referenceId:o,from:e,conversationUri:s,subject:h}=r;return React.createElement(u,{propertyIndex:f,title:h,preview:React.createElement(i.MessageSenderPreview,{iconSize:"40",person:e,isEmailMessage:!0}),url:s,hint:n.msbDsbHost.getLocString("OpenInOutlookHintText"),subtitle:e===null||e===void 0?void 0:e.fullName,referenceId:o,answer:t,traceId:t===null||t===void 0?void 0:t.traceId})},u=({propertyIndex:e,title:h,subtitle:s,preview:f,referenceId:o,answer:r,url:l,hint:u,traceId:c})=>{const v=i.useDispatchLaunchUriAction(),y=()=>{n.msbDsbSubstrateLogger.logSearchEntityActions("MeetingPrep",n.getDateWithTimezone(),"relatedentityclicked",o,c),l&&v(l)},a=React.useRef(null);return React.createElement("div",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`${t.MDSB_LIST_CONTAINER_CLASS}`},React.createElement("button",{ref:a,id:`msbdsb-mp-suggested-item-${e}`,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:"link","aria-label":i.combineLabelAndHintText(h,u),className:"suggested_entity msbdsb_nested_button msb-dsb-tooltip msb-dsb-item-with-feedback",onClick:n=>{n.stopPropagation(),y()}},React.createElement("div",{className:"suggestion_icon"},f),React.createElement("div",{className:"entity_title"},h,React.createElement("div",{className:"entity_subtitle"},s)),o&&React.createElement(i.FeedbackTooltip,{propertyIndex:e,parentButtonRef:a,answer:r,itemId:o})))};i.MeetingAttendees=({numberToShow:f,attendees:r,meetingUrl:u,totalNumber:o,referenceId:e,traceId:s})=>{if(!r||!f||r.length==0)return null;const k=i.useDispatchLaunchUriAction(),v=["None","Declined","Tentative","Accepted","Organizer"];o=o?o:r.length;const c=Math.min(f,r.length),l=o>c,y=o-c>=9;r=r.sort((n,t)=>v.indexOf(t.status)-v.indexOf(n.status));const p=l?r.slice(0,f-1):r,w=()=>{n.msbDsbSubstrateLogger.logSearchEntityActions("MeetingPrep",n.getDateWithTimezone(),"entityclicked",e,s),k(u)},a=o-p.length,h=l&&f<=r.length?c+1:c,d=n.msbDsbHost.getLocString("OpenInOutlookHintText"),b=i.combineLabelAndHintText(n.msbDsbHost.getLocString("MoreButtonLabel",a.toString()),d);return React.createElement("span",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`msbdsb_status_profile_icon_container ${t.MDSB_LIST_CONTAINER_CLASS}`,"aria-labelledby":"meeting_title"},p.map((n,t)=>React.createElement("div",{className:"status_profile"},React.createElement(i.MeetingAttendeeWithTooltip,{id:`msbdsb-mp-meeting-attendee-${t}`,attendee:n,additionalCssClasses:t<2?"leftAdjust":"",ariaSetPosition:t+1,ariaSetSize:h,traceId:s}))),l&&!y&&React.createElement("button",{id:"msbdsb-mp-more-attendees-button",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,"aria-label":b,className:"more_icon msbdsb_nested_button",onClick:n=>{n.stopPropagation(),w()},"aria-posinset":h,"aria-setsize":h},n.msbDsbHost.getLocString("MoreAttendeesIconText",a.toString())),l&&y&&React.createElement("button",{id:"msbdsb-more-attendees-link",tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:"link","aria-label":b,className:"more_text msbdsb_hyperlink",onClick:n=>{n.stopPropagation(),w()},"aria-posinset":h,"aria-setsize":h},n.msbDsbHost.getLocString("MoreAttendeesLinkText",a.toString())))};i.MeetingAttendeeWithTooltip=({attendee:e,additionalCssClasses:r,ariaSetPosition:u,ariaSetSize:f,id:o,traceId:h})=>{var c,l;if(!e)return null;const{fullName:a,status:w,uid:v}=e,b=n.View.classNames("msb-dsb-tooltip msb-dsb-person-with-tooltip",r),k=n.View.classNames("meeting_attendee_icon_container msbdsb_nested_button",e.status==="Organizer"?"meeting_organizer":""),y=s(w),p=React.useRef(null),d=i.makeEnterKeyAsClickInRefComponentHandler(p);return React.createElement("div",{id:o,"aria-labelledby":`attendee_${v}`,"aria-posinset":u,"aria-setsize":f,className:b,onKeyPress:d,role:"button",tabIndex:t.TAB_NAVIGATION_TAB_INDEX},React.createElement("div",{className:"msb-dsb-tooltip-text"},React.createElement("div",{className:"msb-dsb-tooltip-lines"},a),React.createElement("div",{className:"msb-dsb-tooltip-lines"},y)),React.createElement(i.WsbPeopleRequery,{id:`attendee_${v}`,query:a,answerType:"MeetingPrep",accessibilityProps:{ariaLabel:`${a}, ${y}`},additionalCssClasses:k,childRef:p,traceId:h},React.createElement(i.PersonIcon,{additionalCssClass:"meeting_attendee_icon",person:e}),React.createElement("div",{className:n.View.classNames("status_circle",(l=(c=e.status)===null||c===void 0?void 0:c.toLowerCase())!==null&&l!==void 0?l:"none")},(e.status=="Accepted"||e.status=="Organizer")&&React.createElement("svg",{role:"img",xmlns:"http://www.w3.org/2000/svg",className:"status_icon",width:"5",height:"5",viewBox:"0 0 4 4",fill:"none"},React.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.4459 3.5C1.51566 3.5 1.58224 3.48682 1.64566 3.46047C1.70908 3.43411 1.76457 3.39767 1.81213 3.35116L3.85256 1.35581C3.90012 1.3093 3.93658 1.25504 3.96195 1.19302C3.98732 1.13101 4 1.06744 4 1.00233C4 0.934108 3.98652 0.868993 3.95957 0.806977C3.93262 0.744961 3.89616 0.691473 3.85018 0.646512C3.8042 0.60155 3.7495 0.565892 3.68609 0.539535C3.62267 0.513178 3.55608 0.5 3.48633 0.5C3.41974 0.5 3.35394 0.512403 3.28894 0.537209C3.22394 0.562016 3.16766 0.597674 3.1201 0.644186L1.4459 2.2814L0.884661 1.73256C0.783194 1.63333 0.661118 1.58372 0.51843 1.58372C0.448672 1.58372 0.382085 1.5969 0.318668 1.62326C0.255251 1.64961 0.199762 1.68605 0.1522 1.73256C0.104637 1.77907 0.0673802 1.83256 0.0404281 1.89302C0.0134759 1.95349 0 2.01783 0 2.08605C0 2.15116 0.0134759 2.2155 0.0404281 2.27907C0.0673802 2.34264 0.104637 2.39767 0.1522 2.44419L1.07967 3.35116C1.12723 3.39767 1.18351 3.43411 1.24851 3.46047C1.31352 3.48682 1.37931 3.5 1.4459 3.5Z",fill:"white"})),e.status=="Declined"&&React.createElement("svg",{role:"img",xmlns:"http://www.w3.org/2000/svg",className:"status_icon",width:"5",height:"5",viewBox:"0 0 4 4",fill:"none"},React.createElement("path",{d:"M4 0.76396L2.75896 2.00054L3.99461 3.23712L3.23189 4L1.99731 2.76342L0.762726 4L0 3.23712L1.23566 2.00054L0 0.762881L0.762726 0L1.99731 1.23766L3.23189 0L4 0.76396Z",fill:"white"})),e.status=="Tentative"&&React.createElement("svg",{role:"img",className:"status_icon tentative",width:"8",height:"8",viewBox:"0 0 4 6",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M2 0.75C1.37967 0.75 0.875 1.25467 0.875 1.875C0.875 2.03033 1.00092 2.15625 1.15625 2.15625C1.31158 2.15625 1.4375 2.03033 1.4375 1.875C1.4375 1.56533 1.69033 1.3125 2 1.3125C2.30967 1.3125 2.5625 1.56533 2.5625 1.875C2.5625 2.12 2.51693 2.2568 2.4674 2.34393C2.41591 2.43452 2.34682 2.49723 2.24182 2.58472L2.22267 2.60063C2.12555 2.68119 1.9934 2.7908 1.89287 2.95275C1.78057 3.1337 1.71875 3.35769 1.71875 3.65625V3.84375C1.71875 3.99908 1.84467 4.125 2 4.125C2.15533 4.125 2.28125 3.99908 2.28125 3.84375V3.65625C2.28125 3.43919 2.3249 3.32333 2.3708 3.24939C2.4217 3.16739 2.4893 3.1107 2.60193 3.01684C2.70787 2.92856 2.84971 2.80962 2.95642 2.62189C3.0651 2.4307 3.125 2.1925 3.125 1.875C3.125 1.25467 2.62033 0.75 2 0.75ZM2 5.34375C2.20711 5.34375 2.375 5.17586 2.375 4.96875C2.375 4.76164 2.20711 4.59375 2 4.59375C1.79289 4.59375 1.625 4.76164 1.625 4.96875C1.625 5.17586 1.79289 5.34375 2 5.34375Z",fill:"white"})),e.status=="None"&&React.createElement("div",{className:"unknown_circle"}))))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function e(n,t,r,u,f){return i.combineLabelAndHintText(` ${t}, ${u!==null&&u!==void 0?u:""} ${n} ${f!==null&&f!==void 0?f:""}`,r)}const s=4,f=26;i.MicrosoftFeedCard=()=>React.createElement(i.MsbDsbErrorBoundary,{fallback:React.createElement(i.MsbDsbErrorBoundaryDefaultFallback,null),fallbackInstrumentSectionName:"FeedErrorBoundaryFallback",wrappedComponentName:"MicrosoftFeedCard"},React.createElement(h,null));const h=()=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("Feed");const f=i.useLearningAnswer(),h=i.useShouldShowWideLayout();let r=i.useFeedAnswers();const l=Math.max(n.config.msbDsbMaxM365Cards,s),a=h?l:n.config.msbDsbMaxM365Cards;r=r.slice(0,a);const u=r.length>0,e=f&&!u,v=u||e;if(!v)return null;const o=u&&!n.msbHost.isEduTenant();return React.createElement(i.M365HeaderCard,{isCondensed:o},React.createElement(React.Fragment,null,u&&r.filter(n=>n.item).map((n,t)=>{const i=t+1;return React.createElement(c,{feedAnswer:n,key:n.answerId,setPosition:i,setSize:r.length,isCondensedFeed:o})}),e&&React.createElement(i.LearningCard,{learningAnswer:f})))},c=({feedAnswer:n,setPosition:i,setSize:r,isCondensedFeed:t})=>{var u;switch((u=n.item)===null||u===void 0?void 0:u.category){case"file":return React.createElement(v,{feedAnswer:n,setPosition:i,setSize:r,isCondensedFeed:t});case"video":return React.createElement(l,{feedAnswer:n,setPosition:i,setSize:r,isCondensedFeed:t});case"emailMessage":case"teamsChatMessage":return React.createElement(p,{feedAnswer:n,setPosition:i,setSize:r,isCondensedFeed:t});default:return null}},l=({feedAnswer:n,setPosition:r,setSize:u,isCondensedFeed:t})=>{const{answerId:f,answerType:e}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerId:f,answerType:e,wrappedComponentName:"VideoFeedItemCard"},React.createElement(a,{feedAnswer:n,setPosition:r,setSize:u,isCondensedFeed:t}))},a=({feedAnswer:u,setPosition:e,setSize:o,isCondensedFeed:f})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("VideoFeedItem");const s=u.item,h=n.msbDsbHost.getLocString("VideoIconAltText");return React.createElement(r,{tidbitItem:s.tidbitItem,body:s.title,bodyLabel:s.title,footer:s.duration,icon:s.icon,answerId:u.answerId,uri:s.uri,preview:f?React.createElement(n.View.Icon,{additionalCssClass:"feed_preview_icon",icon:s.previewIcon,suggestionText:h}):React.createElement(i.FeedItemPreview,{feedItem:s,previewIcon:s.previewIcon,previewDescription:n.msbDsbHost.getLocString("MeetingRecordingAltTextPattern",s.title),iconDescription:h}),hint:n.msbDsbHost.getLocString("OpenInSharepointHintText"),setPosition:e,setSize:o,instrumentedItem:u.instrumentedItem,isCondensedFeed:f,category:s.category})},v=({feedAnswer:n,setPosition:r,setSize:u,isCondensedFeed:t})=>{const{answerId:f,answerType:e}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerId:f,answerType:e,wrappedComponentName:"FileFeedItemCard"},React.createElement(y,{feedAnswer:n,setPosition:r,setSize:u,isCondensedFeed:t}))},y=({feedAnswer:u,setPosition:e,setSize:o,isCondensedFeed:f})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("FileFeedItem");const s=u.item,c=i.useFileIcon(s.extension);let h="";switch(s.extension){case"pptx":h=n.msbDsbHost.getLocString("PowerpointApplicationIconAltText");break;case"docx":h=n.msbDsbHost.getLocString("WordApplicationIconAltText");break;case"xlsx":h=n.msbDsbHost.getLocString("ExcelApplicationIconAltText");break;default:h=n.msbDsbHost.getLocString("FileIconAltText")}return React.createElement(r,{tidbitItem:s.tidbitItem,body:s.title,bodyLabel:s.title,footer:s.location,icon:s.icon,answerId:u.answerId,uri:s.uri,preview:f?React.createElement(n.View.Icon,{icon:c,suggestionText:h}):React.createElement(i.FeedItemPreview,{feedItem:s,previewIcon:c,previewDescription:n.msbDsbHost.getLocString("FilePreviewAltTextPattern",s.title),iconDescription:h}),hint:n.msbDsbHost.getLocString("OpenInBrowserHintText"),setPosition:e,setSize:o,instrumentedItem:u.instrumentedItem,isCondensedFeed:f,category:s.category})},p=({feedAnswer:n,setPosition:r,setSize:u,isCondensedFeed:t})=>{const{answerId:f,answerType:e}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerId:f,answerType:e,wrappedComponentName:"MentionFeedItemCard"},React.createElement(w,{feedAnswer:n,setPosition:r,setSize:u,isCondensedFeed:t}))},w=({feedAnswer:u,setPosition:e,setSize:o,isCondensedFeed:f})=>{var c;t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("MentionFeedItem");const l=u.item,{processedMessageBody:s,title:a,icon:v,uri:y,tidbitItem:p,category:h,isEmailMention:w}=l;return React.createElement(r,{category:l.category,tidbitItem:l.tidbitItem,body:s.isHtml?React.createElement("div",{dangerouslySetInnerHTML:{__html:s.messageContent}}):React.createElement("p",null,s.messageContent),bodyLabel:(c=s.messageString)!==null&&c!==void 0?c:s.messageContent,footer:a,icon:v,answerId:u.answerId,uri:y,useIcon:!0,preview:f?React.createElement(i.MessageSenderIcon,{iconSize:"64",isTeamsMessage:h==="teamsChatMessage",isEmailMessage:h==="emailMessage"}):React.createElement(i.MessageSenderPreview,{person:p.firstActor,iconSize:"64",isTeamsMessage:h=="teamsChatMessage",isEmailMessage:h=="emailMessage"}),hint:w?n.msbDsbHost.getLocString("OpenEmailHintText"):n.msbDsbHost.getLocString("OpenChatHintText"),setPosition:e,setSize:o,instrumentedItem:u.instrumentedItem,isCondensedFeed:f})};const r=({tidbitItem:w,body:u,bodyLabel:f,category:o,footer:s,icon:c,answerId:r,uri:b,preview:v,useIcon:g,hint:h,setPosition:y,setSize:p,instrumentedItem:l,isCondensedFeed:a})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("FeedItem");const{firstActor:nt,tidbit:ft,secondActor:tt}=w,et=i.useDispatchLaunchUriAction(),ut=n.msbDsbHost.getLocString("YouTidbit"),it=(nt===null||nt===void 0?void 0:nt.isMe)?ut:nt===null||nt===void 0?void 0:nt.fullName,rt=(tt===null||tt===void 0?void 0:tt.isMe)?ut:tt===null||tt===void 0?void 0:tt.fullName;return React.createElement(i.FeedCardBase,{additionalCssClasses:"msbdsb_feed_item msbdsb_selectable",onClick:()=>{et(b)},isClickable:!0,accessibilityProps:{ariaLabel:e(ft,f,h,it,rt),ariaSetPosition:y,ariaSetSize:p},instrumentedItem:l,answerId:r,answerType:"Feed",isCondensedFeed:a},a?React.createElement(k,{tidbitItem:w,category:o,icon:c,preview:v,body:u,firstActorText:it,secondActorText:rt,footer:s,useIcon:g}):React.createElement(d,{useIcon:g,tidbitItem:w,icon:c,firstActorText:it,secondActorText:rt,body:u,footer:s,preview:v}))},o=({tidbitItem:i,firstActorText:n,secondActorText:t})=>{const{firstActor:r,tidbit:f,secondActor:u}=i;return React.createElement(React.Fragment,null,r&&React.createElement("span",{className:`msbdsb_person_name first_actor ${r.isMe?"is_me":""}`},n),React.createElement("span",{className:"msbdsb_annotation"},f),u&&React.createElement("span",{className:`msbdsb_person_name ${u.isMe?"is_me":""}`},t))},b=({useIcon:r,firstActor:n,icon:t})=>React.createElement(React.Fragment,null,!r&&n&&n.fullName?React.createElement("span",{className:"person_icon_container"},React.createElement(i.PersonIcon,{additionalCssClass:"small_person_icon",person:n})):React.createElement(i.FluentIcon,{icon:t,additionalCssClasses:"msbdsb_tidbit_icon"})),k=({tidbitItem:h,icon:f,firstActorText:i,secondActorText:s,category:t,footer:r,useIcon:c,preview:e,body:n})=>{const l=t==="video"?r:null,a=t==="emailMessage"||t==="teamsChatMessage";return React.createElement("div",{className:"msbdsb_condensed_feed"},React.createElement("div",{className:"msbdsb_condensed_feed_icon"},e),React.createElement("div",{className:"msbdsb_feed_card_body"},React.createElement("div",{className:"msbdsb_feed_item_body"},React.createElement("div",{className:"feed_item_details"},a?React.createElement(u,{tidbitItem:h,useIcon:c,icon:f,firstActorText:i,secondActorText:s}):React.createElement("span",{className:"feed_item_content"},n),React.createElement("div",{className:"feed_item_footer"},a?React.createElement("div",{className:"msbdsb_mention_body"},n):React.createElement("div",{className:"msbdsb_feed_tidbit"},React.createElement(o,{tidbitItem:h,firstActorText:i,secondActorText:s}),l?React.createElement("span",null,React.createElement("span",{className:"msbdsb_feed_duration"},"• "),React.createElement("span",null,l)):null))))))},u=({tidbitItem:r,icon:t,firstActorText:n,secondActorText:i,useIcon:u})=>{const{firstActor:f}=r;return React.createElement("div",{className:"msbdsb_feed_item_header"},React.createElement("div",{className:"msbdsb_feed_item_title"},React.createElement(b,{useIcon:u,icon:t,firstActor:f}),React.createElement(o,{tidbitItem:r,firstActorText:n,secondActorText:i})))},d=({useIcon:s,tidbitItem:o,icon:r,firstActorText:t,secondActorText:e,body:n,footer:i,preview:f})=>React.createElement(React.Fragment,null,React.createElement(u,{tidbitItem:o,useIcon:s,icon:r,firstActorText:t,secondActorText:e}),React.createElement("div",{className:"msbdsb_feed_item_body"},React.createElement("div",{className:"feed_item_details"},React.createElement("div",{className:"feed_item_content"},n),React.createElement("div",{className:"feed_item_footer"},i)),f));i.HeroCardRouter=({heroAnswer:n,setPosition:t,setSize:i})=>{var r;switch((r=n.item)===null||r===void 0?void 0:r.category){case"file":return React.createElement(g,{heroAnswer:n,setPosition:t,setSize:i});default:return null}};const g=({heroAnswer:n,setSize:r,setPosition:t})=>{const{answerId:u,answerType:f}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerId:u,answerType:f,wrappedComponentName:"FileHeroCard"},React.createElement(nt,{heroAnswer:n,setPosition:t,setSize:r}))},nt=({heroAnswer:r,setPosition:o,setSize:s})=>{const v=r.item,{extension:k,tidbitItem:y,uri:d,title:l,location:g,icon:nt}=v,tt=i.useFileIcon(k),it=i.useFeedItemPreviewBase64(v,"HeroCard"),rt=`msbdsb-hero-card-${o}`,{firstActor:h,tidbit:ut,secondActor:c}=y,p=(h===null||h===void 0?void 0:h.isMe)?n.msbDsbHost.getLocString("YouTidbit"):h===null||h===void 0?void 0:h.fullName,w=(c===null||c===void 0?void 0:c.isMe)?n.msbDsbHost.getLocString("YouTidbit"):c===null||c===void 0?void 0:c.fullName,ft=i.useDispatchLaunchUriAction();let a=l;const b=a.length>f;return b&&(a=t.DataContext.getTruncatedText(l,f)),React.createElement(i.WithInstrumentation,{instrumentedItem:r.instrumentedItem},React.createElement("button",{role:"link","aria-label":e(ut,l,n.msbDsbHost.getLocString("OpenInBrowserHintText"),p,w),"aria-posinset":o,"aria-setsize":s,className:"msbdsb-file-hero",id:rt,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,onClick:()=>{ft(d)}},React.createElement("div",{className:"msbdsb-hero-preview"},React.createElement("img",{className:"msbdsb-hero-preview-image",src:it}),React.createElement("img",{className:"msbdsb-hero-preview-overlay"}),React.createElement("div",{className:"horizontal_stack msbdsb-hero-title-overlay"},React.createElement(u,{icon:nt,tidbitItem:y,firstActorText:p,secondActorText:w}))),React.createElement("div",{className:"msbdsb-hero-footer"},React.createElement("div",{className:"msbdsb-hero-footer-content horizontal_stack",title:b?l:""},React.createElement("img",{className:"msbdsb-file-hero-icon",role:"presentation",src:tt.content}),React.createElement("div",{className:"hero_body"},React.createElement("div",{className:"msbdsb-file-hero-name"},a),React.createElement("div",{className:"msbdsb-file-hero-tidbit"},g)))),React.createElement("div",{className:"hero-focus-overlay"})))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){t.IndustryNewsFeed=({answer:n})=>{const{answerType:r}=n;return React.createElement(t.MsbDsbErrorBoundary,{answerType:r,wrappedComponentName:"IndustryNewsFeed"},React.createElement(i,{industryNewsAnswer:n}))};const i=({industryNewsAnswer:i})=>{var f;const{instrumentedItem:e,answerId:o,answerType:s}=i,u=i===null||i===void 0?void 0:i.newsItems,h=(f=u===null||u===void 0?void 0:u.length)!==null&&f!==void 0?f:0;return React.createElement(t.WithInstrumentation,{instrumentedItem:e},React.createElement("div",{className:"msbdsb_card_background industry-news"},React.createElement("div",{className:"msbdsb-mp-feed-card msbdsb_indnews",role:"feed","aria-label":n.msbDsbHost.getLocString("IndustryNewsTitle"),id:"msbdsb_industrynews_feed"},React.createElement("div",{className:"header"},React.createElement("div",{className:"horizontal_stack"},React.createElement("span",{className:"horizontal_stack"},React.createElement(t.FluentIcon,{icon:"newsIcon",additionalCssClasses:"news_icon"}),React.createElement("h2",{id:"header_title",className:"header_title news_header_title"},n.msbDsbHost.getLocString("IndustryNewsTitle"))))),React.createElement(t.DismissButton,{answerId:o,answerType:s,buttonId:"msbdsb_industrynews_dismiss",additionalCssClass:"msbdsb_feed_item msbdsb_selectable"}),React.createElement("div",{className:"dsb-suggestions"},u===null||u===void 0?void 0:u.map((n,t)=>React.createElement(r,{feedItem:n,key:t,setPosition:t+1,setSize:h,answerType:i.answerType}))))))},r=({feedItem:i,setPosition:r,setSize:e,answerType:n})=>{const{url:s,instrumentedItem:c,imageInfo:o}=i,l=t.useDispatchLaunchUriAction(),h=o===null||o===void 0?void 0:o.msnImageUrl;return React.createElement(t.FeedCardBase,{additionalCssClasses:"msbdsb_feed_item msbdsb_selectable",onClick:()=>{s&&l(s)},isClickable:!0,accessibilityProps:{ariaLabel:"",ariaSetPosition:r,ariaSetSize:e},instrumentedItem:c,answerId:r.toString(),answerType:n,canBeClosed:!1},React.createElement("div",{className:"msbdsb_news_feed_item_body msbdsb_feed_item_body"},React.createElement("div",{className:"news_feed_item_details feed_item_details"},React.createElement(u,{feedItem:i}),React.createElement(f,{feedItem:i})),h&&React.createElement("img",{className:"msbdsb-news-preview",src:h})))},u=({feedItem:t})=>{const{title:f,publishDate:r,provider:e,msnProviderLogoUrl:i}=t,o=n.getCurrentDate(),u=r?`${n.formatTimePassed(r,o)}`:null,s=i?"msbdsb-news-title":"msbdsb-news-title msbdsb-news-title-extended";return React.createElement("div",{className:"msbdsb-newsfeed_item_content"},i&&React.createElement("img",{className:"msbdsb-news-provider-img",src:i}),React.createElement("span",{className:"msbdsb-news-provider"},e),u&&React.createElement(React.Fragment,null,React.createElement("span",{className:"msbdsb-news-dot"},"·"),React.createElement("span",{className:"msbdsb-timestamp"},u)),React.createElement("div",{className:s},f))},f=({feedItem:t})=>{var r;const{displayFeatures:u}=t,i=(r=u===null||u===void 0?void 0:u.find(n=>n.name==="TenantMostClicked"))===null||r===void 0?void 0:r.value;if(!i)return null;const f=i&&parseInt(i)>1?n.msbDsbHost.getLocString("CoworkersPluralText"):n.msbDsbHost.getLocString("CoworkerSingularText");return React.createElement("div",{className:"msbdsb-newsfeed_item_footer"},React.createElement("div",{className:"msbdsb-news-coworkers"},`${i} ${f}`))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function u(t,r){switch(t){case"MyProfileSearchSuggestion":return React.createElement(i.PersonIcon,{additionalCssClass:"person_icon",person:r});case"EduCardFiles":return React.createElement(n.View.Icon,{additionalCssClass:"edu_icon",icon:{content:n.FILES_SVG_URL,type:0}});case"EduCardMessages":return React.createElement(n.View.Icon,{additionalCssClass:"edu_icon",icon:{content:n.MESSAGES_SVG_URL,type:0}});case"EduCardCalendar":return React.createElement(n.View.Icon,{additionalCssClass:"edu_icon",icon:{content:n.CALENDAR_SVG_URL,type:0}});case"EduCardAssignments":return React.createElement(n.View.Icon,{additionalCssClass:"edu_icon",icon:{content:n.ASSIGNMENTS_SVG_URL,type:0}});case"EduCardClasses":default:return React.createElement(n.View.Icon,{additionalCssClass:"edu_icon",icon:{content:n.CLASSES_SVG_URL,type:0}})}}i.EduCard=()=>{const n=i.useEduCardAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerType:t,wrappedComponentName:"EduCard"},React.createElement(r,{eduCardAnswer:n}))};const r=({eduCardAnswer:r})=>{const{suggestions:f,user:e,instrumentedItem:o}=r,s=i.useDispatchLaunchUriAction(),h=i.useDispatchLaunchProactiveWorkSearchAction(),c=React.useCallback(t=>{const{key:i}=t,r=i=="EduCardAssignments"||i=="MyProfileSearchSuggestion"?n.msbDsbHost.getLocString(i+"Query"):n.Host.getEnUsLocString(i+"Query");if(n.config.msbQwqsEnableWsbClickTarget)n.msbDsbHost.setWsbQuery(r,n.Scope.Work);else if(n.config.msbEnableProactiveSearchTransfers)h({query:r,intent:"None",formCode:n.msbDsbHost.getFormCode(!0),verticalHash:i==="EduCardMessages"?"Message-conversations":undefined});else{const i=n.msbHost.urlUtils.addTransferIgToUrl(t.uri);s(i)}},[]);return React.createElement(i.WithInstrumentation,{instrumentedItem:o},React.createElement("div",{tabIndex:-1,className:`msb_dsb_edu_card ${t.MDSB_LIST_CONTAINER_CLASS}`},f.map((n,r)=>React.createElement(i.WithInstrumentation,{instrumentedItem:n.instrumentedItem,additionalCssClass:"msb_dsb_edu_card_items",isBingTransfer:!0,key:r},React.createElement("button",{className:"msb_dsb_edu_card_item",role:"button",id:`msbdsb-edu_card_${r}`,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,onClick:()=>c(n)},React.createElement("div",{className:"msb_dsb_edu_card_icon_section "+n.color},u(n.key,e)),React.createElement("div",{className:"msb_dsb_edu_card_text_section"},React.createElement("p",{className:"msb_dsb_edu_card_item_text"},n.title)))))))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){const i=({cardAriaLabel:t,clickThroughUrl:r,divStyle:u,isFullText:e,onHoverHandler:o,instrumentedItem:f,children:i})=>React.createElement("div",{className:"msbdsb-mp-edu-imageoftheday-card"},React.createElement("div",{className:n.View.classNames("dsb-hero",e&&"fullText"),onClick:t=>n.clickDSBHandler(t.nativeEvent,r,f),role:"link","aria-label":t,onMouseEnter:o},React.createElement("div",{className:`dsb-hero__img-container`},React.createElement("div",{className:"dsb-hero__img",style:u})),React.createElement("div",{className:"dsb-hero__content-container focusable"},i))),r=()=>React.createElement("div",{className:"msbdsb-mp-edu-fromtheweb-title"},n.msbDsbHost.getLocString("FromTheWebTitle"));t.ImageOfTheDayCard=()=>{var f;const o=t.useImageOfTheDay();if(!o)return null;const{imageOfTheDayScenarios:e,imageHostName:h,instrumentedItem:s}=o;if(!e||e.length<1)return null;const u=e[0],c=n.getImageStyle((f=u.thumbnail)===null||f===void 0?void 0:f.ThumbnailId,0,n.DsbScenario.ImageOfTheDay,h,!1,!0,!0);return React.createElement(t.WithInstrumentation,{instrumentedItem:s},React.createElement(r,null),React.createElement(i,{cardAriaLabel:u.title,clickThroughUrl:u.clickThroughUrl,divStyle:c,instrumentedItem:s,isFullText:u.caption?!0:!1},React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card"},React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__title-caption-content"},React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__title-content"},u.title&&React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__title-text"},u.title),React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__title-copyright"},u.copyright)),React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__caption focusable selectable"},React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__caption-icon"},React.createElement(t.DynamicIcons,{icon:"IotdLocalIcon"})),React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__caption-text"},u.caption)))),React.createElement("div",{className:"msbdsb-mp-edu-imageday-hover-card__bing-logo"},React.createElement(n.View.DSB.BingLogo,null))))}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){t.MsbDsbContainer=()=>{const i=n.msbDsbHost.viewDataManager;return i?React.createElement(i.ContextProvider,null,React.createElement(t.MainPageTemplate,null)):null}})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function f(n,t){var i;((i=n===null||n===void 0?void 0:n.current)===null||i===void 0?void 0:i.classList)&&(n.current.classList.contains(t)||n.current.classList.add(t))}function a(n,t){var i;((i=n===null||n===void 0?void 0:n.current)===null||i===void 0?void 0:i.classList)&&n.current.classList.remove(t)}function r(n,t){return t?`${n}, ${t}`:n}function p(n,t){return i=>{var r;const{charCode:u,ctrlKey:f,shiftKey:e,altKey:o}=i;u!==13||f||e||o||((r=n===null||n===void 0?void 0:n.current)===null||r===void 0?void 0:r.click(),t||i.stopPropagation())}}function w(n){const[t,i]=React.useState(0),[r,u]=React.useState(0);return React.useEffect(()=>{const t=n.current,r=new IntersectionObserver(n=>{const f=n[0];if((f===null||f===void 0?void 0:f.isIntersecting)&&t){const n=t.getBoundingClientRect();i(Math.round(n.left));u(Math.round(n.right));r.disconnect()}});return r.observe(t),()=>{r.disconnect()}},[n.current]),[t,r]}function u(n,t){const i=React.useRef(!0);React.useEffect(()=>{if(i.current){i.current=!1;return}n()},t)}function b(n){if(!n)return Math.floor(Math.random()*t.NUMBER_OF_PROFILE_COLOURS)+1;const i=n.split("").reduce((n,t)=>n+t.charCodeAt(0),0)%t.NUMBER_OF_PROFILE_COLOURS;return i+1}const o=12,s=2,h=40;i.WithInstrumentation=({instrumentedItem:u,additionalCssClass:i,isSelectEvent:e,isBingTransfer:f,children:r})=>{if(!u)return React.createElement("div",{className:i},r);const h=u.getHValue(),o=u.getQsCode(),c=u.getKValue(),s=n.msbDsbHost.instrumentationManager.getInstrumentedItemKey(o,c),l=(i,r)=>{var h;const l=r,c=t.DataContext.getNearestAncestorWithAttribute(l,t.MDSB_INSTRUMENTED_ITEM_ATTRIBUTE),v=c===null||c===void 0?void 0:c.getAttribute(t.MDSB_INSTRUMENTED_ITEM_ATTRIBUTE);if(v===s){const a=n.SequenceNumberManager.getSequenceNumber();if(e&&o)n.InstrumentationHelper.logClientInstEvent("Select",o,a);else{const e=n.getInputType(i);n.InstrumentationHelper.instrumentItemClick(n.getCurrentTime(),u,a,null,e,null);n.msbHost.substrateLogger.logSearchEntityActions("Wsb.DynamicSearchBox");const r=((h=t.DataContext.getNearestAncestorWithAttribute(l,t.MDSB_BING_TRANSFER_ATTRIBUTE))===null||h===void 0?void 0:h.getAttribute(t.MDSB_BING_TRANSFER_ATTRIBUTE))||f?n.msbHost.urlUtils.getTransferIg():undefined;n.msbDsbLogger.logClickEvent(o,Object.assign({redirectTo:n.msbHost.mapRedirectTarget(o)},r?{transferIg:r}:{}))}}};return React.createElement("div",{className:i,onClickCapture:n=>l(n.nativeEvent,n.target),"data-h":h,"data-msb-dsb-inst-key":s},r)};i.DynamicIcons=({icon:t})=>React.createElement(React.Fragment,null,t&&React.createElement(n.View.DSB[t],t));i.PersonIcon=({additionalCssClass:t,person:r})=>{const e=(r===null||r===void 0?void 0:r.uid)?r===null||r===void 0?void 0:r.uid:r===null||r===void 0?void 0:r.email,u=i.usePersonPhotoBase64(e),f=n.View.classNames("icon peopleIcon msbdsb_people_icon people_icon_size",t),o=n.msbDsbHost.getLocString("ProfilePictureAltTextPattern",r.fullName);if(!u){const t=b(r.email||r.fullName),u=n.View.classNames("msbdsb_person_initials",`profile-color-${t}`,f);return React.createElement("div",{className:u,"aria-hidden":"true"},r.initials||React.createElement(i.FluentIcon,{icon:"personIcon",additionalCssClasses:"msbdsb_person_icon_fallback"}))}return React.createElement("img",{className:f,src:`data:image/png;base64,${u}`,alt:o})};i.HeaderSection=()=>n.config.useCobaltCSS?React.createElement(c,null):null;const c=()=>{const t=i.useTenantDisplayName(),r=n.msbDsbHost.getLocString("CobaltTodayAtHeader",t),u=n.msbDsbHost.getLocString("RecommendedForYou");return React.createElement("h4",{className:"groupTitle msb-dsb-today-at"},n.msbHost.isEduTenant()?u:r)};i.PopularTenantSearchesCard=()=>{const n=i.usePopularSearchesAnswer();if(!n)return null;const{answerType:t}=n;return React.createElement(i.MsbDsbErrorBoundary,{answerType:t,wrappedComponentName:"PopularTenantSearchesCard"},React.createElement(l,{popularSearchesAnswer:n}))};const l=({popularSearchesAnswer:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError("PopularTenantSearches");const u=i.useTenantDisplayName();if(!r)return null;const{searchQueries:f,instrumentedItem:e}=r;if(!f||f.length===0)return null;const s=u&&(u===null||u===void 0?void 0:u.length)<o?n.msbDsbHost.getLocString("PopularSearchesTitle",u):n.msbDsbHost.getLocString("PopularSearchesFallbackTitle"),h=f.map(t=>({title:t.title,scope:n.Scope.Work}));return React.createElement(i.SearchSuggestionsCard,{title:s,icon:"arrowTrendingIcon",sectionId:"popular_search",suggestions:h,instrumentedItem:e,maxRows:n.config.msbDsbPopularSearchRows})};i.SearchSuggestionsContainer=React.forwardRef(({title:e,icon:u,sectionId:f,additionalCssClasses:n,children:r},o)=>React.createElement("div",{className:`msbdsb_feed_card msbdsb_search_suggestions_card ${n}`,role:"group","aria-labelledby":`msbdsb_search_suggestions_title_${f}`},React.createElement("div",{className:"msbdsb_search_suggestions_card_title_container msbdsb_feed_item_header"},React.createElement(i.FluentIcon,{icon:u,additionalCssClasses:"msbdsb_search_suggestions_card_title_icon"}),React.createElement("div",{role:"heading",className:"msbdsb_search_suggestions_title",id:`msbdsb_search_suggestions_title_${f}`},e)),React.createElement("div",{ref:o,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`msbdsb_search_suggestions_container ${t.MDSB_LIST_CONTAINER_CLASS}`},r)));i.SearchSuggestionsCard=({title:a,icon:f,sectionId:c,suggestions:l,instrumentedItem:e,maxRows:h,additionalCssClasses:r,maxCharLimit:o})=>{const[v,p]=React.useState(l.length),w=i.useDispatchSetWsbRequeryAction(),y=React.useRef(null),b=n=>`msbdsb_search_suggestions_${c}_${n}`;return React.useEffect(()=>{const n=y.current,t=new IntersectionObserver(i=>{var r;if(n){const u=n.firstElementChild;if(((r=i[0])===null||r===void 0?void 0:r.isIntersecting)&&u){const i=u.getBoundingClientRect(),f=i.bottom-i.top,e=h!==null&&h!==void 0?h:s,o=f*e+i.top;let n=u.nextElementSibling,r=1;while(n&&r<l.length&&n.getBoundingClientRect().top<o)n=n.nextElementSibling,r++;p(r);t.disconnect()}}});return n&&t.observe(n),()=>t.disconnect()},[l]),u(()=>{n.msbDsbHost.updateInteractionModel()},[v]),React.createElement(i.WithInstrumentation,{instrumentedItem:e},React.createElement(i.SearchSuggestionsContainer,{title:a,icon:f,sectionId:c,ref:y,additionalCssClasses:r},l.slice(0,v).map((n,r)=>{var u;const f=r+1,e=n.title,s=(u=n.query)!==null&&u!==void 0?u:n.title,h=n.scope;return React.createElement(i.SuggestionPill,{searchText:e,id:b(r),maxDisplayedChars:o!==null&&o!==void 0?o:t.DEFAULT_SUGGESTION_CARD_CHAR_LIMIT,icon:n.icon,accessibilityProps:{ariaSetPosition:f,ariaSetSize:v},onClick:()=>w(s,h)})})))};i.FeedCardBase=({isClickable:l,additionalCssClasses:u,onClick:v,accessibilityProps:r,answerType:e,answerId:f,instrumentedItem:c,dismissalInstrumentedItem:h,children:s,canBeClosed:o,isCondensedFeed:a})=>{const{ariaLabel:nt,ariaLabelledBy:tt,ariaSetPosition:p,ariaSetSize:it,role:w}=r;let b=a?"msbdsb_condensed_feed_card":"msbdsb_feed_card";const rt=n.msbDsbHost.getLocString("FeedDismissalButtonToolTipText");l&&(b=n.View.classNames(b,"msbdsb_feed_card_clickable"));const ut=n.View.classNames(b,u),d=t.DataContext.isViewModelAnswerTypeDynamicM365(e),k=d&&!p?1:p,ft=d?`msbdsb-dynamic-card-${k}`:`msbdsb-feed-card-${k}`,et=`msbdsb-feed-dismiss-${k}`,y=React.useRef(null),g=React.useRef(null),ot=o===undefined||o;return React.createElement("div",{ref:g,className:ut},ot&&React.createElement(i.WithInstrumentation,{instrumentedItem:h,isSelectEvent:!0,additionalCssClass:"overlapping_area dismiss_button"},React.createElement(i.DismissButton,{ref:y,buttonId:et,answerType:e,answerId:f,parentCardRef:g,additionalCssClass:"dismiss",buttonHint:rt,isCondensedFeed:a})),React.createElement(i.WithInstrumentation,{instrumentedItem:c,additionalCssClass:"overlapping_area"},React.createElement("button",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:w!==null&&w!==void 0?w:"link","aria-label":nt,"aria-labelledby":tt,"aria-posinset":p,"aria-setsize":it,onClick:v,className:"msbdsb_feed_card_content",onFocus:()=>{var n,t;(n=y.current)===null||n===void 0?void 0:n.classList.remove("collapsed");(t=y.current)===null||t===void 0?void 0:t.classList.add("visible")},onBlur:()=>{var n,t;(n=y.current)===null||n===void 0?void 0:n.classList.remove("visible");(t=y.current)===null||t===void 0?void 0:t.classList.add("collapsed")},id:ft},React.createElement("div",{className:`msbdsb_feed_card_body ${a&&"msbdsb_feed_condensed_body"}`},s))))};i.FeedItemPreview=({feedItem:t,previewIcon:f,previewDescription:u,iconDescription:r})=>{const e=i.useFeedItemPreviewBase64(t);return React.createElement("div",null,e?React.createElement("div",{className:"feed_item_preview"},React.createElement("img",{className:"feed_preview_image",src:e,alt:u}),f&&React.createElement(n.View.Icon,{additionalCssClass:"feed_preview_icon",icon:f,suggestionText:r})):f&&React.createElement("div",{className:"feed_item_preview"},React.createElement(n.View.Icon,{additionalCssClass:"feed_icon_no_preview",icon:f,suggestionText:r})))};i.DismissButton=React.forwardRef(({answerType:e,answerId:f,buttonId:s,additionalCssClass:u,buttonHint:o,parentCardRef:c,isCondensedFeed:h},l)=>{const v=i.useDispatchDismissAnswerAction(),y=i.useShouldShowWideLayout();if(y)return null;const a=()=>{n.msbDsbLogger.logClickEvent("DismissAnswer",{answerType:e}),v(e,f,{dismissOnView:!0,dismissViaRequest:!0})},p=()=>{var t;(t=n.msbDsbHost.keyNavManager)===null||t===void 0?void 0:t.reapplyKeyboardFocus(s);a()},w=n.View.classNames("dismiss msbdsb_nested_button",u);return React.createElement("button",{ref:l,id:s,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:w,"aria-label":r(n.msbDsbHost.getLocString("DismissButtonLabel"),o),onClick:n=>{n.stopPropagation(),a()},onMouseOver:()=>{var n;h&&((n=c===null||c===void 0?void 0:c.current)===null||n===void 0?void 0:n.classList.add("condensed_feed_card_background"))},onMouseOut:()=>{var n;h&&((n=c===null||c===void 0?void 0:c.current)===null||n===void 0?void 0:n.classList.remove("condensed_feed_card_background"))},onKeyPress:p},React.createElement(i.FluentIcon,{icon:"cancelIcon",additionalCssClasses:"cancel_icon"}))});i.MessageSenderPreview=({person:f,iconSize:t,isEmailMessage:r,isTeamsMessage:u})=>{const e="sender_"+t.toString();return React.createElement("div",{className:"sender_preview"},React.createElement(i.PersonIcon,{person:f,additionalCssClass:n.View.classNames(e,"sender_person_icon")}),React.createElement(i.MessageSenderIcon,{iconSize:t,isEmailMessage:r,isTeamsMessage:u}))};i.MessageSenderIcon=({isEmailMessage:r,isTeamsMessage:u,iconSize:t})=>{const e="sender_"+t.toString(),f=n.View.classNames(e,"sender_location_icon");return React.createElement(React.Fragment,null,r?React.createElement(i.OutlookIcon,{cssClasses:f}):u?React.createElement(i.TeamsIcon,{cssClasses:f}):null)};i.FeedbackTooltip=({propertyIndex:h,parentButtonRef:s,answer:e,itemId:o})=>{const{traceId:at,answerId:vt,answerType:l,positiveFeedbackInstrumentedItem:yt,negativeFeedbackInstrumentedItem:pt}=e,[c,wt]=React.useState("RequestFeedback"),bt=i.useDispatchDismissAnswerAction(),it=n.msbDsbHost.getLocString("FeedbackButtonHintText"),rt=n.msbDsbHost.getLocString("PositiveFeedback"),ut=n.msbDsbHost.getLocString("NegativeFeedback"),ft=`msb-dsb-negative-feedback-button-${h}`,et=`msb-dsb-positive-feedback-button-${h}`,v="msb-dsb-feedback-tooltip-id",w=n.View.classNames(t.MDSB_FEEDBACK_ELEMENT_CLASS,"msbdsb_hyperlink","feedback-button"),kt="msb-dsb-visible-item",[dt,b]=React.useState(!1);React.useEffect(()=>{n.msbDsbFeedbackTracker.getHasProvidedFeedbackAsync(o).then(t=>{b(!t),n.msbDsbHost.updateInteractionModel(!0)})},[o]);const[ot,k]=React.useState(!1),[gt,ni]=React.useState(!1),st=React.useRef(null),y=React.useRef(null),ht=n.msbDsbHost.getLocString("FeedbackQueryText");let d=!1;const ti=300,p=(n,t,i)=>{d=!1,sb_st(()=>{var n;d||((n=y.current)===null||n===void 0?void 0:n.contains(document.activeElement))||!i||a(t,i)},n),gt&&b(!1)},g=(n,t)=>{d=!0,t&&f(n,t)},ct=n=>{const i=n===y?kt:t.VISIBLE_TOOLTIP_CLASS;(n===null||n===void 0?void 0:n.current)&&(n===s&&(n.current.onfocus=()=>{g(n,i)},n.current.onblur=()=>{p(0,n,i)}),n.current.onmouseenter=()=>{g(n,i)},n.current.onmouseleave=()=>{p(ti,n,i)})};ct(s);ct(y);const nt=()=>g(s,t.VISIBLE_TOOLTIP_CLASS),tt=()=>p(0,s,t.VISIBLE_TOOLTIP_CLASS),lt=async(t,i)=>{t.stopPropagation();const r=i||l=="MeetingPrep"?"AcknowledgeFeedbackProvided":"RequestAdvancedFeedback";wt(r);await n.msbDsbFeedbackTracker.updateProvidedFeedbackIdAsync(o);l==="MeetingPrep"&&n.msbDsbSubstrateLogger.logSearchFeedbackEvent(l,n.getDateWithTimezone(),i?"Yes":"No",ht,o,at);i||l!="FileRequest"||bt(l,vt,{dismissViaRequest:!0,dismissOnView:!1});ni(!0)};return u(()=>{var i;if(c==="RequestAdvancedFeedback"?n.msbDsbHost.updateInteractionModel(!0):(ot&&((i=n.msbDsbHost.keyNavManager)===null||i===void 0?void 0:i.reapplyKeyboardFocus(et)),n.msbDsbHost.updateInteractionModel()),c!=="RequestFeedback"&&ot){const n=c=="AcknowledgeFeedbackProvided"?s:st;(n===null||n===void 0?void 0:n.current)&&(n.current.focus(),f(n,t.MDSB_KEYBOARD_FOCUS_CLASS),c=="AcknowledgeFeedbackProvided"&&(n.current.onblur=()=>{b(!1)}));k(!1)}},[c]),dt?React.createElement("span",{"data-msb-dsb-delay-blur":!0,id:`msb-dsb-tooltip-${h}`,ref:y,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`${"msb-dsb-feedback-tooltip msb-dsb-tooltip-text small-tooltip right-aligned-tooltip hide-tail"} ${t.MDSB_LIST_CONTAINER_CLASS}`,"aria-live":"polite","aria-labelledby":v,onMouseLeave:()=>p(0,s)},c==="RequestFeedback"&&React.createElement("div",{id:v,"aria-labelledby":"feedback-text",className:"horizontal_stack feedback-tooltip-content"},React.createElement("div",{id:"feedback-text",className:"feedback-text"},ht),React.createElement(i.WithInstrumentation,{instrumentedItem:yt,isSelectEvent:!0},React.createElement("button",{id:et,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:w,"aria-label":r(rt,it),onClick:async n=>{await lt(n,!0)},onKeyPress:()=>{k(!0)},onFocus:nt,onBlur:tt},rt)),React.createElement(i.WithInstrumentation,{instrumentedItem:pt,isSelectEvent:!0},React.createElement("button",{id:ft,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:w,"aria-label":r(ut,it),onClick:async n=>{await lt(n,!1)},onKeyPress:()=>{k(!0)},onFocus:nt,onBlur:tt},ut))),c==="AcknowledgeFeedbackProvided"&&React.createElement("p",{className:"feedback-tooltip-content",id:v,"aria-label":n.msbDsbHost.getLocString("AcknowledgeFeedbackProvidedText")},n.msbDsbHost.getLocString("AcknowledgeFeedbackProvidedText")),c==="RequestAdvancedFeedback"&&React.createElement("div",{className:"feedback-tooltip-content",id:v,role:"text","aria-label":n.msbDsbHost.getLocString("NegativeFeedbackProvidedText")},n.msbDsbHost.getLocString("NegativeFeedbackProvidedText")," ",React.createElement("button",{ref:st,id:ft,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:w,onFocus:nt,onBlur:tt,onClick:t=>{n.Host.showFeedbackForm(),t.stopPropagation()}},n.msbDsbHost.getLocString("RequestAdvancedFeedbackLinkText")))):null};i.SuggestedInfoIcon=({additionalCssClasses:r,containerLeft:u,containerRight:f})=>{const l=n.View.classNames(r,"info-icon-tooltip-base"),[a,h]=React.useState(!1),[c,e]=React.useState(0),o=React.useRef(),s=React.useRef();return React.useEffect(()=>{const t=o.current,n=s.current,i=new IntersectionObserver((i,r)=>{const o=i[0];if((o===null||o===void 0?void 0:o.isIntersecting)&&t&&n){const o=n.getBoundingClientRect(),s=Math.round((o.left+o.right)/2),i=Math.round(t.getBoundingClientRect().width),h=f-s,c=s-u;i/2>h?e(-1*h):i/2>c?e(c-i):e(i/-2);r.disconnect()}});return i.observe(n),()=>{i.disconnect()}},[o.current,s.current,u,f]),React.createElement("span",{id:"suggested-info-icon",className:l,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,role:"tooltip","aria-labelledby":"suggested_info_tooltip",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1)},React.createElement("span",{id:"suggested_info_tooltip",className:"info-icon-tooltip",ref:o,style:c?{right:`${c}px`}:{}},n.msbDsbHost.getLocString("SuggestedInfoToolTipText")),React.createElement("span",{className:"suggested_info",ref:s,onClick:n=>{n.stopPropagation()}},a?React.createElement(i.FluentIcon,{icon:"infoIconHover",additionalCssClasses:"info_icon"}):React.createElement(i.FluentIcon,{icon:"infoIcon",additionalCssClasses:"info_icon"})))};i.SearchSuggestions=({suggestions:r,instrumentedItem:n,suggestionsListId:u})=>{if(!r||r.length==0)return null;const f=i.useDispatchSetWsbRequeryAction();return React.createElement(i.WithInstrumentation,{instrumentedItem:n},React.createElement("div",{className:`msb_dsb_search_suggestion_container ${t.MDSB_LIST_CONTAINER_CLASS}`,tabIndex:-1},r===null||r===void 0?void 0:r.map((n,t)=>React.createElement(i.SuggestionPill,{id:`${u}_${t}`,searchText:n.title,accessibilityProps:r.length>1?{ariaSetPosition:t+1,ariaSetSize:r.length}:{},onClick:t=>{f(n.title,n.scope),t.stopPropagation()},icon:n.icon}))))};i.LearningCard=({learningAnswer:r})=>{const{suggestions:u,instrumentedItem:f}=r,e=u?u.length:0,o=i.useDispatchLaunchUriAction(),s=i.useDispatchLaunchProactiveWorkSearchAction(),h=React.useCallback(t=>{if(n.config.msbEnableProactiveSearchTransfers)s({query:t.title,intent:"None",formCode:n.msbDsbHost.getFormCode()});else{const i=n.msbHost.urlUtils.addTransferIgToUrl(t.uri);o(i)}},[]);return React.createElement("div",{className:"msbdsb_learning_card"},React.createElement("div",null,React.createElement("div",{className:"learning_card_header",role:"text"},React.createElement("div",{className:"learning_card_title"},n.msbDsbHost.getLocString("LearningCardTitle")),React.createElement("div",{className:"learning_card_details"},n.msbDsbHost.getLocString("LearningCardDetails"))),React.createElement("div",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`learning_card_suggestions_container ${t.MDSB_LIST_CONTAINER_CLASS}`},u.map((n,t)=>{const r=t+1;return React.createElement(i.WithInstrumentation,{instrumentedItem:f,isBingTransfer:!0},React.createElement(i.SuggestionPill,{key:`learning-card-suggestion-${t}`,id:`suggestion-${t}`,searchText:n.title,accessibilityProps:{ariaSetPosition:r,ariaSetSize:e},onClick:()=>h(n)}))}))),React.createElement(i.WebSearchImage,null))};i.MsbDsbErrorBoundary=({children:r,wrappedComponentName:o,answerId:n,answerType:t,fallback:u,fallbackInstrumentSectionName:f})=>{const s=i.useErrorBoundaryResetKey(),h=i.useDispatchHideAnswerAction();return React.createElement(e,{answerId:n,answerType:t,fallback:u,fallbackInstrumentSectionName:f,hideAnswer:h,key:s,wrappedComponentName:o},r)};class e extends React.Component{constructor(){super(...arguments);this.state={error:undefined,fallbackInstrumentedItem:undefined}}componentDidCatch(t){const{answerId:e,answerType:u,fallback:o,fallbackInstrumentSectionName:f,hideAnswer:s,wrappedComponentName:i}=this.props,{fallbackInstrumentedItem:h}=this.state;let r=h;if(u)try{s(u,e)}catch(t){const r=t instanceof Error?t.message:"Unknown error",u=JSON.stringify(t,Object.getOwnPropertyNames(t));n.msbDsbLogger.logError("Wsb Dsb Error Boundary Hide Answer Error",r,u)}try{o&&f&&!r&&(r=n.msbDsbHost.instrumentationManager.createInstrumentedItem(f))}catch(t){const r=t instanceof Error?t.message:"Unknown error",u=JSON.stringify(t,Object.getOwnPropertyNames(t));n.msbDsbLogger.logError("Wsb Dsb Error Boundary Create Instrumented Item Error",r,u)}this.setState({error:t,fallbackInstrumentedItem:r});n.msbDsbLogger.logUiError(t,i)}render(){const{error:t,fallbackInstrumentedItem:r}=this.state,{children:u,fallback:f,wrappedComponentName:e}=this.props;if(t){const u=React.createElement(i.WithInstrumentation,{instrumentedItem:r},f),o=n.msbHost.isMsbInternalTenant();if(o&&n.TestHookUrlParameters){const n=`[Error][MsbDsb] ${e} failed to render: ${t}`;return React.createElement("div",{className:"msbdsb_errorboundary_msit_block"},u,React.createElement("div",{className:"msbdsb_errorboundary_msit_error"},n))}return React.createElement(React.Fragment,null,u)}return u}}i.MsbDsbErrorBoundaryImpl=e;i.MsbDsbErrorBoundaryDefaultFallback=()=>{const r=t.DataContext.createLearningCardViewDataModel();return r?(React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[]),React.createElement("div",{className:"msbdsb_card_background"},React.createElement("div",{className:"msbdsb-mp-feed-card",role:"feed","aria-label":n.msbDsbHost.getLocString("BaseCardTitle")},React.createElement(i.M365FeedHeader,null),React.createElement("div",{className:"dsb-suggestions"},React.createElement(i.LearningCard,{learningAnswer:r}))))):null};i.OutlookIcon=({cssClasses:t})=>{const i=n.View.classNames("outlook_icon",t);return React.createElement(n.View.Icon,{additionalCssClass:i,icon:n.msbHost.iconUtils.getFluentIcon("outlookIcon")})};i.TeamsIcon=({cssClasses:t})=>{const i=n.View.classNames("teams_icon",t);return React.createElement(n.View.Icon,{additionalCssClass:i,icon:n.msbHost.iconUtils.getFluentIcon("teamsIcon")})};i.Microsoft365Icon=({cssClasses:t})=>{const i=n.View.classNames("microsoft365_icon",t);return React.createElement(n.View.Icon,{additionalCssClass:i,icon:n.msbHost.iconUtils.getFluentIcon("microsoft365Icon")})};i.WebSearchImage=({cssClasses:t})=>{const i=n.View.classNames("msbdsb_web_search_image",t),[r,u]=React.useState(!1);return React.useEffect(()=>{const t=()=>u(n.isDarkModeEnabled());return n.Host.bindShown(t),()=>{n.Host.unbindShown(t)}},[]),React.createElement(n.View.Icon,{additionalCssClass:i,icon:r?n.msbHost.iconUtils.getFluentIcon("webSearchDarkIcon"):n.msbHost.iconUtils.getFluentIcon("webSearchLightIcon")})};i.FluentIcon=({icon:r,additionalCssClasses:t})=>{const u=n.View.classNames("msbdsb_fluent_icon",t),f=i.useFluentIconSvgHtml(r);return React.createElement("div",{className:u,dangerouslySetInnerHTML:{__html:f}})};i.M365FeedHeader=()=>React.createElement("div",{className:"header"},React.createElement("div",{className:"horizontal_stack"},React.createElement("span",{className:"horizontal_stack"},React.createElement(i.Microsoft365Icon,{cssClasses:"company_icon"}),React.createElement("h2",{id:"header_title",className:"header_title"},n.msbDsbHost.getLocString("BaseCardTitle")))));i.WsbPeopleRequery=({id:s,query:c,referenceId:l,answerType:f,accessibilityProps:r,additionalCssClasses:u,children:o,childRef:e,isTabbable:h,traceId:a})=>{const v=i.useDispatchSetWsbRequeryAction(),y=()=>{n.msbDsbSubstrateLogger.logSearchEntityActions(f,n.getDateWithTimezone(),"entityclicked",l,a);const t=n.msbHost.features.isWorkScopeDsbRedirectEnabled()?n.Scope.Work:n.Scope.People;v(c,t)},p=n.View.classNames("people_requery_link",u);return React.createElement("button",{id:s,className:p,tabIndex:h?t.TAB_NAVIGATION_TAB_INDEX:null,ref:e,role:"button",onClick:n=>{y(),n.stopPropagation()},"aria-label":r.ariaLabel,"aria-labelledby":r.ariaLabelledBy,"aria-posinset":r.ariaSetPosition,"aria-setsize":r.ariaSetSize},o)};i.PeopleCentricSuggestions=({fullName:n,sectionName:r})=>{const[u,f]=React.useState(t.DataContext.generateRandomPersonCentricSuggestions(n));return!n||!u?null:(React.useEffect(()=>{f(t.DataContext.generateRandomPersonCentricSuggestions(n))},[n]),React.createElement(i.MsbDsbErrorBoundary,{wrappedComponentName:"PeopleCentricSuggestions"},React.createElement(v,{suggestions:u,sectionName:r})))};i.SuggestionPill=({searchText:s,accessibilityProps:n,onClick:o,icon:u,id:f,maxDisplayedChars:e,buttonProps:r})=>{const[a,c]=React.useState(s),[v,l]=React.useState(!1);return React.useEffect(()=>{const n=e!==null&&e!==void 0?e:h;s.length>n?(c(t.DataContext.getTruncatedText(s,n)),l(!0)):(c(s),l(!1))},[s,e]),React.createElement("button",Object.assign({id:f,tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:"msbdsb_suggestion_pill msb-dsb-tooltip","aria-label":s,"aria-posinset":n.ariaSetPosition,"aria-setsize":n.ariaSetSize,onClick:o},r),v&&React.createElement("div",{className:"msb-dsb-tooltip-text msbdsb_suggestion_pill_tooltip hide-tail"},s),React.createElement("div",{className:"msbdsb_suggestion_contents horizontal_stack hideable"},u&&React.createElement(i.FluentIcon,{icon:u,additionalCssClasses:"suggestion_pill_icon"}),React.createElement("div",{className:"msbdsb_suggestion_pill_txt"},a)))};const v=({suggestions:u,sectionName:r})=>{t.checkTestHookParamsAndThrowError===null||t.checkTestHookParamsAndThrowError===void 0?void 0:t.checkTestHookParamsAndThrowError(r);const c=i.useDispatchSetWsbRequeryAction(),[f,o]=React.useState([]);React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[f.length]);const s=React.useRef(null),e=React.useRef(null),l=(n,t,i)=>{const f=i[0],{isIntersecting:e}=f;let r=n.firstElementChild;if(e&&r){let f=0,i=-1;const{paddingLeft:e,paddingRight:s}=window.getComputedStyle(n),c=parseFloat(e)||0,l=parseFloat(s)||0,a=n.clientWidth-c-l;do f+=Math.abs(r.getBoundingClientRect().right-r.getBoundingClientRect().left),i+=1,r=r.nextElementSibling;while(f<=a&&i<u.length&&r);o(u.slice(0,i));h(t)}},h=n=>{n.disconnect()};return React.useEffect(()=>{var n;o(u);const t=s.current;return t&&(e.current=new IntersectionObserver(n=>l(t,e.current,n)),(n=e.current)===null||n===void 0?void 0:n.observe(t)),()=>{h(e.current)}},[u]),React.createElement("div",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,ref:s,className:`msb_dsb_person_centric_search ${t.MDSB_LIST_CONTAINER_CLASS}`},f===null||f===void 0?void 0:f.map((n,t)=>{const f=`msbdsb_search_suggestions_${r}_${t+1}`;return React.createElement(i.WithInstrumentation,{key:f,instrumentedItem:n.instrumentedItem,additionalCssClass:"msb_dsb_inline_instrumentation_container"},React.createElement(i.SuggestionPill,{searchText:n.title,icon:"searchIcon",id:f,key:n.title,accessibilityProps:{ariaSetPosition:t+1,ariaSetSize:u.length},onClick:()=>c(n.query,n.scope)}))}))},y=({paginationId:u,pageIndex:r,activePageIndex:t})=>{const f=i.useDispatchNavigatePageAction(),e=t=>{const i={PaginationId:u};n.InstrumentationHelper.logClientInstEvent("Select","MsbDsbPaginationDotSelected",n.SequenceNumberManager.getSequenceNumber(),i);f(u,t)},o=r==t?"msb_dsb_pagination_dot msb_dsb_pagination_dot_active":"msb_dsb_pagination_dot";return React.createElement("span",{className:o,onClick:()=>e(r),id:`msb_dsb_pagination_dot_${u}_${r}`})};i.PaginationDotList=({paginationId:i,currentPageIndex:n,numberOfPages:t})=>{if(t<=1)return null;const r=[];for(let u=0;u<t;u++){const t=React.createElement(y,{paginationId:i,pageIndex:u,activePageIndex:n,key:`${i}-${u}`});r.push(t)}return React.createElement("div",{className:"msb_dsb_pagination_dot_list_container"},React.createElement("div",{className:"msb_dsb_pagination_dot_list"},r))};i.FlipperControl=({controlType:r,paginationId:e,currentPageIndex:u,numberOfPages:f})=>{if(f<=1)return null;const s=i.useDispatchNavigatePageAction(),[h,c]=useState(null),l=t=>{const r={PaginationId:e};n.InstrumentationHelper.logClientInstEvent("Select","MsbDsbPaginationFlipperSelected",n.SequenceNumberManager.getSequenceNumber(),r);const i=(u+t+f)%f;s(e,i);c(`Page ${i+1}`)};let o=r=="NEXT"?"flipper_next":"flipper_prev";o=o.concat(" msb_dsb_pagination_flipper_always_show");const a=r=="NEXT"?React.createElement(i.FluentIcon,{icon:"caretRight",additionalCssClasses:"msbdsb_pagination_flipper_right_icon"}):React.createElement(i.FluentIcon,{icon:"caretLeft",additionalCssClasses:"msbdsb_pagination_flipper_left_icon"}),v=r=="NEXT"?1:-1,y=r=="NEXT"?n.msbDsbHost.getLocString("RecommendPeopleNextPage",`${u+1}`):n.msbDsbHost.getLocString("RecommendPeoplePreviousPage",`${u+1}`);return React.createElement("div",{"aria-live":"polite"},React.createElement("button",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,id:`msb_dsb_pagination_flipper_${e}_${r}`,className:`msb_dsb_pagination_flipper ${o}`,onClick:()=>{l(v)},"aria-label":y},a),React.createElement("div",{className:"b_hide"},h))};i.PaginationFlippersControl=({paginationId:f,currentPageIndex:r,numberOfPages:u})=>(React.useEffect(()=>{n.msbDsbHost.updateInteractionModel()},[r]),React.createElement("div",{tabIndex:t.TAB_NAVIGATION_TAB_INDEX,className:`msb_dsb_recommendedpeople_flipper ${t.MDSB_LIST_CONTAINER_CLASS}`},React.createElement(i.FlipperControl,{controlType:"PREV",paginationId:f,numberOfPages:u,currentPageIndex:r}),React.createElement(i.FlipperControl,{controlType:"NEXT",paginationId:f,numberOfPages:u,currentPageIndex:r})));i.M365HeaderCard=({isCondensed:r,children:t})=>React.createElement("div",{className:"msbdsb_card_background"},React.createElement("div",{className:`msbdsb-mp-feed-card ${!!r&&"msbdsb-condensed-feed-card"}`,role:"feed","aria-label":n.msbDsbHost.getLocString("BaseCardTitle")},React.createElement(i.M365FeedHeader,null),React.createElement("div",{className:"dsb-suggestions"},t)));i.combineLabelAndHintText=r;i.makeEnterKeyAsClickInRefComponentHandler=p;i.useSuggestionsInfoTooltipDimensions=w;i.useEffectSkipFirstRender=u})(i=t.Components||(t.Components={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){var t;(function(n){function i(n,i,r=t){if(!n||!i)return null;let f=0,u=n;while(u&&!u.hasAttribute(i)&&f++<r)u=u.parentElement;return(u===null||u===void 0?void 0:u.hasAttribute(i))?u:null}const t=30;n.getNearestAncestorWithAttribute=i})(t=n.DataContext||(n.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){var t;(function(n){function t(n){return{type:"SET_MY_ORG_CHART_EXPANSION",isExpanded:n}}function i(n){return{type:"SET_EDU_CLASSES_EXPANSION",isExpanded:n}}function r(n){return{type:"SET_EDU_ASSIGNMENTS_EXPANSION",isExpanded:n}}function u(n){return{type:"SET_PEOPLE_SHUFFLE",shuffledPeople:n}}function f(n){return{type:"SET_LAST_SELECTED_SCOPE",lastSelectedScope:n}}function e(n){return{type:"SET_MAIN_PAGE_DATA",mainPageData:n}}function o(n,t){return{type:"SET_PERSON_PHOTO",photoKey:n,photo:t}}function s(n,t){return{type:"SET_GROUP_PHOTO",photoKey:n,photo:t}}function h(n){return{type:"SET_IMAGE_OF_THE_DAY",imageOfTheDay:n}}function c(){return{type:"FETCH_IMAGE_OF_THE_DAY"}}function l(n){return{type:"FETCH_PERSON_PHOTO",photoKey:n}}function a(n){return{type:"FETCH_GROUP_PHOTO",photoKey:n}}function v(n,t,i){return{type:"DISMISS_ANSWER",answerType:n,answerId:t,dismissAction:i}}function y(n,t){return{type:"HIDE_ANSWER",answerType:n,answerId:t}}function p(n,t){return{type:"SET_FEED_ITEM_PREVIEW",feedItemId:n,itemPreview:t}}function w(n,t){return{type:"FETCH_FEED_ITEM_PREVIEW",feedItem:n,size:t}}function b(n,t){return{type:"SET_FILE_ICON",extension:n,fileIcon:t}}function k(n){return{type:"FETCH_FILE_ICON",extension:n}}function d(n,t){return{type:"SET_FLUENT_ICON_SVG_HTML",icon:n,svgHtml:t}}function g(n){return{type:"FETCH_FLUENT_ICON_SVG_HTML",icon:n}}function nt(n,t){return{type:"SET_WSB_REQUERY",query:n,scope:t}}function tt(n){return{type:"LAUNCH_URI",uri:n}}function it(n){return{type:"LAUNCH_PROACTIVE_WORK_SEARCH",args:n}}function rt(){return{type:"FORCE_DSB_REFRESH_ACTION"}}function ut(n){return{type:"SET_RECOMMENDED_PEOPLE_PAGINATION_SETTING",paginationSetting:n}}function ft(n,t){return{type:"NAVIGATE_PAGE",paginationId:n,targetPageIndex:t}}function et(){return{type:"SET_CHAT_UPSELL_CURRENT_IDX"}}n.setMyOrgChartExpansionAction=t;n.setEduClassesExpansionAction=i;n.setEduAssignmentsExpansionAction=r;n.setPeopleShuffleAction=u;n.setLastSelectedScopeAction=f;n.setMainPageDataAction=e;n.setPersonPhotoAction=o;n.setGroupPhotoAction=s;n.setImageOfTheDayAction=h;n.fetchImageOfTheDayAction=c;n.fetchPersonPhotoAction=l;n.fetchGroupPhotoAction=a;n.dismissAnswerAction=v;n.hideAnswerAction=y;n.setFeedItemPreviewAction=p;n.fetchFeedItemPreviewAction=w;n.setFileIconAction=b;n.fetchFileIconAction=k;n.setFluentIconSvgHtmlAction=d;n.fetchFluentIconSvgHtmlAction=g;n.setWsbRequeryAction=nt;n.launchUriAction=tt;n.launchProactiveWorkSearch=it;n.forceDSBRefreshAction=rt;n.setRecommendedPeoplePaginationSettingAction=ut;n.navigatePageAction=ft;n.setChatUpsellCurrIdxStateAction=et})(t=n.DataContext||(n.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){t.CacheSchemaVersion=8;const i="mdsb-",r=i+"v";class u{constructor(){n.Host.bindBootstrapDone(async()=>{this.pendingEnsureVersionPromise=this.ensureVersionAsync();try{await this.pendingEnsureVersionPromise}catch(t){const i=n.msbHost.isMsbInternalTenant()?n.stringifyError(t):undefined;_w.bfbWsbTel&&bfbWsbTel.logError("Wsb Dsb Cache Ensure Version Error","",{additionalMessage:i})}finally{this.pendingEnsureVersionPromise=undefined}n.config.msbDsbCleanCache&&await this.internalClearAsync()})}async setDataAsync(t,i){try{if(this.pendingEnsureVersionPromise&&await this.pendingEnsureVersionPromise,n.config.msbEnableAccountManager){const{accountId:r}=n.msbHost.accountManager.ensureCurrentAccount("MsbDsb/CacheManager::setDataAsync");await n.msbHost.accountCache.setAccountKvItemAsync(r,this.makeKey(t),i)}else n.LightweightStorage.setItem(this.makeKey(t),JSON.stringify(i))}catch(r){this.logCacheOperationError("set",r)}}async getDataAsync(t){try{if(this.pendingEnsureVersionPromise&&await this.pendingEnsureVersionPromise,n.config.msbEnableAccountManager){const{accountId:i}=n.msbHost.accountManager.ensureCurrentAccount("MsbDsb/CacheManager::getDataAsync");return await n.msbHost.accountCache.getAccountKvItemAsync(i,this.makeKey(t))}else{const i=n.LightweightStorage.getItem(this.makeKey(t));if(!i)return undefined;try{return JSON.parse(i)}catch(r){}return undefined}}catch(i){return this.logCacheOperationError("get",i),undefined}}async deleteDataAsync(t){try{if(this.pendingEnsureVersionPromise&&await this.pendingEnsureVersionPromise,n.config.msbEnableAccountManager){const{accountId:i}=n.msbHost.accountManager.ensureCurrentAccount("MsbDsb/CacheManager::deleteDataAsync");await n.msbHost.accountCache.deleteAccountKvItemAsync(i,this.makeKey(t))}else n.LightweightStorage.removeItem(this.makeKey(t))}catch(i){this.logCacheOperationError("delete",i)}}logCacheOperationError(t,i){let r;(i instanceof n.MsbAccountNoCurrentAccountError||i instanceof n.MsbAccountCacheParameterFalsyError)&&(r=i.message);const u=r?`${t}: ${r}`:t,f=n.msbHost.isMsbInternalTenant()?n.stringifyError(i):undefined;_w.bfbWsbTel&&bfbWsbTel.logError("Wsb Dsb Cache Operation Error",u,{additionalMessage:f})}async internalClearAsync(){if(n.config.msbEnableAccountManager){const{accountId:t}=n.msbHost.accountManager.ensureCurrentAccount("MsbDsb/CacheManager::clearAsync");await n.msbHost.accountCache.deleteAccountKvItemsWithPrefixAsync(t,i)}else n.LightweightStorage.removeItemsWithKeyPrefix(i)}calculateSize(){if(n.config.msbEnableAccountManager)throw new Error("Deprecated - CacheManager.calculateSize");let t=0,r=0,u=0,f=0,e=0,o=0;const s=n.LightweightStorage.getLength();for(let h=0;h<s;h++){const s=n.LightweightStorage.key(h),c=s&&n.LightweightStorage.getItem(s),l=(s===null||s===void 0?void 0:s.length)||0,a=(c===null||c===void 0?void 0:c.length)||0;t+=l;r+=a;(s===null||s===void 0?void 0:s.startsWith(i))?(e+=l,o+=a):(s===null||s===void 0?void 0:s.startsWith("Msb"))&&(u+=l,f+=a)}return{totalKeyStringLength:t,totalValueStringLength:r,msbKeyStringLength:u,msbValueStringLength:f,msbDsbKeyStringLength:e,msbDsbValueStringLength:o}}makeKey(n){return i+n}async ensureVersionAsync(){if(n.config.msbEnableAccountManager){const{accountId:i}=n.msbHost.accountManager.ensureCurrentAccount("MsbDsb/CacheManager::ensureVersionAsync"),u=await n.msbHost.accountCache.getAccountKvItemAsync(i,r);(typeof u!="number"||u<t.CacheSchemaVersion)&&(await this.internalClearAsync(),await n.msbHost.accountCache.setAccountKvItemAsync(i,r,t.CacheSchemaVersion))}else{const u=n.LightweightStorage.getItem(r),i=Number(u);(isNaN(i)||i<t.CacheSchemaVersion)&&(await this.internalClearAsync(),n.LightweightStorage.setItem(r,`${t.CacheSchemaVersion}`))}}}t.CacheManager=u})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){t.MiddleTierResponseCacheKey="mtr";t.MiddleTierResponseTimeCacheKey="mtrt";t.FeedDismissalHistoryCacheKey="dhis";t.LastSuccessfulMTRequestKey="last-successful-mt-request";t.LastMTRequestKey="last-mt-request";t.SuggestionsCacheKey="sugg";const r="ImageOfTheDay",f=1e4,u="MainPageFecth";class i{constructor(n){this.message=n}}class e{constructor(n,t,i){this.msbServiceClient=n;this.cacheManager=t;this.commercialDsbServiceClient=i;this.dataChangedHandlers={};this.pendingCalls={}}async refreshAsync(n){this.isBackgroundUpdate=n.isBackgroundUpdate;await this.refreshMainPageAsync(n)}getPendingRequestCount(){return Object.keys(this.pendingCalls).length}canFetchMainPageData(){return!this.hasPendingCall(u)}bindDataChanged(n,t){this.dataChangedHandlers[n]=t}unbindDataChanged(n){delete this.dataChangedHandlers[n]}isDataChangeHandlerBound(n){return!!this.dataChangedHandlers[n]}async fireDataChangedAsync(n,...t){const i=Object.getOwnPropertyNames(this.dataChangedHandlers).map(async i=>{try{await this.dataChangedHandlers[i](n,...t)}catch(r){}});try{await Promise.all(i)}catch(r){}}getMainPageData(){return this.mainPageData}getDismissalHistory(){var n;return(n=this.dismissalHistory)!==null&&n!==void 0?n:{}}getSuggestionsData(){return n.config.msbDsbRecentQueriesEnabled?this.suggestionsData:undefined}updateExistingMainPageProperties(n){for(const t of Object.keys(n))Object.prototype.hasOwnProperty.call(this.mainPageData,t)&&(this.mainPageData[t]=n[t])}isBundleReloadColdStart(){return this.mainPageData==null}log3SRenderEvents(t,i){if(i||n.msbDsbSubstrateLogger.setLogicalIds(this.mainPageData),!t){const t=n.getDateWithTimezone(),r=n.getCurrentTime();i&&n.msbDsbSubstrateLogger.logCachedRenderEvents(this.mainPageData,t);n.msbDsbSubstrateLogger.logResultsRenderEvents(this.mainPageData,i?undefined:r);n.msbDsbSubstrateLogger.logClientLayoutEvents(this.mainPageData,t)}}async constructMainPageDataAsync(i,r,u){const f=t.convertMainPageResponseToViewDataModel(i,r,await this.getLastMtRequestAsync(),u);return n.msbDsbHost.gleamManager.setMainPageGleamData(f),f}async getCachedResponseAsync(){return await this.cacheManager.getDataAsync(t.MiddleTierResponseCacheKey)}async storeMiddleTierResponseAsync(i){await this.cacheManager.setDataAsync(t.MiddleTierResponseCacheKey,i);await this.cacheManager.setDataAsync(t.MiddleTierResponseTimeCacheKey,n.getCurrentTime())}async storeQuerySuggestionsDataAsync(n){await this.cacheManager.setDataAsync(t.SuggestionsCacheKey,n)}async clearMiddleTierResponseAsync(){if(n.config.msbEnableAccountManager)throw new Error("MsbDsb/ExternalDataManager::clearMiddleTierResponseAsync: NotSuported");await this.cacheManager.deleteDataAsync(t.MiddleTierResponseCacheKey);await this.cacheManager.deleteDataAsync(t.MiddleTierResponseTimeCacheKey);await this.cacheManager.deleteDataAsync(t.SuggestionsCacheKey)}async refreshMainPageAsync(r){var h,c,l,a,v,y,p,w,b,k,d;const{shouldFetch:g,shouldRender:nt,isBackgroundUpdate:f}=r;let e;n.msbPerfLogger&&(typeof this.lastMainPagePerfMarkCallId=="undefined"&&(this.lastMainPagePerfMarkCallId=0),e=this.lastMainPagePerfMarkCallId++,n.msbPerfLogger.mark(n.MsbPerfProbe.DsbMainPageRefreshStarted,e));const tt=!g&&nt,o=this.isBundleReloadColdStart();let s=this.suggestionsData;if(o||tt){const i=!(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbNoCache)&&await this.getCachedResponseAsync();if(i?(this.dismissalHistory=await this.cacheManager.getDataAsync(t.FeedDismissalHistoryCacheKey),this.mainPageData=await this.constructMainPageDataAsync(i,this.dismissalHistory,!0),await this.fireDataChangedAsync("MainPageData",e),this.log3SRenderEvents(f,!0)):(this.mainPageData=await this.constructMainPageDataAsync(undefined,undefined,!1),await this.fireDataChangedAsync("MainPageData",e)),n.config.msbDsbRecentQueriesEnabled){const i=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbNoCache)?undefined:await this.cacheManager.getDataAsync(t.SuggestionsCacheKey);s=i}}if(g){n.msbPerfLogger===null||n.msbPerfLogger===void 0?void 0:n.msbPerfLogger.mark(n.MsbPerfProbe.DsbMainPageRequested,e);const tt=await this.getCachedResponseAsync(),it=t.getAnswersInCacheHashes(tt);let d="Succeeded",g="";try{const p=await this.recordRequestAsync(u,()=>this.msbServiceClient.getMainPageAsync(it));let i=p.result;g=(h=p.responseContext.serverTraceId)!==null&&h!==void 0?h:"";n.msbPerfLogger===null||n.msbPerfLogger===void 0?void 0:n.msbPerfLogger.mark(n.MsbPerfProbe.DsbMainPageResponded,e);n.config.msbDsbOrgV2&&t.logOrgChartChanges(i,g);const w=t.getAnswersInCache(tt),b=((a=(l=(c=this.dismissalHistory)===null||c===void 0?void 0:c.dismissedAnswers)===null||l===void 0?void 0:l.length)!==null&&a!==void 0?a:0)>0;if(i=t.replaceFailedAnswersWithCachedAnswers(i,w,b),i=t.rehydrateAnswersFromCache(i,w),await this.cacheManager.deleteDataAsync(t.FeedDismissalHistoryCacheKey),this.dismissalHistory=undefined,this.mainPageData=await this.constructMainPageDataAsync(i,undefined,!1),await this.storeMiddleTierResponseAsync(i),n.config.msbDsbRecentQueriesEnabled&&(s=t.convertMainPageToQuerySuggestionsData(i,await this.getLastMtRequestAsync()),await this.storeQuerySuggestionsDataAsync(s)),n.config.msbDsbBadging){let t=await n.msbDsbHost.getMtHasNewContentAsync();t||(t=!!(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbBadgingMtAlwaysNewContent)||!!(i===null||i===void 0?void 0:i.hasNewContent),await n.msbDsbHost.setMtHasNewContentAsync(t))}await n.msbDsbHost.gleamManager.setGleamContentToDisplayAsync((v=this.mainPageData)===null||v===void 0?void 0:v.gleamDataPair,!0,"MTFetchSucceed",(y=this.mainPageData)===null||y===void 0?void 0:y.scenario,f);const k=`[${(new Date).toLocaleTimeString()}] `;(o||nt||f)&&(await this.fireDataChangedAsync("MainPageData",e),this.log3SRenderEvents(f,!1))}catch(k){let t=!1;if(k instanceof i?(d="IgnoredConcurrent",t=!0):k instanceof n.MsbHttpError?(d="FailedHttpError",g=(p=k.responseContext.serverTraceId)!==null&&p!==void 0?p:""):d=k instanceof n.MsbNoMsbTokenError?"FailedNoToken":"FailedOther",!t){await n.msbDsbHost.gleamManager.setGleamContentToDisplayAsync((w=this.mainPageData)===null||w===void 0?void 0:w.gleamDataPair,!0,"MTFetchFailed",(b=this.mainPageData)===null||b===void 0?void 0:b.scenario,f);const t=k;n.msbDsbLogger.logHttpError("Wsb Dsb Fetch MainPage Feed Failed",k,f);this.onRefreshFinished()}}await this.logAndCacheMTResultAsync(d,g)}else{o&&await n.msbDsbHost.gleamManager.setGleamContentToDisplayAsync((k=this.mainPageData)===null||k===void 0?void 0:k.gleamDataPair,!1,"ColdStart",(d=this.mainPageData)===null||d===void 0?void 0:d.scenario,f);this.onRefreshFinished(!0)}this.suggestionsData=s}async logAndCacheMTResultAsync(i,r){var u,f,e;const s=(f=(u=n.msbDsbHost.gleamManager.getDynamicSearchBoxContent())===null||u===void 0?void 0:u.attributes)===null||f===void 0?void 0:f.contentKey;n.msbDsbLogger.logMTRefresh(i,r,{contentKey:s,scenario:(e=this.mainPageData)===null||e===void 0?void 0:e.scenario,BG:this.isBackgroundUpdate});const h=(new Date).toLocaleString(),o={traceId:r,result:i,readableTime:h,timestamp:n.getCurrentTime()};await this.cacheManager.setDataAsync(t.LastMTRequestKey,o);i==="Succeeded"&&await this.cacheManager.setDataAsync(t.LastSuccessfulMTRequestKey,o)}onRefreshFinished(t){!n.msbDsbHost.isMsbDsbShown(n.Host.getQuery())||t||this.isBackgroundUpdate||n.msbDsbHost.instrumentationManager.safeInstrumentDSB();this.isBackgroundUpdate&&n.msbDsbHost.safeCallAllowSuspension();this.isBackgroundUpdate=undefined}async dismissAnswerAsync(i,r,u){const o=await this.cacheManager.getDataAsync(n.MsbDsb.DataContext.FeedDismissalHistoryCacheKey);if(this.dismissalHistory=n.MsbDsb.DataContext.addDismissedAnswerId(r,o),await this.cacheManager.setDataAsync(n.MsbDsb.DataContext.FeedDismissalHistoryCacheKey,this.dismissalHistory),u){const e=t.convertAnswerTypeToServiceContract(i);try{await this.msbServiceClient.dismissAnswerAsync(e,r)}catch(f){const t=f;n.msbDsbLogger.logHttpError("Wsb Dsb Dismiss Answer Failed",f)}}}async flushSubstrateLoggingEventsAsync(){const i=n.msbDsbSubstrateLogger.getLogs();if(i.length>0)try{await this.msbServiceClient.flushSubstrateLoggingEventsAsync(i);n.msbDsbSubstrateLogger.clearLogs()}catch(t){const i=t;n.msbDsbLogger.logHttpError("Wsb Dsb Flush Substrate Logging Events Failed",t)}}sendTelemetryForUIChange(){n.msbDsbHost.instrumentationManager.safeInstrumentDSB();const t=n.msbDsbHost.instrumentationManager.getShownComponents();n.msbDsbLogger.logMainPageShownEvent(t)}async fetchImageOfTheDayPhotoAsync(){const e=this.getApiCallKey("fetchImageOfTheDay",{ImageOfTheDayCacheKeyName:r}),u=await this.cacheManager.getDataAsync(e),o=this.isNewDay();if(!o&&(u===null||u===void 0?void 0:u.scenarios)){await this.fireDataChangedAsync(r,t.convertImageOfTheDayToViewDataModel(u));return}o&&(this.currentImageOfTheDayCacheTime=n.getCurrentTime());try{const n=await this.recordRequestAsync(e,()=>this.commercialDsbServiceClient.getImageOfTheDayAsync());if(n){await this.cacheManager.setDataAsync(e,n);const i=t.convertImageOfTheDayToViewDataModel(n);await this.fireDataChangedAsync(r,i)}}catch(f){if(f instanceof i)return;const t=f;n.msbDsbLogger.logHttpError("Wsb Dsb Fetch Image Of The Day Failed",f)}}async fetchPersonPhotoAsync(t){const u=this.getApiCallKey("fetchPersonPhotoAsync",{photoKey:t});try{const i=await this.recordRequestAsync(u,()=>n.msbHost.photoManager.getPhotoAsync(t,"PersonPhoto","Dsb",{isBackgroundUpdate:this.isBackgroundUpdate,page:"DSB",serverRefreshGuid:n.msbDsbLogger.getServerRefreshGuid()}));i&&await this.fireDataChangedAsync("PersonPhoto",t,Object.assign({},i))}catch(r){if(r instanceof i)return;n.msbDsbLogger.logError("Wsb Dsb Fetch Person Photo Unexpected Error")}}async fetchGroupPhotoAsync(r){const e=this.getApiCallKey("fetchGroupPhotoAsync",{photoKey:r}),u=await this.cacheManager.getDataAsync(e);if((u===null||u===void 0?void 0:u.imageInBase64)||(u===null||u===void 0?void 0:u.noImage)){await this.fireDataChangedAsync("GroupPhoto",r,u);return}try{const i=await this.recordRequestAsync(e,()=>this.msbServiceClient.getGroupPhotoAsync(r)),n=t.convertPhotoToViewDataModel(i);await this.fireDataChangedAsync("GroupPhoto",r,n);await this.cacheManager.setDataAsync(e,n)}catch(f){if(f instanceof i)return;const r=JSON.stringify(f,Object.getOwnPropertyNames(f)),t=f;n.msbDsbLogger.logHttpError("Wsb Dsb Fetch Group Photo Failed",f)}}async fetchFeedItemPreviewAsync(r,u="Medium"){const{preview:e,itemId:o,category:s}=r||{};if(e){const{previewUrl:h,previewProxyUrl:c}=e;if(!n.msbHost.isEduTenant()){const l=this.getApiCallKey("fetchFeedItemPreviewAsync",{previewType:s,itemId:o});try{const n=await this.recordRequestAsync(l,()=>this.msbServiceClient.getFeedItemPreviewAsync(s,h,c,u)),i=t.convertFeedItemPreviewToViewDataModel(n);await this.fireDataChangedAsync("FeedItemPreview",o,i)}catch(f){if(f instanceof i)return;if(f instanceof n.MsbHttpError){const{responseContext:{statusCode:n}}=f;if(n==204||n==304)return}const t=f;n.msbDsbLogger.logHttpError("Wsb Dsb Fetch FeedItem Preview Failed",f)}}}}async fetchFileIconAsync(t){if(t.toLowerCase()==="pdf"){const i={type:0,content:n.getImageUrl("ODSWG.c661ecaf-8056-4219-9c6d-e7dc16b7fadc")};await this.fireDataChangedAsync("FileIcon",t,i);return}const u=this.getApiCallKey("fetchFileIconAsync",{extension:t});try{const n=await this.recordRequestAsync(u,()=>this.msbServiceClient.getFileIconAsync(t)),i=n;await this.fireDataChangedAsync("FileIcon",t,i)}catch(r){if(r instanceof i)return;const t=r;n.msbDsbLogger.logHttpError("Wsb Dsb Fetch File Icon Failed",t)}}async fetchFluentIconSvgHtmlAsync(t){var u;try{const r=(u=n.msbHost.iconUtils.getFluentIcon(t))===null||u===void 0?void 0:u.content;if(!r){n.msbDsbLogger.logError("Wsb Dsb Fetch Fluent Icon Svg Url Invalid");return}const f={method:"GET",url:r,noCredentials:!0,ignoreDefaultHeaders:!0,skipToken:!0,skipParseResultJson:!0},{result:i}=await n.msbHost.httpWrapper.sendHttpAsync(f);if(!this.isSvgFormat(i)){n.msbDsbLogger.logError("Wsb Dsb Fetch Fluent Icon Svg Format Invalid");return}await this.fireDataChangedAsync("FluentIconSvgHtml",t,i)}catch(r){if(r instanceof i)return;const u=JSON.stringify(r,Object.getOwnPropertyNames(r)),t=r;n.msbDsbLogger.logHttpError("Wsb Dsb Fetch Fluent Icon Svg Failed",r)}}async recordRequestAsync(n,t){if(this.checkAndSetPendingCall(n))throw new i(`Concurrent call with key: ${n}.`);try{return await t()}finally{this.clearPendingCall(n)}}checkAndSetPendingCall(t,i){return this.hasPendingCall(t)?!0:(this.pendingCalls[t]=n.getCurrentTime()+(i?i:f),!1)}hasPendingCall(t){return this.pendingCalls[t]&&this.pendingCalls[t]>n.getCurrentTime()}clearPendingCall(n){delete this.pendingCalls[n]}getApiCallKey(n,t){return`${n}-${JSON.stringify(t)}`}isDifferentDay(n,t){return n.getDate()!=t.getDate()||n.getMonth()!=t.getMonth()||n.getFullYear()!=t.getFullYear()}isNewDay(){return this.currentImageOfTheDayCacheTime==null?!0:this.isDifferentDay(new Date(this.currentImageOfTheDayCacheTime),n.getCurrentDate())}async getLastMtRequestAsync(){return await this.cacheManager.getDataAsync(t.LastMTRequestKey)}isSvgFormat(n){return n.startsWith("<svg")}}t.ExternalDataManager=e})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function u(t,i){switch(i.type){case"SET_CHAT_UPSELL_CURRENT_IDX":return Object.assign({},t,{currSuggestionIdx:t.currSuggestionIdx+n.NUM_UPSELL_SUGGESTIONS});default:return t}}function f(i,r){switch(r.type){case"SET_MY_ORG_CHART_EXPANSION":{const{isExpanded:u}=r;return n.config.msbDsbPersistOrgChartExpansion==="storage"&&n.LightweightStorage.setItem(t.MYORGCHART_EXPANSION_STORAGE_KEY,u?"1":"0"),Object.assign({},i,{isMyOrgChartExpanded:u})}case"SET_MAIN_PAGE_DATA":{const r=n.getCurrentTime();let t;return t=n.config.msbDsbPersistOrgChartExpansion==="alwaysOn"?!0:n.config.msbDsbPersistOrgChartExpansion==="alwaysOff"?!1:i.isMyOrgChartExpanded,Object.assign({},i,{errorBoundaryResetKey:r,isMyOrgChartExpanded:t})}case"SET_EDU_CLASSES_EXPANSION":{const{isExpanded:u}=r;return n.LightweightStorage.setItem(t.EDUCLASSES_EXPANSION_STORAGE_KEY,u?"1":"0"),Object.assign({},i,{isEduClassesExpanded:u})}case"SET_EDU_ASSIGNMENTS_EXPANSION":{const{isExpanded:u}=r;return n.LightweightStorage.setItem(t.EDUASSIGNMENTS_EXPANSION_STORAGE_KEY,u?"1":"0"),Object.assign({},i,{isEduAssignmentsExpanded:u})}case"SET_LAST_SELECTED_SCOPE":{const{lastSelectedScope:t}=r;return n.msbDsbHost.setLastSelectedScope(t),i}default:return i}}function e(t,i,u,f){switch(i.type){case"SET_MAIN_PAGE_DATA":{const{mainPageData:n}=i,t=f?f.createMainPageLayout(n):[];return{mainPageData:n,mainPageLayout:t}}case"DISMISS_ANSWER":{const{answerType:e,answerId:o,dismissAction:s}=i,{mainPageData:h}=t;return(n.msbDsbHost.dismissAnswerAsync(o,e,s.dismissViaRequest),!s.dismissOnView)?t:r(h,u,o,e,f)}case"HIDE_ANSWER":{const{mainPageData:n}=t,{answerType:e,answerId:o}=i;return r(n,u,o,e,f)}case"SET_PEOPLE_SHUFFLE":{const{shuffledPeople:n}=i,r=Object.assign({},t.mainPageData,{recommendedPeopleAnswer:n});return Object.assign({},t,{mainPageData:r})}default:return t}}function o(n,t,i){switch(t.type){case"SET_RECOMMENDED_PEOPLE_PAGINATION_SETTING":{const{paginationSetting:i}=t;return Object.assign({},n,{recommendedPeoplePaginationSetting:i})}case"NAVIGATE_PAGE":{const{paginationId:u,targetPageIndex:r}=t;switch(u){case"RecommendedPeople":{if(!n.recommendedPeoplePaginationSetting)return n;const t=Object.assign({},n.recommendedPeoplePaginationSetting,{currentPageIndex:r}),u=Object.assign({},n,{recommendedPeoplePaginationSetting:t});return i.updateRecommendedPeoplePageIndexAsync(r),u}default:return n}}default:return n}}function s(n,t,i){switch(t.type){case"FETCH_IMAGE_OF_THE_DAY":return(sb_st(()=>{i.fetchImageOfTheDayPhotoAsync()},1),n.imageOfTheDay===undefined)?Object.assign({},n,{imageOfTheDay:null}):n;case"SET_IMAGE_OF_THE_DAY":{const{imageOfTheDay:i}=t;return Object.assign({},n,{imageOfTheDay:i})}default:return n}}function h(t,i,r){switch(i.type){case"SET_MAIN_PAGE_DATA":return n.config.msbStorePersonPhotosInMemQueue?t:{};case"FETCH_PERSON_PHOTO":{const{photoKey:n}=i;return(sb_st(()=>{r.fetchPersonPhotoAsync(n)},1),t[n]===undefined)?Object.assign({},t,{[n]:null}):t}case"SET_PERSON_PHOTO":{const{photoKey:u,photo:f}=i,r=Object.assign({},t,{[u]:f});if(n.config.msbStorePersonPhotosInMemQueue){const n=Object.keys(r);if(n.length>100){const t=n[0];delete r[t]}}return r}default:return t}}function c(n,t,i){switch(t.type){case"SET_MAIN_PAGE_DATA":return{};case"FETCH_GROUP_PHOTO":{const{photoKey:r}=t;return(sb_st(()=>{i.fetchGroupPhotoAsync(r)},1),n[r]===undefined)?Object.assign({},n,{[r]:null}):n}case"SET_GROUP_PHOTO":{const{photoKey:i,photo:r}=t;return Object.assign({},n,{[i]:r})}default:return n}}function l(n,t,i){switch(t.type){case"SET_MAIN_PAGE_DATA":return{};case"FETCH_FEED_ITEM_PREVIEW":{const{feedItem:r,size:f}=t,{itemId:u}=r;return(sb_st(()=>{i.fetchFeedItemPreviewAsync(r,f)},1),n[u]===undefined)?Object.assign({},n,{[u]:null}):n}case"SET_FEED_ITEM_PREVIEW":{const{feedItemId:i,itemPreview:r}=t;return Object.assign({},n,{[i]:r})}default:return n}}function a(n,t,i){switch(t.type){case"SET_MAIN_PAGE_DATA":return{};case"FETCH_FILE_ICON":{const{extension:r}=t;return(sb_st(()=>{i.fetchFileIconAsync(r)},1),n[r]===undefined)?Object.assign({},n,{[r]:null}):n}case"SET_FILE_ICON":{const{extension:i,fileIcon:r}=t;return Object.assign({},n,{[i]:r})}default:return n}}function v(n,t,i){switch(t.type){case"FETCH_FLUENT_ICON_SVG_HTML":{const{icon:r}=t;return(sb_st(()=>{i.fetchFluentIconSvgHtmlAsync(r)},1),n[r]===undefined)?Object.assign({},n,{[r]:null}):n}case"SET_FLUENT_ICON_SVG_HTML":{const{icon:i,svgHtml:r}=t;return Object.assign({},n,{[i]:r})}default:return n}}function y(t){var i;switch(t.type){case"SET_WSB_REQUERY":{const{query:i,scope:r}=t;n.msbDsbHost.setWsbQuery(i,r);return}case"LAUNCH_URI":{const{uri:i}=t;n.Host.launchUrlWithEdgeProtocolAsync(i,{medium:"MSBLink"});return}case"LAUNCH_PROACTIVE_WORK_SEARCH":{const{args:r}=t;(i=n.msbHost.proactiveSearchManager)===null||i===void 0?void 0:i.launchProactiveWorkSearchAsync(r);return}case"FORCE_DSB_REFRESH_ACTION":n.msbDsbHost.refresh(3,3);return}}function p(n,t){switch(n.type){case"SET_MY_ORG_CHART_EXPANSION":sb_st(()=>{t.sendTelemetryForUIChange()},1);break;case"DISMISS_ANSWER":{const{dismissAction:i}=n;i.dismissViaRequest&&sb_st(()=>{t.sendTelemetryForUIChange()},1);break}}}function w(n,t,i){return(r,w)=>{const{uiOptions:b,mainPageState:k,imageOfTheDay:d,personPhotos:g,feedItemPreviews:nt,fileIcons:tt,paginationSettings:it,groupPhotos:rt,fluentIconSvgHtmls:ut,chatUpsellState:ft}=r;return y(w),p(w,n),{uiOptions:f(b,w),mainPageState:e(k,w,n,i),imageOfTheDay:s(d,w,n),personPhotos:h(g,w,n),groupPhotos:c(rt,w,n),feedItemPreviews:l(nt,w,n),fileIcons:a(tt,w,n),fluentIconSvgHtmls:v(ut,w,n),paginationSettings:o(it,w,t),chatUpsellState:u(ft,w)}}}function r(t,r,u,f,e){if(!t)return{mainPageData:null,mainPageLayout:[]};let o={};if(i.isViewModelAnswerTypeDynamic(f)){const{gleamDataPair:r}=t,i=Object.assign({},r,{scenarioGleamData:null}),u=n.MsbDsb.DataContext.getDynamicAnswerState();o={dynamicAnswer:undefined,gleamDataPair:i,dynamicAnswerState:u,scenario:"Baseline"};n.msbDsbHost.gleamManager.setGleamContentToDisplayAsync(i,!1,"dismissDynamicAnswer","Baseline",!1)}else if(f==="Feed"&&u){const{feedAnswers:n}=t,i=n.filter(n=>n.answerId!==u);o={feedAnswers:i}}else switch(f){case"RecommendedPeople":o={recommendedPeopleAnswer:undefined};break;case"OrgChart":o={myOrgChart:undefined};break;case"PopularSearch":o={popularSearchesAnswer:undefined};break;case"Acronyms":o={acronymsAnswer:undefined};break;case"EduCard":o={eduCardAnswer:undefined};break;case"EduAssignments":o={eduAssignmentAnswer:undefined};break;case"EduClasses":o={eduClassAnswer:undefined}}const s=Object.assign({},t,o);r.updateExistingMainPageProperties(o);const h=e?e.createMainPageLayout(s):[];return{mainPageData:s,mainPageLayout:h}}i.createRootReducer=w})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){const i=20;class r{constructor(n){this.externalDataManager=n;this.resetRenderingFlags()}setMainPageDataRefreshed(){this.resetRenderingFlags();this.isMainPageRefreshed=!0}startPollingMainPageLoaded(){(this.setLastUpdateTime(),this.shouldStartPolling())&&(this.pollingPageLoadTimerStarted=!0,this.pollingPageLoaded(i,this.lastUpdateTime))}setLastUpdateTime(){this.lastUpdateTime=n.getCurrentTime()}shouldStartPolling(){return this.isMainPageRefreshed&&!this.pollingPageLoadTimerStarted}pollingPageLoaded(t,i){if(this.clearPageLoadTimer(),t===0){this.resetRenderingFlags();this.externalDataManager.onRefreshFinished();return}this.pageLoadTimer=n.safeSetTimeout(()=>{this.clearPageLoadTimer(),i==this.lastUpdateTime&&this.externalDataManager.getPendingRequestCount()===0?(this.resetRenderingFlags(),this.externalDataManager.onRefreshFinished()):this.pollingPageLoaded(t-1,this.lastUpdateTime)},100,"MsbDsbRenderingManager")}clearPageLoadTimer(){this.pageLoadTimer&&(sb_ct(this.pageLoadTimer),this.pageLoadTimer=null)}resetRenderingFlags(){this.isMainPageRefreshed=!1;this.pollingPageLoadTimerStarted=!1}}t.RenderingMonitor=r})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){function i(i,r,u,f){n.msbDsbHost.instrumentationManager.resetInstrumentProps();const h=n.msbDsbHost.instrumentationManager.createInstrumentedItem("PeopleSearchBox");if(!(i===null||i===void 0?void 0:i.scenario))return s(h,f);const{scenario:{scenarioType:g,answers:c}}=i;let l=t.convertScenarioToViewDataModel(g),a,v,o=[],e,y,p,w,b,k,d;if(c)for(const n of c){if(!(n===null||n===void 0?void 0:n.answerType)){t.logAnswerConversionError(new Error("Missing answer type"),undefined,u,n===null||n===void 0?void 0:n.traceId,!!f);continue}const{answerType:i,answerId:s}=n;if(!s||!t.isAnswerDismissed(s,r))try{switch(i){case"RecommendedPeople":a=t.convertRecommendedPeopleAnswerToViewDataModel(n);break;case"OrgChart":v=t.convertOrgChartAnswerToViewDataModel(n);break;case"Feed":o=t.convertFeedAnswersToViewDataModel(n,r,u,f);o=t.resetAnswersPlacement(o);break;case"MeetingPrep":e=t.convertMeetingPrepAnswerToViewDataModel(n);break;case"FileRequest":e=t.convertFileRequestAnswerToViewDataModel(n,f);break;case"IndustryNews":e=t.convertIndustryNewsAnswerToViewDataModel(n);break;case"PopularSearch":y=t.convertPopularSearchesAnswerToViewModel(n);break;case"SearchBoxGleam":p=n;break;case"EduAssignments":w=t.convertEduAssignmentAnswerToViewDataModel(n);break;case"EduClasses":b=t.convertEduClassAnswerToViewDataModel(n);break;case"FileSearchSuggestions":k=t.convertFileSearchSuggestionsToViewDataModel(n);break;case"Acronyms":d=t.convertAcronymsAnswerToViewDataModel(n)}}catch(h){t.logAnswerConversionError(h,i,u,n.traceId,!!f)}}const nt=t.createLearningCardViewDataModel(),tt=t.createEduCardViewDataModel(!!n.msbHost.isEduTenant());e||(l="Baseline");const it=t.convertSearchBoxGleamAnswer(p,f),rt=t.getDynamicAnswerStateInConversion(e);return{scenario:l,recommendedPeopleAnswer:a,myOrgChart:v,feedAnswers:o,learningAnswer:nt,popularSearchesAnswer:y,dynamicAnswer:e,dynamicAnswerState:rt,gleamDataPair:it,searchBoxInstrumentedItem:h,eduAssignmentAnswer:w,eduClassAnswer:b,eduCardAnswer:tt,fileSearchSuggestionsAnswer:k,acronymsAnswer:d}}function r(n,i){var r;if(!((r=n===null||n===void 0?void 0:n.scenario)===null||r===void 0?void 0:r.answers))return{};const f=n.scenario.answers;let u=[];for(const n of f){const r=n===null||n===void 0?void 0:n.answerType;if(!r){t.logAnswerConversionError(new Error("Missing answer type"),undefined,i,n===null||n===void 0?void 0:n.traceId);continue}try{switch(r){case"RecentQueries":u=t.convertRecentQueriesAnswerToViewModel(n)}}catch(f){t.logAnswerConversionError(f,r,i,n.traceId,!1)}}return{recentQueries:u}}function u(t){if(!t)return"";const u=t.split("&");let i="";for(const n of u){const[t,r]=n.split("=");if(t==="form"){i=r;break}}const r=n.mapOSFormCode("DSBI10");return i===""?t+`&form=${r}`:t.replace(`form=${i}`,`form=${r}`)}function f(t){var i;if(!((i=t===null||t===void 0?void 0:t.scenarios)===null||i===void 0?void 0:i.length))return null;const r=n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.instrumentationManager.createInstrumentedItem("ImageOfTheDayCard"),f=t.scenarios.map(n=>{const t={};return t.clickThroughUrl=u(n.ClickThroughUrl),t.title=n.Title,t.caption=n.Caption,t.thumbnail=n.Thumbnail,t.copyright=n.Copyright,t}),e=t.imageHostName;return{imageOfTheDayScenarios:f,imageHostName:e,instrumentedItem:r}}function e(n){var t;if(!n)return null;const i=(t=n.imageInBase64)!==null&&t!==void 0?t:n.ImageInBase64;return i?{imageInBase64:i,noImage:!1}:{noImage:!0}}function o(n){if(!n)return null;const{base64EncodedImage:t}=n;return t?{imageInBase64:`data:image/png;base64,${t}`,noImage:!1}:{noImage:!0}}function s(i,r=false){const u=t.createLearningCardViewDataModel(),f=t.convertSearchBoxGleamAnswer(undefined,r),e=t.createEduCardViewDataModel(!!n.msbHost.isEduTenant());return{scenario:"Baseline",learningAnswer:u,eduCardAnswer:e,gleamDataPair:f,searchBoxInstrumentedItem:i,feedAnswers:[]}}t.convertMainPageResponseToViewDataModel=i;t.convertMainPageToQuerySuggestionsData=r;t.convertImageOfTheDayToViewDataModel=f;t.convertPhotoToViewDataModel=e;t.convertFeedItemPreviewToViewDataModel=o})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){function a(t,i,r=false){if(!t||i||t.startsWith("https://")||t.startsWith("<svg"))return t;try{return atob(t)}catch(u){n.msbDsbLogger.logError(r?"Wsb Dsb Gleam Icon From Cache Not Supported":"Wsb Dsb Gleam Icon Not Supported")}return undefined}function ci(n){return n}function li(t){var i,r;if(t.status!=="Succeeded"||n.msbHost.isEduTenant())return undefined;const{traceId:s,logicalId:h,status:c,answerType:l,hash:a}=t,v=e(l),u=(r=(i=t===null||t===void 0?void 0:t.groups)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.suggestions;f(u,"recommendedPeopleSuggestions");const o=vt(u);f(o,"converted recommendedPeople");const y=n.msbDsbHost.instrumentationManager.createInstrumentedItem("RecommendedPeople");return{traceId:s,logicalId:h,status:c,answerType:v,recommendedPeople:o,instrumentedItem:y,hash:a}}function ai(t){if(!n.config.msbDsbIndustryNews||t.status!=="Succeeded")return undefined;const{answerId:r,status:u,answerType:o,newsArticles:i}=t;f(i,"newsArticles");const s=e(o),h=b(i),c=n.msbDsbHost.instrumentationManager.createInstrumentedItem("IndustryNews");return{answerId:r,status:u,answerType:s,newsItems:h,instrumentedItem:c}}function b(t){const i=`w=64&h=64&m=6`;return t.slice(0,3).map(t=>{var r;const u=((r=t.imageInfo)===null||r===void 0?void 0:r.msnImageUrl)?n.msbHost.urlUtils.insertParameter(t.imageInfo.msnImageUrl,i):undefined;return Object.assign({},t,{imageInfo:{msnImageUrl:u}})})}function vi(t){if((t===null||t===void 0?void 0:t.status)!=="Succeeded")return undefined;const o=e(t.answerType),f=t.acronymSuggestions,i=t.acronymFeaturedSuggestion;r(i,"acronymFeaturedSuggestion");r(f,"acronymSuggestions");const s=f.filter(n=>u(n.abbreviatedName)).map(n=>({abbreviatedName:n.abbreviatedName}));r(i.abbreviatedName,"acronymFeaturedSuggestion.abbreviatedName");r(i.displayName,"acronymFeaturedSuggestion.displayName");r(i.numberOfResults,"acronymFeaturedSuggestion.numberOfResults");const h={abbreviatedName:i.abbreviatedName,displayName:i.displayName,numberOfResults:i.numberOfResults},c=n.msbDsbHost.instrumentationManager.createInstrumentedItem("Acronyms"),l=n.msbDsbHost.instrumentationManager.createInstrumentedItem("AcronymSuggestions");return{answerType:o,acronyms:s,acronymFeaturedSuggestion:h,instrumentedItem:c,subItemInstrumentedItem:l}}function yi(t){if((t===null||t===void 0?void 0:t.status)!=="Succeeded")return undefined;const s=e(t.answerType),i=t.fileSearchSuggestions;r(i,"FileSearchSuggestions");const o=i.filter(n=>u(n.fileName)&&u(n.fileExtension)).map(n=>({fileName:n.fileName,fileExtension:n.fileExtension}));f(o,"FileSearchSuggestions");const h=n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.instrumentationManager.createInstrumentedItem("FileSuggestions");return{answerType:s,fileSearchSuggestions:o,instrumentedItem:h}}function pi(t){var s,h,c;if(t.status!=="Succeeded"||n.msbHost.isEduTenant())return undefined;const{answerType:y,reportingChain:a,directReports:w,peers:b}=t,k=e(y);f(a,"reportingChain");const v=p(a[0]);r(v,"hero");const i=(s=l(a.slice(1)))!==null&&s!==void 0?s:[],u=(h=l(w))!==null&&h!==void 0?h:[],o=(c=l(b))!==null&&c!==void 0?c:[];if((i===null||i===void 0?void 0:i.length)===0&&(u===null||u===void 0?void 0:u.length)===0)if((o===null||o===void 0?void 0:o.length)==0)throw new Error("No org chart available");else throw new Error("Org Chart hidden as no managers or direct reports");const d=n.msbDsbHost.instrumentationManager.createInstrumentedItem("ExpandedOrgChart");return{answerType:k,hero:v,managers:i,directReports:u,peers:o,instrumentedItem:d}}function wi(n){switch(n){case"Hero":return"Hero";default:return"Default"}}function bi(t){let i;switch(t){case"pptx":case"ppt":i="PptHeroCard";break;case"docx":case"doc":i="DocHeroCard";break;case"xlsx":case"xls":i="ExcelHeroCard";break;default:i="OtherHeroCard"}return n.msbDsbHost.instrumentationManager.createInstrumentedItem(i)}function ki(t,r,o,s=false){if(t.status!=="Succeeded"||(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbNoFeed))return[];const{answerType:c,items:h,status:l}=t,a=e(c);f(h,"sFeedItems");return h.map(u=>{const f=st(u,o,t.traceId,s);if(!f)return null;const e=f.itemId+"#"+f.feedbackId;if(i.isAnswerDismissed(e,r))return null;const h=n.config.msbDsbFileHero?wi(u.itemPlacement):"Default";return{answerId:e,status:l,answerType:a,item:f,answerPlacement:h}}).filter(u)}function di(i){const r=i.filter(n=>n.answerPlacement==="Hero").length;return r>0&&r<t.MIN_NUMBER_OF_HERO_ITEMS?(n.msbDsbLogger.logError("Wsb Dsb not enough hero items"),i.forEach(t=>{t.answerPlacement="Default",t.instrumentedItem=n.msbDsbHost.instrumentationManager.createInstrumentedItem(t.item.category)})):i.forEach(t=>{if(t.answerPlacement=="Default")t.instrumentedItem=n.msbDsbHost.instrumentationManager.createInstrumentedItem(t.item.category);else{const n=t.item;t.instrumentedItem=bi(n.extension)}}),i}function gi(t){if(t.status!=="Succeeded"||n.msbHost.isEduTenant())return undefined;const{answerId:i,logicalId:u,status:f,answerType:o,entitySets:s,traceId:h}=t;r(i,"answerId");const c=e(o);return k(i,c,f,h,u,s)}function k(t,i,u,e,o,s){var h,c,l;const w=(c=(h=s===null||s===void 0?void 0:s[0])===null||h===void 0?void 0:h.resultSets)===null||c===void 0?void 0:c[0];r(w,"entityResults");const{recommendationsContext:a,results:y,totalNumberOfResults:ot}=w,b=(l=a===null||a===void 0?void 0:a.meetingContext)===null||l===void 0?void 0:l.source;r(b,"entityResults");f(y,"entityResults.results");const{id:k,subject:p,start:g,organizer:st,attendees:nt,totalNumberOfAttendees:ht,webLink:rt}=b;f(nt,"sAttendees");r(g,"sStart");r(rt,"webLink");const ct=p!==null&&p!==void 0?p:n.msbDsbHost.getLocString("NoSubjectEmailTitle"),ut=new Date(g),ft=v(st);r(ft,"organizer");const et=d(nt,ft);f(et,"attendees");const lt=tt(y.filter(n=>n.type=="Document")),at=it(y.filter(n=>n.type=="Message")),vt=n.msbDsbHost.instrumentationManager.createInstrumentedItem("MeetingPrep"),yt=n.msbDsbHost.instrumentationManager.createInstrumentedItem("DismissMeetingPrep"),pt=n.msbDsbHost.instrumentationManager.createInstrumentedItem("PositiveMeetingPrep"),wt=n.msbDsbHost.instrumentationManager.createInstrumentedItem("NegativeMeetingPrep");return k||n.msbDsbLogger.logError("Wsb Dsb Missing telemetry field",`Missing meetingId for Meeting Prep`),{answerId:t,traceId:e,logicalId:o,answerType:i,status:u,expiryTime:ut,meetingId:k,subject:ct,start:ut,topAttendees:et,totalNumberOfAttendees:ht,totalNumberOfResults:ot,webLink:rt,fileResults:lt,conversationResults:at,instrumentedItem:vt,subItemInstrumentedItem:yt,positiveFeedbackInstrumentedItem:pt,negativeFeedbackInstrumentedItem:wt}}function d(n,t){return n.map(n=>g(n,t)).filter(u)}function g(n,t){if(!n.emailAddress)return undefined;const{name:i,address:r}=n.emailAddress;if(!i||!r)return undefined;const u=o(i),f=t.email==r?"Organizer":nt(n.status);return{fullName:i,initials:u,email:r,status:f}}function nt(n){switch(n===null||n===void 0?void 0:n.response){case"Organizer":case"None":case"Accepted":case"Declined":return n.response;case"TentativelyAccepted":return"Tentative";case"NotResponded":return"None";default:return"None"}}function tt(n){return n.map(n=>rt(n)).filter(u)}function it(n){return n.map(n=>ut(n)).filter(u)}function rt(t){var r,u,f;if(!(t===null||t===void 0?void 0:t.source))return undefined;const{source:i,referenceId:e}=t,o=(r=i.lastModifiedBy)===null||r===void 0?void 0:r.displayName,s=(f=(u=i.lastShared)===null||u===void 0?void 0:u.sharedby)===null||f===void 0?void 0:f.displayName,l=o?n.msbDsbHost.getLocString("LastModifiedByText",o):s?n.msbDsbHost.getLocString("LastSharedByText",s):n.msbDsbHost.getLocString("FileSubtitleDefault"),h=i.webUrl?i.webUrl:i.url,c=i.title;return!c||!h?undefined:(e||n.msbDsbLogger.logError("Wsb Dsb Missing telemetry field",`Missing referenceId for Meeting Prep Document`),{referenceId:e,title:c,subtitle:l,fileExtension:i.fileExtension,url:h})}function ut(t){var i;if(!(t===null||t===void 0?void 0:t.source))return undefined;const{source:r,referenceId:u}=t,f=r.subject,e=v(r.from),o=(i=r.itemId)===null||i===void 0?void 0:i.id;if(!f||!e||!o)return undefined;const s=w(o);return u||n.msbDsbLogger.logError("Wsb Dsb Missing telemetry field",`Missing referenceId for Meeting Prep Message`),{subject:f,from:e,conversationUri:s,referenceId:u}}function v(n){var t;if(!((t=n===null||n===void 0?void 0:n.emailAddress)===null||t===void 0?void 0:t.name))return undefined;const i=n.emailAddress.name;return{fullName:i,initials:o(i),email:n.emailAddress.address}}function ft(t,f,e=false){const o=t.modality;r(t.textSnippet,"inferenceSource.textSnippet");r(t.refId,"inferenceSource.refId");switch(o){case"Email":{const r=w(t.refId),f=u(t.title)?t.title:n.msbDsbHost.getLocString("NoSubjectEmailTitle"),o=i.parseEmailMessage(t.textSnippet,e);return{link:r,title:f,preview:o}}case"Chat":{r(t.conversationId,"inferenceSource.conversationId");const u=f.fullName.split(" ")[0],o=wt(t.conversationId,t.refId),s=t.title?t.title:n.msbDsbHost.getLocString("TeamsTitle",u),h=i.parseChatMessage({type:"FileRequest",chatText:t.textSnippet,isCached:e});return{link:o,title:s,preview:h}}default:return undefined}}function nr(n){switch(n){case"Email":return"Email";case"Chat":return"Chat";default:return"unknown"}}function tr(t,i=false){var o,s,h,c,l;const d=n.config.msbDsbFileReq;if(!d||t.status!=="Succeeded")return undefined;const{answerId:a,status:g,answerType:nt}=t;r(a,"answerId");const tt=e(nt),u=(o=t.value)===null||o===void 0?void 0:o[0],v=(h=(s=u===null||u===void 0?void 0:u.action)===null||s===void 0?void 0:s.entities)===null||h===void 0?void 0:h[0],f=(l=(c=u===null||u===void 0?void 0:u.inferenceSource)===null||c===void 0?void 0:c.entities)===null||l===void 0?void 0:l[0];r(v,"fileRequestAnswerVal.entities");r(f,"fileRequestAnswerVal.inferenceSource");const y=f.initiator;r(y,"fileRequestor");const p=ot(v);r(p,"requestedFile");const w=et(y),it=nr(f.modality),b=ft(f,w,i);r(b,"fileRequestEntity");const{link:rt,title:ut,preview:st}=b;let k;if(f.dateTime){const i=new Date(f.dateTime),t=Math.round(Math.abs(Date.now()-i.getTime())/6e4),r=Math.round(t/60);k=t<2?n.msbDsbHost.getLocString("JustNow"):t<60?n.msbDsbHost.getLocString("MinutesAgo",t.toString()):n.msbDsbHost.getLocString("HoursAgo",r.toString())}const ht=n.msbDsbHost.instrumentationManager.createInstrumentedItem("FileRequest"),ct=n.msbDsbHost.instrumentationManager.createInstrumentedItem("DismissFileRequest"),lt=n.msbDsbHost.instrumentationManager.createInstrumentedItem("PositiveFileRequest"),at=n.msbDsbHost.instrumentationManager.createInstrumentedItem("NegativeFileRequest");return{answerId:a,answerType:tt,status:g,requestedFile:p,requestor:w,preview:st,link:rt,timeText:k,title:ut,modality:it,instrumentedItem:ht,subItemInstrumentedItem:ct,positiveFeedbackInstrumentedItem:lt,negativeFeedbackInstrumentedItem:at}}function et(n){return r(n.name,"fileRequestor.name"),{fullName:n.name,initials:o(n.name),email:n.email}}function ot(n){var i,r;const t=(i=n.name)===null||i===void 0?void 0:i.split("."),o=(r=t===null||t===void 0?void 0:t[t.length-1])!==null&&r!==void 0?r:"",{title:u,url:f}=n,e=u!==null&&u!==void 0?u:t===null||t===void 0?void 0:t[0];return!e||!f?undefined:{title:e,fileExtension:o,url:f}}function st(n,t,i,r=false){try{switch(n.category){case"file":return ht(n);case"video":return ct(n);case"emailMessage":return y(n,!0,r);case"teamsChatMessage":return y(n,!1,r);default:return s(n)}}catch(u){const f=u instanceof Error?u.message:"Unknown error.";return ri(new Error(`Error converting ${n.category} feed item: ${f}`),"Feed",t,i,!!r),undefined}}function s(n){var t,u;const{webUrl:c,name:f,itemId:l,feedbackId:e,category:o,subCategory:a,uri:v}=n;r(o,"sCategory");r(e,"feedbackId");r(f,"name");const s=o,y=ir((t=n.inclusionReasons)===null||t===void 0?void 0:t[0]),p=i.getTidbitHeaderIcon((u=n.inclusionReasons)===null||u===void 0?void 0:u[0]),h=s==="teamsChatMessage"?v:c;return r(h,"url"),{itemId:l,feedbackId:e,title:f,uri:h,tidbitItem:y,icon:p,category:s,subCategory:a}}function ht(n){var t;const i=lt(n.containerInfo),r=dt(n.previewInfo);return Object.assign({extension:(t=n.file)===null||t===void 0?void 0:t.extension,location:i,preview:r},s(n))}function ct(t){var f,e,o,h,c;const i=(f=t.video)===null||f===void 0?void 0:f.mediaDuration,r=parseInt((o=(e=i===null||i===void 0?void 0:i.match(/\d+(?=H)/))===null||e===void 0?void 0:e[0])!==null&&o!==void 0?o:""),u=r?r>1?`${r}${n.msbDsbHost.getLocString("HoursShortened")}`:`${r}${n.msbDsbHost.getLocString("HourShortened")}`:undefined,a=parseInt((c=(h=i===null||i===void 0?void 0:i.match(/\d+(?=M)/))===null||h===void 0?void 0:h[0])!==null&&c!==void 0?c:""),l=a?`${a}${n.msbDsbHost.getLocString("MinuteShortened")}`:undefined,v=u&&l?`${u} ${l}`:u?u:l,y=n.msbHost.iconUtils.getFluentIcon("previewIcon"),p=dt(t.previewInfo);return Object.assign({previewIcon:y,preview:p,duration:v},s(t))}function y(t,u,f=false){var o,h,c,l,a,v,y,p,w,b,k,d;let e;if(u){const n=(h=(o=t.message)===null||o===void 0?void 0:o.body)===null||h===void 0?void 0:h.content;r(n,"emailBodyContent");e=i.parseEmailMessage(n,f,(l=(c=t.message)===null||c===void 0?void 0:c.body)===null||l===void 0?void 0:l.contentType)}else{const u=(a=t.chatMessageInfo)===null||a===void 0?void 0:a.mentions;r(u,"chatMessageMentions");const o=(y=(v=t.chatMessageInfo)===null||v===void 0?void 0:v.body)===null||y===void 0?void 0:y.content;r(o,"chatMessageContent");const s=!n.msbHost.isEduTenant()&&t.category=="teamsChatMessage";e=i.parseChatMessage({type:"Feed",chatText:o,mentionList:u,isCached:f,contentType:(w=(p=t.chatMessageInfo)===null||p===void 0?void 0:p.body)===null||w===void 0?void 0:w.contentType},s)}r(e,"processedMessageBody");const nt=u?(b=t.message)===null||b===void 0?void 0:b.from:(d=(k=t.chatMessageInfo)===null||k===void 0?void 0:k.from)===null||d===void 0?void 0:d.user,g=ar(nt);r(g,"fromActor");const tt={firstActor:g,tidbit:n.msbDsbHost.getLocString("MentionedYouTidbit"),inclusionType:"Other"};return Object.assign(Object.assign({processedMessageBody:e,isEmailMention:u},s(t)),{tidbitItem:tt,icon:"atIcon"})}function lt(t){if(!t)return undefined;const{kind:r,displayName:i}=t;if(i)switch(r){case"OneDrive":case"OneDriveBusiness":return n.msbDsbHost.getLocString("OneDriveItemSourceWithName",i);case"SharePoint":return n.msbDsbHost.getLocString("SharePointItemSourceWithName",i);case"OneDrive & SharePoint":default:return n.msbDsbHost.getLocString("OneDriveAndSharePointItemSourceWithName",i)}else switch(r){case"OneDrive":case"OneDriveBusiness":return n.msbDsbHost.getLocString("OneDriveItemSource");case"SharePoint":return n.msbDsbHost.getLocString("SharePointItemSource");case"OneDrive & SharePoint":default:return n.msbDsbHost.getLocString("OneDriveAndSharePointItemSource")}}function fr(){if(n.msbHost.isEduTenant())return undefined;const t=["LearningCardDocuments","LearningCardProfile","LearningCardManager"].map(t=>{const i=n.msbDsbHost.getLocString(t),r=h(i);return{title:i,uri:r}}),i=n.msbDsbHost.instrumentationManager.createInstrumentedItem("LearningFeedFallback");return{answerType:"Learning",suggestions:t,instrumentedItem:i}}function er(t){if(!t)return undefined;const f=n.msbHost.hasEduAssignments(),i=n.msbHost.getAadUserInfo(),e=(i===null||i===void 0?void 0:i.userAadId)||"",r=(i===null||i===void 0?void 0:i.email)||"",s=o(r),c={uid:e,email:r,fullName:r,initials:s},u=n.msbHost===null||n.msbHost===void 0?void 0:n.msbHost.features.isEduMessagesCardEnabled(),l=f&&!n.config.msbDsbEnableEduScenario?["EduCardAssignments","EduCardClasses",u?"EduCardMessages":"EduCardCalendar"]:["MyProfileSearchSuggestion","EduCardFiles",u?"EduCardMessages":"EduCardCalendar"],a=l.map(t=>{const r=n.msbDsbHost.getLocString(t),u=t=="EduCardAssignments"||t=="MyProfileSearchSuggestion"?n.msbDsbHost.getLocString(t+"Query"):n.Host.getEnUsLocString(t+"Query");let i=h(u,!0);i=t==="EduCardMessages"?n.msbHost.urlUtils.appendHash(i,"Message-conversations"):i;const f=at(t),e=n.msbDsbHost.instrumentationManager.createInstrumentedItem(n.Host.getEnUsLocString(t));return{title:r,uri:i,key:t,color:f,instrumentedItem:e}}),v=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduCard");return{answerType:"EduCard",suggestions:a,user:c,instrumentedItem:v}}function or(t){if(t.status!=="Succeeded"||n.msbHost.isEduTenant())return undefined;const{status:u,answerType:o,bookmarks:i}=t,s=e(o),r=i===null||i===void 0?void 0:i.map(n=>({title:n}));f(r,"searchQueries");const h=n.msbDsbHost.instrumentationManager.createInstrumentedItem("PopularSearchesFeedFallback");return{answerType:s,status:u,searchQueries:r,instrumentedItem:h}}function h(t,i=false){return`https://www.bing.com/work/search?q=${encodeURIComponent(t)}&form=${n.msbDsbHost.getFormCode(i)}`}function at(n){switch(n){case"MyProfileSearchSuggestion":return"blue";case"EduCardFiles":return"orange";case"EduCardCalendar":return"lightyellow";case"EduCardAssignments":return"purple";case"EduCardClasses":return"green";case"EduCardMessages":return"lightblue";default:return"blue"}}function e(n){return n}function vt(n){return n.map(n=>yt(n)).filter(u)}function yt(t){const{id:e,referenceId:s,displayName:u,emailAddresses:f,rankingExplanation:h}=t;if(!e||!u)return undefined;const i=n.getFirstAndLastName(u),l=pt(e),a=o(u),v=f===null||f===void 0?void 0:f[0];s||n.msbDsbLogger.logError("Wsb Dsb Missing telemetry field",`Missing referenceId for Recommended People`);const c={uid:l,referenceId:s,fullName:u,firstName:i===null||i===void 0?void 0:i.firstName,lastName:i===null||i===void 0?void 0:i.lastName,initials:a,email:v};return n.msbDsbHost.isPeopleExplanationEnabled()&&(r(h,"recommendedPerson.rankingExplanation"),c.rankingExplanation=h),c}function pt(n){const t=n.indexOf("@");return t>-1?n.substring(0,t):n}function l(n){return n?n.filter(n=>n).map(n=>p(n)).filter(u):undefined}function p(n){const{id:r,fullName:t,jobTitle:u,userPrincipalName:i}=n;if(!t)return undefined;const f=o(t);return{uid:r,fullName:t,initials:f,jobTitle:u,userPrincipalName:i,email:i}}function o(n){return n.split("(")[0].split(" ").filter(n=>n.match(/^([a-zA-Z])[a-zA-Z]*/)).map(n=>n[0].toUpperCase()).slice(0,2).join("")}function w(n){let t=encodeURIComponent(n);return t=t.replace(/_/g,"%2B"),t=t.replace(/-/g,"%2F"),`${ui}deeplink?ItemID=${t}`}function wt(n,t){const i=encodeURIComponent(n);return`${fi}${i}/${t}?context={"contextType":"chat"}`}function sr(n){return n}function hr(t,i=false){const r=t===null||t===void 0?void 0:t.baselineGleam,u=bt(r,i),f=n.msbDsbHost.gleamManager.getScenarioDescription("Baseline");return{baselineGleamData:{gleamContent:u,description:f,longExpiration:!0,scenario:"Baseline"}}}function bt(t,i=false){const r=a(t===null||t===void 0?void 0:t.lightGleam,t===null||t===void 0?void 0:t.isPng),u=(t===null||t===void 0?void 0:t.darkGleam)?a(t===null||t===void 0?void 0:t.darkGleam,t===null||t===void 0?void 0:t.isPng,i):r;return r&&u&&n.msbHost.features.isServerGleamEnabled()?((t===null||t===void 0?void 0:t.gleamKey)||n.msbDsbLogger.logError(i?"Wsb Dsb Gleam key from cache missing":"Wsb Dsb Gleam key missing"),{lightGleam:r,darkGleam:u,isBigGleam:t===null||t===void 0?void 0:t.isBigGleam,gleamKey:t===null||t===void 0?void 0:t.gleamKey}):undefined}function cr(n){const t=i.getDynamicAnswerState(n);return Object.assign({},t)}function kt(n,t=false){switch(n){case"RecommendedPeople":return t?"Wsb Dsb Recommended People answer conversion from cache failed":"Wsb Dsb Recommended People answer conversion failed";case"OrgChart":return t?"Wsb Dsb Org Chart answer conversion from cache failed":"Wsb Dsb Org Chart answer conversion failed";case"Feed":return t?"Wsb Dsb Feed answer conversion from cache failed":"Wsb Dsb Feed answer conversion failed";case"IndustryNews":return t?"Wsb Dsb Industry News answer conversion from cache failed":"Wsb Dsb Industry News answer conversion failed";case"MeetingPrep":return t?"Wsb Dsb Meeting Prep answer conversion from cache failed":"Wsb Dsb Meeting Prep answer conversion failed";case"FileRequest":return t?"Wsb Dsb File Request answer conversion from cache failed":"Wsb Dsb File Request answer conversion failed";case"PopularSearch":return t?"Wsb Dsb Popular Tenant Searches answer conversion from cache failed":"Wsb Dsb Popular Tenant Searches answer conversion failed";case"SearchBoxGleam":return t?"Wsb Dsb Search Box Gleam answer conversion from cache failed":"Wsb Dsb Search Box Gleam answer conversion failed";case"EduAssignments":return t?"Wsb Dsb Edu Assignments answer conversion from cache failed":"Wsb Dsb Edu Assignments answer conversion failed";case"EduClasses":return t?"Wsb Dsb Edu Classes answer conversion from cache failed":"Wsb Dsb Edu Classes answer conversion failed";case"Acronyms":return t?"Wsb Dsb Acronyms answer conversion from cache failed":"Wsb Dsb Acronyms answer conversion failed";case"FileSearchSuggestions":return t?"Wsb Dsb File Suggestions answer conversion from cache failed":"Wsb Dsb File Suggestions answer conversion failed";case"RecentQueries":return t?"Wsb Dsb Recent Queries answer conversion from cache failed":"Wsb Dsb Recent Queries answer conversion failed";default:return t?"Wsb Dsb answer conversion from cache failed":"Wsb Dsb answer conversion failed"}}function dt(n){if(!n)return undefined;const{image:t,imageProxy:i}=n;return!t||!i?undefined:{previewUrl:t,previewProxyUrl:i}}function lr(n){var i,r,u;const t=(r=(i=n.actors)===null||i===void 0?void 0:i[0])!==null&&r!==void 0?r:n.sharedBy;if(!((u=t===null||t===void 0?void 0:t.user)===null||u===void 0?void 0:u.displayName))return{isMe:!0};const{displayName:e,email:s,isMe:f,id:h}=t.user,c=o(e);return{initials:c,fullName:e,email:s,uid:h,isMe:f!==null&&f!==void 0?f:!1}}function ar(n){if(!n)return undefined;const{displayName:t,email:i,id:r}=n;if(!t)return undefined;const u=o(t);return{initials:u,uid:r,email:i,fullName:t,isMe:!1}}function vr(n){return(n===null||n===void 0?void 0:n.status)!="Succeeded"?[]:(f(n.recentQuerySuggestions,"recentQuerySuggestions"),n.recentQuerySuggestions.map(n=>yr(n)))}function yr(n){r(n.globalId,"globalId");r(n.query,"query");r(n.workloadName,"workloadName");r(n.lastUsedTimeStamp,"lastUsedTimeStamp");const t=pr(n.workloadName);if(!t)throw new c(`Unsupported workload name: ${n.workloadName}`);return{id:n.globalId,query:n.query,canvas:t,searchTime:n.lastUsedTimeStamp}}function pr(n){switch(n){case"Outlook":case"Teams":return n;case"Bing":return"BingWorkSearch";case"M365":return"Sharepoint";default:return undefined}}function wr(t){var r,u;if(t.status!=="Succeeded")return undefined;const{traceId:c,logicalId:l,status:a,answerType:v}=t,i=(r=t===null||t===void 0?void 0:t.assignmentPage)===null||r===void 0?void 0:r.educationAssignments;if(!i||i.length==0)return undefined;const o=(u=gt(i))===null||u===void 0?void 0:u.slice(0,2);if(!o||o.length==0)return undefined;f(i,"eduAssignmentsItems");const y=e(v),p=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduAssignment");let s=h(n.Host.getLocString("EduCardAssignmentsQuery"),!0);s=n.msbHost.urlUtils.appendHash(s,"EducationAssignment");const w=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduAssignmentSeeMoreLink"),b=i.length;return{traceId:c,logicalId:l,status:a,answerType:y,entities:o,instrumentedItem:p,subItemInstrumentedItem:w,seeMoreLink:s,totalCount:b}}function gt(n){return n.filter(n=>n).map(n=>ni(n)).filter(u)}function ni(t){var u;const{id:f,name:o,isTeacher:c,dueDateUnixTimestamp:s,educationClass:i,isOverDue:l,webUrl:r}=t;if(!f||!o)return undefined;const e=s?new Date(s*1e3):undefined,a=e===null||e===void 0?void 0:e.toLocaleDateString((u=n.getCurrentLanguage())===null||u===void 0?void 0:u.substring(0,2),{month:"short",day:"numeric"}),h=i===null||i===void 0?void 0:i.name,v=i===null||i===void 0?void 0:i.id,y=n.config.msbDsbEnableAssignmentWebUrl&&(r===null||r===void 0?void 0:r.length)>0?r:br(i===null||i===void 0?void 0:i.id,f),p=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduAssignmentItem");return{dueDate:a,className:h,id:f,isTeacher:c,name:o,link:y,instrumentedItem:p,classId:v,description:h,isOverDue:l}}function br(n,t){return si+encodeURIComponent(JSON.stringify({subEntityId:JSON.stringify({action:"navigate",view:"assignment-viewer",appId:"MSB-WSB-DSB",config:{classes:[{id:`${n}`,assignmentIds:[`${t}`]},]}})}))}function kr(t){var r;if(t.status!=="Succeeded")return undefined;const{traceId:o,logicalId:s,status:c,answerType:l}=t,i=t===null||t===void 0?void 0:t.classes;if(!i||i.length==0)return undefined;const u=(r=ti(i))===null||r===void 0?void 0:r.slice(0,2);if(!u||u.length==0)return undefined;f(i,"eduClassItems");const a=e(l),v=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduClass"),y=h(n.Host.getEnUsLocString("EduCardClassesQuery"),!0),p=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduClassSeeMoreLink"),w=i.length;return{traceId:o,logicalId:s,status:c,answerType:a,entities:u,instrumentedItem:v,subItemInstrumentedItem:p,seeMoreLink:y,totalCount:w}}function ti(n){return n.map(n=>ii(n)).filter(u)}function ii(t){const{id:i,name:r,url:u}=t;if(!i||!r)return undefined;const f=u?dr(u):hi,e=n.msbDsbHost.instrumentationManager.createInstrumentedItem("EduClassItem");return{classId:i,name:r,link:f,instrumentedItem:e}}function dr(n){return n.replace(ei,oi)}function u(n){return n!==undefined&&n!==null&&n!==""}function r(n,t){if(!u(n))throw new c(`Missing required field, ${t}`);}function f(n,t){if(r(n,t),n.length==0)throw new c(`Unexpected empty list, ${t}`);}function ri(t,i,r,u,f){const o=t instanceof Error?t.message:"Unknown error",e=JSON.stringify(t,Object.getOwnPropertyNames(t));n.msbDsbLogger.logResponseError(kt(i,f),o,e,r,u)}const ui="https://outlook.office365.com/mail/",fi="https://teams.microsoft.com/l/message/",ei="https://",oi="ms-teams://",si="ms-teams://teams.microsoft.com/l/entity/66aeee93-507d-479a-a3ef-8f494af43945/classroom?context=",hi="https://teams.microsoft.com/_#/school/teams-grid/General?ctx=teamsGrid";class c extends Error{constructor(n,t){super(n);this.innerError=t}}i.ResponseFieldError=c;i.convertIconContent=a;i.convertScenarioToViewDataModel=ci;i.convertRecommendedPeopleAnswerToViewDataModel=li;i.convertIndustryNewsAnswerToViewDataModel=ai;i.convertNewsArticlesToViewDataModel=b;i.convertAcronymsAnswerToViewDataModel=vi;i.convertFileSearchSuggestionsToViewDataModel=yi;i.convertOrgChartAnswerToViewDataModel=pi;i.convertFeedAnswersToViewDataModel=ki;i.resetAnswersPlacement=di;i.convertMeetingPrepAnswerToViewDataModel=gi;i.convertMeetingPrepEntitySetsToViewDataModel=k;i.convertMeetingPrepAttendeesToViewDataModel=d;i.convertMeetingPrepAttendeeToViewDataModel=g;i.convertMeetingPrepAttendeeStatusToViewDataModel=nt;i.convertMeetingPrepDocumentResultsToViewDataModel=tt;i.convertMeetingPrepMessageResultsToViewDataModel=it;i.convertMeetingPrepDocumentResultSourceToViewDataModel=rt;i.convertMeetingPrepMessageResultSourceToViewDataModel=ut;i.convertMeetingPrepIdentityToPersonViewDataModel=v;i.convertFileRequestModalityEntityToViewDataModel=ft;i.convertFileRequestAnswerToViewDataModel=tr;i.convertFileRequestorToPersonViewDataModel=et;i.convertFileRequestFileToViewDataModel=ot;i.convertFeedItemToViewDataModel=st;i.convertBaseFeedItemToViewDataModel=s;i.convertFileFeedItemToViewDataModel=ht;i.convertVideoFeedItemToViewDataModel=ct;i.convertMentionFeedItemToViewDataModel=y;i.getItemSourceFromContainerInfo=lt;const ir=t=>{var u;const f=n.msbDsbHost.getLocString("TrendingTidbit");if(!t)return i.formatTidbitWithActor(f,"Other");const r=lr(t);if(!r)return t.kind==="newsInclusionReason"?i.formatTidbitWithActor(n.msbDsbHost.getLocString("RecentCompanyNewsTidbit"),"Other"):i.formatTidbitWithActor(f,"Other");switch(t.kind){case"activityInclusionReason":case"aggregatedActivityInclusionReason":return i.getActivityTidbit(r,(u=t.activity)===null||u===void 0?void 0:u.kind);case"recommendedInclusionReason":return i.getRecommendedTidbit(t.inclusionKind,r);case"yammerAnnouncementInclusionReason":case"yammerFeaturedConversationInclusionReason":case"yammerPostInclusionReason":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("PostedTidbit"),"Other",r);case"meetingRecordingInclusionReason":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("RecordedMeetingTidbit"),"Other",r);case"newsInclusionReason":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("RecentCompanyNewsTidbit"),"Other");case"trendingInclusionReason":default:return i.formatTidbitWithActor(f,"Other")}};i.getTidbitHeaderIcon=n=>{var t;if(!n)return"trendingIcon";const r=n.inclusionKind;switch(n.kind){case"activityInclusionReason":case"aggregatedActivityInclusionReason":return i.getActivityTidbitIcon((t=n.activity)===null||t===void 0?void 0:t.kind);case"recommendedInclusionReason":return i.getRecommendedTidbitIcon(r);case"meetingRecordingInclusionReason":return rr();case"newsInclusionReason":return ur();case"trendingInclusionReason":default:return"trendingIcon"}};i.getActivityTidbit=(t,r)=>{switch(r){case"authorActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("PostedTidbit"),"Other",t);case"commentActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("CommentedTidbit"),"FileComment",t);case"mentionActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("MentionedTidbit"),"Other",{isMe:!0},t);case"mentionedMeActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("MentionedYouTidbit"),"Other",t);case"modifyActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("ModifiedTidbit"),"FileEdited",t);case"sharingActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("SharedTidbit"),"FileSharedByYou",t);case"viewActivity":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("ViewedTidbit"),"Other",t);default:return i.formatTidbitWithActor(n.msbDsbHost.getLocString("TrendingTidbit"),"Other")}};i.getRecommendedTidbit=(t,r)=>{switch(t){case"SingleCommentYou":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("CommentedTidbit"),"Other",r);case"CommentReplyOthers":case"CommentReplyToYou":case"CommentReplyYou":case"SingleCommentOthers":case"MultipleCommentOthers":case"MultipleCommentYouAndOthers":case"SingleMentionOthers":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("CommentedTidbit"),"FileComment",r);case"SingleMentionYou":case"MultipleMentionYouAndOthers":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("MentionedTidbit"),"Other",{isMe:!0},r);case"SingleMentionedYou":case"MultipleMentionedYou":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("MentionedYouTidbit"),"Other",r);case"SingleEditYou":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("ModifiedTidbit"),"FileEdited",r);case"MultipleEditOthers":case"SingleEditOthers":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("ModifiedTidbit"),"FileEdited",r);case"SharedWithMe":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("SharedTidbit"),"FileSharedByOther",r);case"FrequentlyOpen":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("FrequentlyOpenTidbit"),"Other",r);case"RecentlyOpen":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("RecentlyOpenedTidbit"),"Other",r);case"SingleTaskActivityByOthers":return i.formatTidbitWithActor(n.msbDsbHost.getLocString("TaskCreatedTidbit"),"Other",r);default:return i.formatTidbitWithActor(n.msbDsbHost.getLocString("TrendingTidbit"),"Other")}};i.formatTidbitWithActor=(n,t,i,r)=>({firstActor:i,inclusionType:t,tidbit:n,secondActor:r});i.getActivityTidbitIcon=n=>{switch(n){case"authorActivity":return"postIcon";case"commentActivity":return"commentIcon";case"mentionActivity":return"atCommentIcon";case"mentionedMeActivity":return"atIcon";case"modifyActivity":return"editIcon";case"sharingActivity":return"peopleIcon";case"viewActivity":return"viewedIcon";default:return"trendingIcon"}};i.getRecommendedTidbitIcon=n=>{switch(n){case"CommentReplyToYou":case"CommentReplyOthers":case"CommentReplyYou":case"SingleCommentYou":case"SingleCommentOthers":case"MultipleCommentOthers":case"MultipleCommentYouAndOthers":case"SingleMentionOthers":return"commentIcon";case"SingleMentionYou":case"MultipleMentionYouAndOthers":case"SingleMentionedYou":case"MultipleMentionedYou":return"atCommentIcon";case"SingleEditYou":case"MultipleEditOthers":case"SingleEditOthers":return"editIcon";case"SharedWithMe":return"peopleIcon";case"FrequentlyOpen":return"openFolderIcon";case"RecentlyOpen":return"openFolderIcon";default:return"trendingIcon"}};const rr=()=>"recordingIcon",ur=()=>"postIcon";i.createLearningCardViewDataModel=fr;i.createEduCardViewDataModel=er;i.convertPopularSearchesAnswerToViewModel=or;i.encodeBingWorkQuery=h;i.getColorForEduCards=at;i.convertAnswerTypeToViewDataModel=e;i.convertRecommendedPeopleToViewDataModel=vt;i.convertRecommendedPersonToViewDataModel=yt;i.getUidFromRecommendedPeopleId=pt;i.convertOrgChartPersonListToViewDataModel=l;i.convertOrgChartPersonToViewDataModel=p;i.getPersonInitialsFromFullName=o;i.getOutlookEmailDeepLinkFromId=w;i.getTeamsChatDeepLinkFromId=wt;i.convertAnswerTypeToServiceContract=sr;i.convertSearchBoxGleamAnswer=hr;i.convertSearchBoxGleam=bt;i.getDynamicAnswerStateInConversion=cr;i.convertAnswerToErrorEventType=kt;i.convertRecentQueriesAnswerToViewModel=vr;i.convertEduAssignmentAnswerToViewDataModel=wr;i.convertEduAssignmentToViewDataModel=gt;i.convertEduAssignmentItemToViewDataModel=ni;i.convertEduClassAnswerToViewDataModel=kr;i.convertEduClassToViewDataModel=ti;i.convertEduClassItemToViewDataModel=ii;i.logAnswerConversionError=ri})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){t.ViewDataContext=React.createContext(null);class i{constructor(i,r,u,f){this.externalDataManager=i;this.renderingMonitor=r;this.recommendedPeopleViewDataManager=u;this.mainPageLayoutManager=f;this.ContextProvider=({children:i})=>{const u="ContextProvider",[f,r]=React.useReducer(this.rootReducer,this.initState),[o,s]=React.useState(!1),[e,h]=React.useState(undefined);return this.renderingMonitor.startPollingMainPageLoaded(),this.externalDataManager.isDataChangeHandlerBound(u)||this.externalDataManager.bindDataChanged(u,async(i,...u)=>{switch(i){case"MainPageData":{const i=this.externalDataManager.getMainPageData(),f=u[0];h(f);n.msbPerfLogger===null||n.msbPerfLogger===void 0?void 0:n.msbPerfLogger.mark(n.MsbPerfProbe.DsbMainPageRenderStarted,f);r(t.setMainPageDataAction(i));const e=await this.recommendedPeopleViewDataManager.getRecommendedPeoplePaginationSettingAsync(i.recommendedPeopleAnswer);r(t.setRecommendedPeoplePaginationSettingAction(e));break}case"ImageOfTheDay":{const[n]=u;r(t.setImageOfTheDayAction(n));break}case"PersonPhoto":{const[n,i]=u;r(t.setPersonPhotoAction(n,i));break}case"GroupPhoto":{const[n,i]=u;r(t.setGroupPhotoAction(n,i));break}case"FeedItemPreview":{const[n,i]=u;r(t.setFeedItemPreviewAction(n,i));break}case"FileIcon":{const[n,i]=u;r(t.setFileIconAction(n,i));break}case"FluentIconSvgHtml":{const[n,i]=u;r(t.setFluentIconSvgHtmlAction(n,i));break}}}),o||(n.Host.bindDismissed(()=>{var i,u;const f=(i=this.externalDataManager.getMainPageData())===null||i===void 0?void 0:i.dynamicAnswer;if(n.config.msbDsbMockServiceClients||t.isDynamicScenarioExpired(f)&&r(t.dismissAnswerAction(f.answerType,f.answerId,{dismissOnView:!0,dismissViaRequest:!1})),n.config.msbDsbPeopleShufflingEnabled){const n=t.shufflePeople((u=this.externalDataManager.getMainPageData())===null||u===void 0?void 0:u.recommendedPeopleAnswer);r(t.setPeopleShuffleAction(n))}n.config.msbEnableChatUpsell&&n.msbHost.getChatEligibility()!="None"&&r(t.setChatUpsellCurrIdxStateAction())}),s(!0)),React.useEffect(()=>()=>this.externalDataManager.unbindDataChanged("ContextProvider"),[]),React.useEffect(()=>{n.msbPerfLogger===null||n.msbPerfLogger===void 0?void 0:n.msbPerfLogger.mark(n.MsbPerfProbe.DsbMainPageRenderEnd,e),this.renderingMonitor.setMainPageDataRefreshed()},[f.mainPageState,e]),React.createElement(t.ViewDataContext.Provider,{value:{state:f,dispatch:r}},i)};this.rootReducer=t.createRootReducer(this.externalDataManager,this.recommendedPeopleViewDataManager,this.mainPageLayoutManager);this.initState=this.buildInitState()}buildInitState(){const n=t.getIsMyOrgChartExpanded(),i=t.getIsEduClassesExpanded(),r=t.getIsEduAssignmentsExpanded();return{uiOptions:{errorBoundaryResetKey:0,isMyOrgChartExpanded:n,isEduClassesExpanded:i,isEduAssignmentsExpanded:r},paginationSettings:{},mainPageState:{mainPageData:null,mainPageLayout:[]},imageOfTheDay:{imageOfTheDay:undefined},personPhotos:{},groupPhotos:{},feedItemPreviews:{},fileIcons:{},fluentIconSvgHtmls:{},chatUpsellState:{currSuggestionIdx:0}}}}t.ViewDataManager=i})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){function r(){let t=n.config.msbDsbPersistOrgChartExpansion==="alwaysOn";if(n.config.msbDsbPersistOrgChartExpansion==="storage"){const i=n.LightweightStorage.getItem(n.MsbDsb.MYORGCHART_EXPANSION_STORAGE_KEY);t=i?i==="1":!!n.config.msbDsbColdStartOrgChartOpen}return t}function u(){const t=n.LightweightStorage.getItem(n.MsbDsb.EDUCLASSES_EXPANSION_STORAGE_KEY);return t?t==="1":!0}function f(){const t=n.LightweightStorage.getItem(n.MsbDsb.EDUASSIGNMENTS_EXPANSION_STORAGE_KEY);return t?t==="1":!0}function e(t){var i;const r=(i=t===null||t===void 0?void 0:t.expiryTime)===null||i===void 0?void 0:i.getTime();return typeof r=="number"&&n.getCurrentTime()>r}function i(n){return n==="MeetingPrep"||n==="FileRequest"}function o(n){return i(n)||n==="IndustryNews"}function s(n){const t=(n===null||n===void 0?void 0:n.status)==="Succeeded",r=t&&i(n.answerType);return{isAnswerStatusSucceeded:t,isAnswerM365Content:r}}function h(t,i){const r=t.slice(0,i);return n.msbDsbHost.getLocString("TruncatedTextPattern",r)}function c(n){const t=[...n];for(let n=t.length-1;n>0;n--){const i=Math.floor(Math.random()*(n+1));[t[n],t[i]]=[t[i],t[n]]}return t}function l(t){var i,r;const u=[{title:"PersonCentricOrgSearch",instrumentationQuery:"org"},{title:"AuthorsFilesSearchSuggestions",instrumentationQuery:"files"},{title:"PersonCentricContactSearch",instrumentationQuery:"contact"},{title:"PersonCentricCalenderSearch",instrumentationQuery:"calendar"},],f=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.staticPeopleCentricSuggestions)?u:c(u),e=(r=(i=n.getFirstAndLastName(t))===null||i===void 0?void 0:i.firstName)!==null&&r!==void 0?r:"";return f.map(i=>{const u=n.msbDsbHost.getLocString(i.title,t),r=n.msbDsbHost.getLocString(i.title,e);return{title:r,icon:"personIcon",query:n.config.msbDsbPersonCentricSuggestionFullNameQuery?u:r,scope:n.Scope.Work}})}function a(n){const t=n===null||n===void 0?void 0:n.recommendedPeople.slice();let i=(t===null||t===void 0?void 0:t.length)-1;while(i>0&&0!==i){const n=Math.floor(Math.random()*i);i-=1;const r=t[i];t[i]=t[n];t[n]=r}return Object.assign({},n,{recommendedPeople:t})}t.getIsMyOrgChartExpanded=r;t.getIsEduClassesExpanded=u;t.getIsEduAssignmentsExpanded=f;t.isDynamicScenarioExpired=e;t.isViewModelAnswerTypeDynamicM365=i;t.isViewModelAnswerTypeDynamic=o;t.getDynamicAnswerState=s;t.getTruncatedText=h;t.generateRandomPersonCentricSuggestions=l;t.shufflePeople=a})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){function c(i,u){var w,b;const{chatText:y,isCached:g,type:nt}=i,p=y===null||y===void 0?void 0:y.trim();if(!p)throw new t.ParserError("chatText cannot be empty string");const k=i.contentType;if(k&&!t.isContentTypeHtml(k))return{messageContent:p,isHtml:!1};const c=(new DOMParser).parseFromString(y,"text/html");if(!(((b=(w=c===null||c===void 0?void 0:c.body)===null||w===void 0?void 0:w.children)===null||b===void 0?void 0:b.length)>0)){if(t.isPotentiallyHtml(p)){n.msbDsbLogger.logError(g?"Wsb Dsb message snippet is bad html cached":"Wsb Dsb message snippet is bad html");throw new t.ParserError(`Chat message is badly formatted html string with content type: ${k}`);}return{messageContent:p,isHtml:!1}}const s=c.createTreeWalker(c.body,NodeFilter.SHOW_ELEMENT);let e=s.currentNode;while(e)t.isNodeWhitespace(e)&&t.removeNode(s,e),e.nodeName===f?t.removeNode(s,e):o.indexOf(e.nodeName)==-1?t.sanitizeNode(s,e):e.nodeName===r?(e.className=h,u&&t.sanitizeNode(s,e)):l(e)&&(nt=="Feed"?a(s,e,i.mentionList):v(s,e)),e.removeAttribute("style"),e=s.nextNode();const d=c.body.innerHTML.trim();if(!d)throw new t.ParserError("chatText does not appear to have any content");return{messageContent:d,isHtml:!0,messageString:c.body.textContent}}function l(n){if(!n||n.nodeName!==i)return!1;const t=n.getAttribute("itemtype");return t===e}function a(n,t,i){var r,f,e;const s=y(i);let o;const h=parseInt((r=t.getAttribute("itemid"))!==null&&r!==void 0?r:"");n.parentNode();o=h in s?u(t):document.createTextNode((f=t.textContent)!==null&&f!==void 0?f:"");(e=t.parentNode)===null||e===void 0?void 0:e.replaceChild(o,t)}function v(n,t){var i;n.parentNode();const r=u(t);(i=t.parentNode)===null||i===void 0?void 0:i.replaceChild(r,t)}function u(n){const t=document.createElement(i);return t.textContent=n.textContent,t.className=s,t}function y(n){const t={};return n.forEach(n=>{const i=n.id.toString();i in t||(t[i]=n)}),t}const r="A",i="SPAN",f="BLOCKQUOTE",e="http://schema.skype.com/Mention",o=["BODY","P","DIV",r,i],s="chat-message-mentioned-name",h="chat-message-link";t.parseChatMessage=c})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){function o(i,e,o,c=false){var p,w;if(!i)throw new t.ParserError("emailText cannot be null or undefined");i=i.replace(/^\s*[\r\n]/gm,"");const y=i===null||i===void 0?void 0:i.trim();if(!y)throw new t.ParserError("emailText cannot be empty string");if(o&&!t.isContentTypeHtml(o))return{messageContent:y,isHtml:!1};const a=(new DOMParser).parseFromString(i,"text/html");if(!(((w=(p=a===null||a===void 0?void 0:a.body)===null||p===void 0?void 0:p.children)===null||w===void 0?void 0:w.length)>0)){if(t.isPotentiallyHtml(y)){n.msbDsbLogger.logError(e?"Wsb Dsb message snippet is bad html cached":"Wsb Dsb message snippet is bad html");throw new t.ParserError(`email snippet is badly formatted html string with content type: ${o}`);}return{messageContent:y,isHtml:!1}}const v=a.createTreeWalker(a.body,NodeFilter.SHOW_ELEMENT);let l=v.currentNode;while(l)t.isNodeWhitespace(l)&&t.removeNode(v,l),u.indexOf(l.nodeName)==-1?t.sanitizeNode(v,l):l.nodeName===r&&(h(l)?s(v,l):(l.className=f,c||l.removeAttribute("href"))),l.removeAttribute("style"),l=v.nextNode();const b=a.body.innerHTML.trim();if(!b)throw new t.ParserError("chatText does not appear to have any content");return{messageContent:b,isHtml:!0,messageString:a.body.textContent}}function s(n,t){var r;n.parentNode();const u=document.createElement(i);if(t.textContent){const n=t.textContent.length;u.textContent=t.textContent.substring(1,n)}u.className=e;(r=t.parentNode)===null||r===void 0?void 0:r.replaceChild(u,t)}function h(n){var t,r,u,f;if(!((t=n.getAttribute("href"))===null||t===void 0?void 0:t.startsWith("mailto:"))||((r=n.childNodes)===null||r===void 0?void 0:r.length)!==1)return!1;const e=(u=n.childNodes)===null||u===void 0?void 0:u[0];return(e===null||e===void 0?void 0:e.nodeName)!==i?!1:(f=n.innerText)===null||f===void 0?void 0:f.startsWith("@")}const r="A",i="SPAN",u=["BODY","P","DIV",r,i],f="email-message-link",e="email-message-mentioned-name";t.parseEmailMessage=o})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){var t;(function(n){function i(n,t){var i;n.parentNode();const r=document.createTextNode(t.textContent);(i=t.parentNode)===null||i===void 0?void 0:i.replaceChild(r,t)}function r(n,t){var i;n.parentNode();(i=t.parentNode)===null||i===void 0?void 0:i.removeChild(t)}function u(n){return n.innerHTML==="&nbsp;"||n.innerHTML===""}function f(n){return n.toUpperCase()==="HTML"}function e(n){var t;return((t=n.match(/<\/\w[\s\S]*>/i))===null||t===void 0?void 0:t.length)>0}class t extends Error{constructor(n,t){super(n);this.innerError=t}}n.ParserError=t;n.sanitizeNode=i;n.removeNode=r;n.isNodeWhitespace=u;n.isContentTypeHtml=f;n.isPotentiallyHtml=e})(t=n.DataContext||(n.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){const r="rec-ppl-pg",u=36e5;class f{constructor(n){this.cacheManager=n;this.pendingInitPromise=this.loadRecommendedPeoplePaginationInfoAsync().then(n=>{this.recommendedPeoplePaginationInfo=n}).catch(()=>{})}async getRecommendedPeoplePaginationSettingAsync(t){var u,f;this.pendingInitPromise&&(await this.pendingInitPromise,this.pendingInitPromise=undefined);const e=n.getCurrentTime(),o=this.getRecommendedNumberOfShownPeople(),s=(u=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbRecPeoplePageRefreshIntervalInHours)!==null&&u!==void 0?u:(f=n.config.msbDsbRecPeoplePageRefreshIntervalInHours)!==null&&f!==void 0?f:2;let i=0,r=!1;return t&&(this.recommendedPeoplePaginationInfo?(i=this.recommendedPeoplePaginationInfo.currentPageIndex,this.isNewAnswer(this.recommendedPeoplePaginationInfo.hash,t.hash)?(i=0,r=!0):this.isExpired(s,this.recommendedPeoplePaginationInfo.lastRefreshTimestamp)&&(i=i+1,r=!0)):r=!0,r&&(this.recommendedPeoplePaginationInfo={hash:t.hash,currentPageIndex:i,lastRefreshTimestamp:e},await this.saveRecommendedPeoplePaginationInfoAsync())),{currentPageIndex:i,pageSize:o}}async updateRecommendedPeoplePageIndexAsync(t){this.pendingInitPromise&&(await this.pendingInitPromise,this.pendingInitPromise=undefined);this.recommendedPeoplePaginationInfo&&(this.recommendedPeoplePaginationInfo.currentPageIndex=t,this.recommendedPeoplePaginationInfo.lastRefreshTimestamp=n.getCurrentTime());await this.saveRecommendedPeoplePaginationInfoAsync()}isNewAnswer(n,t){return t?n!=t:!0}getRecommendedNumberOfShownPeople(){const i=n.msbDsbHost.isPeopleExplanationEnabled();return(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbRecommendedPeoplePageSize)&&!i?n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbRecommendedPeoplePageSize:i?t.PEOPLEHERO_PERSON_DISPLAY_COUNT:t.RECOMMENDED_PEOPLE_DISPLAY_COUNT}isExpired(t,i){const r=n.getCurrentTime();return n.config.msbDsbRecPeoplePageRefreshOff?!1:i?r-i>=t*u?!0:!1:!0}async loadRecommendedPeoplePaginationInfoAsync(){return await this.cacheManager.getDataAsync(r)}async saveRecommendedPeoplePaginationInfoAsync(){this.recommendedPeoplePaginationInfo&&await this.cacheManager.setDataAsync(r,this.recommendedPeoplePaginationInfo)}}i.RecommendedPeopleViewManager=f})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){class i{createMainPageLayout(t){var r;if(n.msbHost.isEduTenant())return[];const i=[];i.push("SearchBox");n.config.msbEnableScopeSwitchButton&&i.push("ScopeSwitch");t.dynamicAnswer?i.push("Dynamic"):i.push("FileHero");i.push("RecommendedPeople");i.push("OrgChart");((r=n.msbHost.msbWorkChatUtils)===null||r===void 0?void 0:r.validChatEligibilityStateForCard())&&(n.config.msbChatUpsellLocation!=-1?i.splice(n.config.msbChatUpsellLocation,0,"WorkChatCard"):i.push("WorkChatCard"));const u=t.dynamicAnswer?"None":"Feed";return i.push("PopularSearch"),i.push(u),i.push("Acronyms"),i}}t.MainPageLayoutManager=i})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){function f(t,i){var u;const r=[];let f=!1;if(Object.keys(i).length>0&&((u=t===null||t===void 0?void 0:t.scenario)===null||u===void 0?void 0:u.answers)){const{scenario:{answers:u}}=t;for(const t of u){const e=t.answerType,u=i[e];(u===null||u===void 0?void 0:u.hash)&&t&&t.hash&&u.hash===t.hash?r.push(u):t.status==="Succeeded"||t.status==="Empty"?(r.push(t),n.config.msbDsbBadging&&t.status==="Succeeded"&&!o(e)&&(f=!0)):e==="SearchBoxGleam"&&u?r.push(u):r.push(t)}t.scenario.answers=r;t.hasNewContent=f}return t}function e(n,t,i){var f;const e=[];if(Object.keys(t).length>0&&((f=n===null||n===void 0?void 0:n.scenario)===null||f===void 0?void 0:f.answers)){const{scenario:{answers:f}}=n;for(const n of f){const o=n.answerType,f=t[o];r(n.answerType)||i&&u(n.answerType)||(n===null||n===void 0?void 0:n.status)==="Succeeded"||(n===null||n===void 0?void 0:n.status)==="Empty"||(f===null||f===void 0?void 0:f.status)!=="Succeeded"?e.push(n):e.push(f)}n.scenario.answers=e}return n}function r(n){switch(n){case"MeetingPrep":case"FileRequest":case"IndustryNews":return!0;default:return!1}}function u(n){switch(n){case"MeetingPrep":case"FileRequest":case"IndustryNews":case"Feed":case"RecentQueries":return!0;default:return!1}}function o(t){switch(t){case"RecommendedPeople":case"OrgChart":case"Feed":case"EduAssignments":case"EduClasses":return!1;case"MeetingPrep":case"FileRequest":return!n.config.msbDsbBadgingDynamic;default:return!0}}function s(n,t){var i;return(t===null||t===void 0?void 0:t.dismissedAnswers)||(t={dismissedAnswers:[]}),t.dismissedAnswers=[n].concat((i=t.dismissedAnswers)!==null&&i!==void 0?i:[]),t}function h(n,t){return(t===null||t===void 0?void 0:t.dismissedAnswers)?t.dismissedAnswers.indexOf(n)!==-1:!1}function c(n){var t;const i={};if((t=n===null||n===void 0?void 0:n.scenario)===null||t===void 0?void 0:t.answers){const{scenario:{answers:t}}=n;for(const n of t)(n===null||n===void 0?void 0:n.hash)&&(i[n.answerType]=n.hash)}return{AnswersInCache:i}}function l(n){var t;const i={};if((t=n===null||n===void 0?void 0:n.scenario)===null||t===void 0?void 0:t.answers){const{scenario:{answers:t}}=n;for(const n of t)(n===null||n===void 0?void 0:n.answerType)&&(i[n.answerType]=n)}return i}function a(t,i){var r,u,f,e,o;if((r=t===null||t===void 0?void 0:t.scenario)===null||r===void 0?void 0:r.answers){const{scenario:{answers:r}}=t;for(const t of r)if((t===null||t===void 0?void 0:t.answerType)==="OrgChart"&&(t===null||t===void 0?void 0:t.status)==="Succeeded"){const r=t,h=(f=(u=r.reportingChain)===null||u===void 0?void 0:u.slice(1))!==null&&f!==void 0?f:[],c=(e=r.directReports)!==null&&e!==void 0?e:[],l=(o=r.peers)!==null&&o!==void 0?o:[],s=v(h,c,l);if(s!==null)return n.msbDsbLogger.logOrgChartAnswerChangeType(s.changeType,i,{}),!0}}return!1}function v(n,t,r){const u=n===null||n===void 0?void 0:n.filter(i),f=t===null||t===void 0?void 0:t.filter(i),e=r===null||r===void 0?void 0:r.filter(i);if((u===null||u===void 0?void 0:u.length)>0||(f===null||f===void 0?void 0:f.length)>0||(e===null||e===void 0?void 0:e.length)>0){let n;return(u===null||u===void 0?void 0:u.length)>0?n=u[0]:(f===null||f===void 0?void 0:f.length)>0?n=f[0]:(e===null||e===void 0?void 0:e.length)>0&&(n=e[0]),n}return null}function i(n){return(n===null||n===void 0?void 0:n.changeType)&&(n===null||n===void 0?void 0:n.changeType)!=="None"}t.rehydrateAnswersFromCache=f;t.replaceFailedAnswersWithCachedAnswers=e;t.isResponseAnswerTypeDynamic=r;t.isResponseAnswerTypeDismissable=u;t.addDismissedAnswerId=s;t.isAnswerDismissed=h;t.getAnswersInCacheHashes=c;t.getAnswersInCache=l;t.logOrgChartChanges=a})(i=t.DataContext||(t.DataContext={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){function f(n){return i(n,!0)}function e(n){return i(n,!1)}function i(n,t){try{const i=(new DOMParser).parseFromString(n,"image/svg+xml"),r=i.querySelector("parsererror");if(r)throw new Error(`Parser error: ${r.textContent}`);if(s(i))return n;const u=o(t);c(i,u);let f=h(i);return f.replace('xmlns=""',"")}catch(i){return n}}function o(n){return n?r:u}function s(n){const i=`[tag="${t}"]`,r=n.querySelector(i);return!!r}function h(n){const t=new XMLSerializer;return t.serializeToString(n)}function c(n,i){const r=n.createElement("circle");r.setAttribute("cx",i.cx);r.setAttribute("cy",i.cy);r.setAttribute("r",i.r);r.setAttribute("fill",i.color);r.setAttribute("stroke",i.stroke);r.setAttribute("stroke-width",i.strokeWidth);r.setAttribute("tag",t);n.documentElement.appendChild(r)}const t="badging",r={cx:"217",cy:"24",r:"15",color:"#005FB7",stroke:"#FFFFFF",strokeWidth:"6"},u={cx:"217",cy:"24",r:"15",color:"#60CDFF",stroke:"#333333",strokeWidth:"6"};n.addBadgeToSvgLightMode=f;n.addBadgeToSvgDarkMode=e})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){class i{constructor(){this.pageRefreshStartTime=0;this.serverRefreshGuid="";this.lastSentShownEventKey=""}getServerRefreshGuid(){return this.serverRefreshGuid}logMainPageShownEvent(n,t){const i=`${_G.IG},${n}`;if(i!=this.lastSentShownEventKey){const r=Object.assign({},this.getContextualProperties(),t);bfbWsbTel.logDsbImpression(n,r);this.lastSentShownEventKey=i}}startNewRefresh(t){this.pageRefreshStartTime=t;this.serverRefreshGuid=n.Host.createGuid()}isRefreshStarted(){return!!this.pageRefreshStartTime}logClickEvent(n,t){const i=Object.assign({},this.getContextualProperties(),t);bfbWsbTel.logDsbClick(n,i)}logHttpError(t,i,r){const u=Object.assign({},this.getContextualProperties(),{BG:r});if(i instanceof n.MsbHttpError){const e=i,{responseContext:o,errorMessage:r,innerError:s,isBrowserOnline:h,hResultString:c}=e,{statusCode:l,serverTraceId:a,requestSentTime:v,responseReceivedTime:y}=o;let f;n.msbHost.isMsbInternalTenant()&&(f=r===null||r===void 0?void 0:r.privateMessage,u.InnerError=n.stringifyError(s));u.Online=h;u.HResult=c;u.ReqTS=v;u.ResTS=y;bfbWsbTel.logHttpError(t,r===null||r===void 0?void 0:r.publicMessage,{statusCode:l,additionalMessage:f,serverTraceId:a},u)}else if(i instanceof n.MsbNoMsbTokenError){const{codeLocation:r}=i;u.CodeLocation=r;bfbWsbTel.logHttpError(t,"No MSB token refreshed",{statusCode:n.ClientErrorCode.NoToken},u)}else n.msbHost.isMsbInternalTenant()&&(u.InnerError=n.stringifyError(i)),bfbWsbTel.logHttpError(t,"Uncaught error",{statusCode:n.ClientErrorCode.UncaughtError},u)}logMTRefresh(n,t,i){const r=Object.assign({},this.getContextualProperties(),{serverTraceId:t},i);bfbWsbTel.logValue("DSB_MT_Refresh",n,r)}logOrgChartAnswerChangeType(n,t,i){const r=Object.assign({},this.getContextualProperties(),{serverTraceId:t},i);bfbWsbTel.logValue("DSB_OrgChartChangeType",n,r)}logGleamMismatchError(n,t,i,r,u,f){const e=Object.assign({},this.getContextualProperties(),{scenario:t,hasLogo:i,gleamKey:r,BG:f,triggeredBy:n,mtReqInfo:u});bfbWsbTel.logError("Wsb Dsb Gleam Icon Mismatch","",undefined,e)}logGleamDataContentError(n,t,i){const r=n,u=Object.assign({},this.getContextualProperties(),{scenario:t,gleamKey:i});bfbWsbTel.logError("Wsb Dsb Gleam data content has error",r,undefined,u)}logUiError(t,i){const r="Wsb Dsb UI Error",u=`${i} failed to render: ${t instanceof Error?t.message:"Unknown error"}`,f=JSON.stringify(t,Object.getOwnPropertyNames(t)),e=n.msbHost.isMsbInternalTenant()?f:"",o=Object.assign({},this.getContextualProperties(),{CodeLocation:i,additionalMessage:e});bfbWsbTel.logError(r,u,o)}logResponseError(n,t,i,r,u){const{traceId:o,timestamp:e}=r!==null&&r!==void 0?r:{},s=e?new Date(e).toISOString():null;let f=this.getContextualProperties();u&&(f=Object.assign({},f,{AnswerTraceId:u,RefreshTime:s}));this.logErrorWithProperties(n,f,t,i,o)}logError(n,t,i,r){let u=this.getContextualProperties();r&&r!==""&&(u=Object.assign({},u,{CodeLocation:r}));this.logErrorWithProperties(n,u,t,i)}logErrorWithProperties(t,i,r,u,f){const e=n.msbHost.isMsbInternalTenant()?u:"";bfbWsbTel.logError(t,r,{additionalMessage:e,serverTraceId:f},i)}logEvent(t,i){const r=n.getCurrentTime(),u=Object.assign({},this.getContextualProperties(),i);bfbWsbTel.logValue(t!==null&&t!==void 0?t:"",r,u)}getContextualProperties(){return{page:"DSB",IG:_G===null||_G===void 0?void 0:_G.IG,impressionGuid:_G===null||_G===void 0?void 0:_G.IG,serverRefreshGuid:this.serverRefreshGuid,tenantVariants:n.msbHost.getTenantVariants()}}}t.MsbDsbLogger=i})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){class i{constructor(){this.substrateEvents=[];this.pageRefreshStartTime=0;this.logicalIds={}}startNewRefresh(n){this.pageRefreshStartTime=n}setLogicalIds(n){if(n){const{scenario:r,recommendedPeopleAnswer:t,dynamicAnswer:i}=n;(t===null||t===void 0?void 0:t.logicalId)&&this.setLogicalId("RecommendedPeople",t.logicalId);r==="MeetingPrep"&&(i===null||i===void 0?void 0:i.logicalId)&&this.setLogicalId("MeetingPrep",i.logicalId)}}clearLogs(){this.substrateEvents=[]}getLogs(){return this.substrateEvents}logSearchFeedbackEvent(n,t,i,r,u,f){const e=this.logicalIds[n];if(e){const s={type:"ResultFoundResponse",responseValue:i,feedbackString:r},o={name:"searchfeedback",attributes:[{key:"logicalid",value:e},{key:"version",value:"2"},{key:"localtime",value:t},{key:"id",value:u},{key:"FeedbackResponse",value:JSON.stringify(s)},]};f&&o.attributes.push({key:"traceId",value:f});this.log(n,e,o)}}logSearchEntityActions(n,t,i,r,u){const f=this.logicalIds[n];if(f){const e={name:"searchentityactions",attributes:[{key:"userid",value:bfbWsbTel===null||bfbWsbTel===void 0?void 0:bfbWsbTel.getUid()},{key:"tenantid",value:bfbWsbTel===null||bfbWsbTel===void 0?void 0:bfbWsbTel.getTenantId()},{key:"logicalid",value:f},{key:"version",value:"2"},{key:"localtime",value:t},{key:"id",value:r},{key:"eventtype",value:i}]};u&&e.attributes.push({key:"traceId",value:u});this.log(n,f,e)}}logResultsRenderEvents(n,t){const i=t?t-this.pageRefreshStartTime:0;this.checkAndLogEvent("resultsrendered",n,i.toString())}logCachedRenderEvents(n,t){this.checkAndLogEvent("cachedcontentrendered",n,t)}logClientLayoutEvents(n,t){this.checkAndLogEvent("clientlayout",n,t)}checkAndLogEvent(n,t,i){if(t){const{scenario:e,recommendedPeopleAnswer:r,dynamicAnswer:u}=t,f={};(r===null||r===void 0?void 0:r.status)==="Succeeded"&&(f.RecommendedPeople=r);e==="MeetingPrep"&&(u===null||u===void 0?void 0:u.status)==="Succeeded"&&(f.MeetingPrep=u);for(const t in f){const r=t,u=f[r];switch(n){case"resultsrendered":this.logResultsRenderedForAnswer(r,i,u.logicalId);break;case"cachedcontentrendered":this.logCachedAnswerRendered(r,i,u.logicalId,u.traceId);break;case"clientlayout":switch(r){case"RecommendedPeople":this.logRecommendedPeopleLayout(i,u);break;case"MeetingPrep":this.logMeetingPrepLayout(i,u)}}}}}logRecommendedPeopleLayout(n,t){const i="horizontal",r={type:"Group",name:"RecommendedPeople",referenceId:null,entityType:null,layoutType:i,position:1,resultsView:t.recommendedPeople.map((n,t)=>({type:"Entity",name:null,referenceId:n.referenceId,entityType:"People",layoutType:null,position:t+1,resultsView:null}))};this.logClientLayout(n,"RecommendedPeople",this.logicalIds[t.answerType],i,r)}logMeetingPrepLayout(n,t){var i,r,u,f,e,o,s;const h="vertical",c=(r=(i=t.fileResults)===null||i===void 0?void 0:i.map((n,t)=>{var i;return{type:"Entity",name:null,referenceId:(i=n.referenceId)!==null&&i!==void 0?i:null,entityType:"File",layoutType:null,position:t+1,resultsView:null}}))!==null&&r!==void 0?r:[],l=(f=(u=t.fileResults)===null||u===void 0?void 0:u.length)!==null&&f!==void 0?f:0,a=(o=(e=t.conversationResults)===null||e===void 0?void 0:e.map((n,t)=>{var i;return{type:"Entity",name:null,referenceId:(i=n.referenceId)!==null&&i!==void 0?i:null,entityType:"Email",layoutType:null,position:t+1+l,resultsView:null}}))!==null&&o!==void 0?o:[],v=c.concat(a),y={type:"Group",name:"AnswerBlock",referenceId:null,entityType:null,layoutType:h,position:1,resultsView:[{type:"Entity",name:null,referenceId:(s=t.meetingId)!==null&&s!==void 0?s:null,entityType:"MeetingProposal",layoutType:null,position:1,resultsView:null},{type:"Group",name:"Recommended Files",referenceId:null,entityType:null,layoutType:"vertical",position:1,resultsView:v}]};this.logClientLayout(n,"MeetingPrep",this.logicalIds[t.answerType],h,y)}setLogicalId(n,t){this.logicalIds[n]=t}logResultsRenderedForAnswer(n,t,i){if(i){const r={name:"resultsrendered",attributes:[{key:"version",value:"2"},{key:"logicalid",value:i},{key:"latency",value:t}]};this.log(n,i,r)}}logClientLayout(n,t,i,r,u){const f={name:"clientlayout",attributes:[{key:"version",value:"2"},{key:"logicalid",value:i},{key:"localtime",value:n},{key:"layouttype",value:r},{key:"resultsview",value:JSON.stringify([u])}]};this.log(t,i,f)}logCachedAnswerRendered(t,i,r,u){if(u){let f=n.Host.createGuid();f=f.replace(/{|}/g,"");this.setLogicalId(t,f);const e={name:"cachedcontentrendered",attributes:[{key:"userid",value:bfbWsbTel===null||bfbWsbTel===void 0?void 0:bfbWsbTel.getUid()},{key:"tenantid",value:bfbWsbTel===null||bfbWsbTel===void 0?void 0:bfbWsbTel.getTenantId()},{key:"version",value:"2"},{key:"localtime",value:i},{key:"logicalid",value:r},{key:"newlogicalid",value:f}]};this.log(t,u,e)}}log(n,t,i){let r=this.substrateEvents.find(n=>n.key===t);r==undefined&&(r={answerType:n,key:t,value:[]},this.substrateEvents.push(r));r.value.push(i)}}t.MsbDsbSubstrateLogger=i})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){const t="FeedbackTracker";n.FeedbackTrackerCacheKey="fbt";class i{constructor(i,r){this.cacheManager=i;r.bindDataChanged(t,async t=>{var i,u;switch(t){case"MainPageData":{const t=r.getMainPageData();n.DataContext.isViewModelAnswerTypeDynamicM365((i=t===null||t===void 0?void 0:t.dynamicAnswer)===null||i===void 0?void 0:i.answerType)?await this.setAnswerIdAsync((u=t===null||t===void 0?void 0:t.dynamicAnswer)===null||u===void 0?void 0:u.answerId):await this.setAnswerIdAsync();break}}})}async updateProvidedFeedbackIdAsync(n){let t=await this.getCachedAnswerFeedbackAsync();t||(t={answerId:undefined,providedFeedbackIds:[]});t.providedFeedbackIds.push(n);await this.updatedCachedAnswerFeedbackAsync(t)}async getHasProvidedFeedbackAsync(n){const t=await this.getCachedAnswerFeedbackAsync();return t?t.providedFeedbackIds.indexOf(n)!==-1:!1}async getCachedAnswerFeedbackAsync(){return await this.cacheManager.getDataAsync(n.FeedbackTrackerCacheKey)}async updatedCachedAnswerFeedbackAsync(t){await this.cacheManager.setDataAsync(n.FeedbackTrackerCacheKey,t)}async setAnswerIdAsync(n){n||await this.clearFeedbackAsync();let t=await this.getCachedAnswerFeedbackAsync();(t===null||t===void 0?void 0:t.answerId)!=n&&(t={answerId:n,providedFeedbackIds:[]},await this.updatedCachedAnswerFeedbackAsync(t))}async clearFeedbackAsync(){await this.cacheManager.deleteDataAsync(n.FeedbackTrackerCacheKey)}}n.MsbDsbFeedbackTracker=i})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){const r=216e5,i="lstglinst";class u{constructor(n){this.cacheManager=n;this.resetInstrumentProps()}async instrumentGleamAsync(t,r,u,f){const o=await this.shouldSendInstrumentationAsync();if(o){await this.cacheManager.setDataAsync(i,n.getCurrentTime());let e={};e={gleamData:{text:t,key:r},tenantHasLogo:u,isNewDSBContentFetched:f};n.InstrumentationHelper.instrumentDSBEvent(e)}}resetInstrumentProps(){this.currentKValue=n.InstrumentationCommon.KVALUE_DSB_MSB_CONTENT;this.resetInstrumentPropsDict()}resetInstrumentPropsDict(){this.instrumentedPropsDict={}}getInstrumentProps(){const n=[],i=_ge(t.ROOT_CONTAINER_ID);if(!i)return n;const r=i.querySelectorAll(`[${t.MDSB_INSTRUMENTED_ITEM_ATTRIBUTE}]`);for(let i=0;i<r.length;i++){const u=r[i],f=u===null||u===void 0?void 0:u.getAttribute(t.MDSB_INSTRUMENTED_ITEM_ATTRIBUTE);if(f){const t=this.instrumentedPropsDict[f];t&&n.push(t)}}return n}getShownComponents(){const n={},t=this.getInstrumentProps();t&&t.forEach(t=>{switch(t.scenario){case"DismissMeetingPrep":case"PositiveMeetingPrep":case"NegativeMeetingPrep":n.MeetingPrep=!0;break;case"DismissFileRequest":case"PositiveFileRequest":case"NegativeFileRequest":n.FileRequest=!0;break;default:n[t.scenario]=!0}});const i=Object.keys(n).sort();return i.unshift("MainPage"),i.join("_")}createInstrumentedItem(t){const i=n.InstrumentedItem.createInstrumentedItemKvalueOverride(this.currentKValue++,t,22);return this.addInstrumentedItemToDict(i),i}safeInstrumentDSB(){const t=n.SequenceNumberManager.getSequenceNumber(),i=t==0;i||n.safeExecute(()=>n.InstrumentationHelper.instrumentDSB(),"MsbDsb.safeInstrumentDSB")}addInstrumentedItemToDict(n){const t=n.getQsCode(),i=n.getKValue(),r=this.getInstrumentedItemKey(t,i);this.instrumentedPropsDict[r]={scenario:t,instrumentedItem:n}}getInstrumentedItemKey(n,t){return`${n}-${t}`}async getLastInstrumentedTimeAsync(){return this.cacheManager.getDataAsync(i)}async shouldSendInstrumentationAsync(){var t;if(!n.config.msbDsbIntruGleam)return!1;const i=(t=await this.getLastInstrumentedTimeAsync())!==null&&t!==void 0?t:0,u=n.getCurrentTime();return!i||u-i>=r}}t.InstrumentationManager=u})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){const y=864e5,p=6e4,i="badging-showing",r="badging-last-shown-time",w=["MeetingPrep","MeetingPrep_Win11"],b=["FileRequest","FileRequest_NoSparkles"],k=["IndustryNews"],d=["Baseline_BriefCase","Baseline_BriefCase_Badging","Baseline_BriefCase_Win11"],g=["Baseline_Edu","Baseline_Edu_Badging"],nt=["RoundedTenantLogo","RoundedTenantLogo_Badging"],tt=["RectangularTenantLogo","RectangularTenantLogo_Badging"],it=3,u="ODSWG.87579794-8a2e-4319-9f40-25c4af4ca0cf",f="ODSWG.9ef935da-2197-49cb-8fe4-78fab4b37ffb",rt="ODSWG.7cbb45ce-7972-4523-a9a9-443fedf0ef21",ut="ODSWG.d1ddd187-860b-49c1-9379-bb63c0037f3a",ft="ODSWG.955bdca2-d2a5-41d0-9a5c-c9172f1067a0",et="ODSWG.705b961c-e600-4c79-9cb6-2e24908bfc56",e="ODSWG.a0742075-b34d-4c6c-9633-b6470cdde61a",o="ODSWG.71700da8-645f-4eba-8761-a12591b53739",s="ODSWG.82f218b9-7c8c-4fce-ba8e-c93f665f076c",h="ODSWG.36161f0d-6f80-4877-ace8-af6d4d11d9f3",ot="ODSWG.b085da96-47e8-4ac1-bf6e-91aeeeca8839",st="ODSWG.fcb2fdb0-c330-4ca4-9703-1453195dd7ff",c="ODSWG.44c8274a-2bcb-47f6-8aee-36512012abf9",l="ODSWG.3ed5d221-00c2-43d0-9bb3-28e8867d76f8",a="ODSWG.1f8e27bf-2a37-4a5d-a543-f23344f44bff",v="ODSWG.95bb7a39-91b7-4dc0-a37f-961584fb733a";class ht{constructor(n){this.cacheManager=n;this.rotationPointer=0}getDynamicSearchBoxContent(){return this.dynamicSearchBoxContent}setMainPageGleamData(n){if(n){const t=n===null||n===void 0?void 0:n.scenario,i=this.getDefaultScenarioGleamData(t),r=this.getBaselineGleamData(n);n.gleamDataPair={scenarioGleamData:i,baselineGleamData:r}}}async setGleamContentToDisplayAsync(t,i,r,u,f){let o,s=!1;this.isGleamValid(t===null||t===void 0?void 0:t.scenarioGleamData)?(o=t.scenarioGleamData,s=!0):o=this.isGleamValid(t===null||t===void 0?void 0:t.baselineGleamData)?t.baselineGleamData:this.getDefaultFallbackGleamData();const h=Object.assign({},o.gleamContent),e=Object.assign({},o,{gleamContent:h});if(n.config.msbDsbUseDefaultGhostText?e.description=this.getWindowsDefaultGhostText():n.config.msbEnableStaticDSBGhostText?e.description=this.getBaselineDescription():n.config.msbEnableDSBGhostText||(e.description=""),n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbLastUpdateTimeInSearchBar){const n=`[${(new Date).toLocaleTimeString()}${f?"*":""}] `;e.description=n+e.description}if(n.config.msbDsbBadging){let i=n.config.msbDsbBadgingSuppressionTimeInHours*36e5;(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbBadgingSupressionPeriodInMin)&&(i=n.TestHookUrlParameters.msbDsbBadgingSupressionPeriodInMin*6e4);const r=await n.msbDsbHost.getMtHasNewContentAsync();let t=!1;if(r&&(!s||n.config.msbDsbBadgingDynamic)){const r=n.getCurrentTime(),u=await this.getBadgingLastShownEndTimeAsync();r-u>i&&(t=!0)}t&&(e.gleamContent.lightGleam.startsWith("https")?(e.gleamContent.lightGleam=n.getImageUrl(ot),e.gleamContent.darkGleam=n.getImageUrl(st)):(e.gleamContent.lightGleam=n.MsbDsb.addBadgeToSvgLightMode(e.gleamContent.lightGleam),e.gleamContent.darkGleam=n.MsbDsb.addBadgeToSvgDarkMode(e.gleamContent.darkGleam)));e.isBadgeAdded=t;await this.setIsBadgingShowingAsync(t)}await this.checkIsGleamMismatchedAsync(e,u,r,f);this.setWsbSearchBoxContent(e,i)}async updateBadgingInShownAsync(t){const i=await this.getIsBadgingShowingAsync();if(i){const i=n.getCurrentTime();await this.setIsBadgingShowingAsync(!1);await this.setBadgingLastShownEndTimeAsync(i);await this.setGleamContentToDisplayAsync(t.gleamDataPair,!1,"updateBadgingAfterWsbOpen",t===null||t===void 0?void 0:t.scenario,!1)}}getBaselineGleamData(n){var i;let t=(i=n===null||n===void 0?void 0:n.gleamDataPair)===null||i===void 0?void 0:i.baselineGleamData;return(t===null||t===void 0?void 0:t.gleamContent)||(t=this.getDefaultBaselineGleamData()),t}getDefaultScenarioGleamData(n){return n=="Baseline"?undefined:{gleamContent:this.getDefaultScenarioGleams(n),longExpiration:!1,scenario:n,description:this.getScenarioDescription(n)}}getDefaultBaselineGleamData(){return{gleamContent:this.getDefaultScenarioGleams("Baseline"),longExpiration:!0,scenario:"Baseline",description:this.getScenarioDescription("Baseline")}}getDefaultFallbackGleamData(){const t=this.getDefaultBaselineGleamData();return(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbLastUpdateTimeInSearchBar)&&(t.description=`[fallback] ${t.description}`),t}isGleamValid(n){var t;return!!((t=n===null||n===void 0?void 0:n.gleamContent)===null||t===void 0?void 0:t.lightGleam)&&!!(n===null||n===void 0?void 0:n.description)}setWsbSearchBoxContent(t,i){var u,f;const{description:e,longExpiration:h,gleamContent:r,scenario:o}=t;(r===null||r===void 0?void 0:r.lightGleam)||n.msbDsbLogger.logGleamDataContentError("gleamContent.lightGleam is empty",t.scenario,(u=t.gleamContent)===null||u===void 0?void 0:u.gleamKey);const c=n.msbDsbHost.getUpdateIntervalMins(),s=h?n.getCurrentTime()+y:n.getCurrentTime()+c*2*p;const l={placeholderText:e,lightGleamDataOrUrl:r===null||r===void 0?void 0:r.lightGleam,darkGleamDataOrUrl:r===null||r===void 0?void 0:r.darkGleam,expirationTime:s,gleamSize:(r===null||r===void 0?void 0:r.isBigGleam)?1:0},a=((f=r===null||r===void 0?void 0:r.lightGleam)===null||f===void 0?void 0:f.startsWith("http"))?1:0,v={gleamFormat:a,contentKey:this.getGleamKey(t)};this.dynamicSearchBoxContent={attributes:v,parameters:l};n.msbDsbHost.instrumentationManager.instrumentGleamAsync(o,this.getGleamKey(t),n.msbHost.tenantHasLogo(),!!i);n.logToMC("Bing_QF_MsbDsbGleamManager","MsbGleamManager_updateContent","logMsbDsbGleamManager");n.dsbManager.updateDynamicSearchBoxContent()}async getIsBadgingShowingAsync(){return await this.cacheManager.getDataAsync(i)}async setIsBadgingShowingAsync(n){await this.cacheManager.setDataAsync(i,n)}async getBadgingLastShownEndTimeAsync(){var n;return(n=await this.cacheManager.getDataAsync(r))!==null&&n!==void 0?n:0}async setBadgingLastShownEndTimeAsync(n){await this.cacheManager.setDataAsync(r,n)}getGleamKey(n){var t;const i=(t=n===null||n===void 0?void 0:n.gleamContent)===null||t===void 0?void 0:t.gleamKey,r=(n===null||n===void 0?void 0:n.isBadgeAdded)?"_Badging":"";return`${i}${r}`}getDefaultScenarioGleams(t){const i=n.config.useCobaltCSS?this.getDefaultMeetingPrepWin11Gleam():this.getDefaultMeetingPrepGleam(),r=n.config.useCobaltCSS?this.getDefaultFileRequestNoSparklesGleam():this.getDefaultFileRequestGleam(),u=this.getDefaultIndustryNewsGleam();switch(t){case"MeetingPrep":return i;case"FileRequest":return r;case"IndustryNews":return u;default:return this.getDefaultBaselineGleam()}}getDefaultBaselineGleam(){return n.msbHost.isEduTenant()?this.getEduDefaultBaselineGleam():n.config.msbDsbGleamRotation?this.getIterationBaselineGleam():n.config.msbFixedPeopleGleam?this.getDefaultBaselineSvgPeopleGleam():n.config.msbFixedDocumentGleam?this.getDefaultBaselineSvgFileGleam():n.config.msbDsbPinGleam?this.getPinGleam():this.getDefaultBaselineBriefcaseGleam()}getIterationBaselineGleam(){const t=n.config.useCobaltCSS?this.getDefaultWin11RotationGleams():this.getDefaultWin10RotationGleams();return t[this.rotationPointer++%it]}getPinGleam(){switch(n.msbDsbHost.getLastSelectedScope()){case n.Scope.People:return this.getDefaultBaselineSvgPeopleGleam();case n.Scope.Documents:return this.getDefaultBaselineSvgFileGleam();default:return this.getDefaultBaselineBriefcaseGleam()}}getScenarioDescription(n){let t="";switch(n){case"MeetingPrep":t=this.getMeetingPrepDescription();break;case"FileRequest":t=this.getFileRequestDescription();break;case"IndustryNews":t=this.getIndustryNewsDescription();break;default:t=this.getBaselineDescription()}return t}getBaselineDescription(){const t=n.Host.getLocString("BaselineScenarioDescriptionDefault");return n.Host.getLocString("BaselineScenarioDescriptionSearchTenantAndPC",t)}getWindowsDefaultGhostText(){return n.Host.getLocString("WindowsDefaultGhostText")}getMeetingPrepDescription(){const t=n.Host.getLocString("MeetingPrepScenarioDescriptionDefault");return n.Host.getLocString("MeetingPrepScenarioDescriptionPattern",t)}getFileRequestDescription(){const t=n.Host.getLocString("FileRequestScenarioDescriptionDefault");return n.Host.getLocString("FileRequestScenarioDescriptionPattern",t)}getIndustryNewsDescription(){const t=n.msbHost.getTenantName()||n.Host.getLocString("CompanyNamePlaceholder");return n.Host.getLocString("IndustryNewsScenarioDescriptionPattern",t)}async checkIsGleamMismatchedAsync(t,i,r,u){const o=n.msbHost.tenantHasLogo(),f=this.getGleamKey(t),s=n.msbHost.isEduTenant();let e=!1;switch(i){case"MeetingPrep":e=w.includes(f);break;case"FileRequest":e=b.includes(f);break;case"IndustryNews":e=k.includes(f);break;case"Baseline":e=s?g.includes(f):o&&n.msbHost.features.isServerGleamEnabled()?this.isTenantLogoMatched(f):d.includes(f);break;default:e=!1}if(!e){const t=await this.getLastMTRequestInfoAsync();n.msbDsbLogger.logGleamMismatchError(r,i,o,f,t,u)}}isTenantLogoMatched(t){return n.config.undocked?nt.includes(t):tt.includes(t)}async getLastMTRequestInfoAsync(){const n=await this.cacheManager.getDataAsync(t.DataContext.LastSuccessfulMTRequestKey),i=await this.cacheManager.getDataAsync(t.DataContext.LastMTRequestKey);return(n===null||n===void 0?void 0:n.traceId)==(i===null||i===void 0?void 0:i.traceId)?`${n===null||n===void 0?void 0:n.traceId};${n===null||n===void 0?void 0:n.timestamp}`:`${n===null||n===void 0?void 0:n.traceId};${n===null||n===void 0?void 0:n.timestamp};${i===null||i===void 0?void 0:i.traceId};${i===null||i===void 0?void 0:i.timestamp}`}getDefaultBaselineBriefcaseGleam(){return n.config.useCobaltCSS?this.getDefaultBaselineBriefcaseWin11Gleam():this.getDefaultBaselineBriefcaseWin10Gleam()}getDefaultBaselineSvgPeopleGleam(){return n.config.useCobaltCSS?this.getDefaultBaselineSvgPeopleWin11Gleam():this.getDefaultBaselineSvgPeopleWin10Gleam()}getDefaultBaselineSvgFileGleam(){return n.config.useCobaltCSS?this.getDefaultBaselineSvgFileWin11Gleam():this.getDefaultBaselineSvgFileWin10Gleam()}getDefaultMeetingPrepGleam(){return{lightGleam:n.getImageUrl(u),darkGleam:n.getImageUrl(u),isBigGleam:!0,gleamKey:"MeetingPrep"}}getDefaultMeetingPrepWin11Gleam(){return{lightGleam:n.getImageUrl(f),darkGleam:n.getImageUrl(f),isBigGleam:!0,gleamKey:"MeetingPrep_Win11"}}getDefaultFileRequestGleam(){return{lightGleam:n.getImageUrl(rt),darkGleam:n.getImageUrl(ut),isBigGleam:!0,gleamKey:"FileRequest"}}getDefaultFileRequestNoSparklesGleam(){return{lightGleam:n.getImageUrl(ft),darkGleam:n.getImageUrl(et),isBigGleam:!0,gleamKey:"FileRequest_NoSparkles"}}getDefaultIndustryNewsGleam(){return{lightGleam:n.getImageUrl(e),darkGleam:n.getImageUrl(e),isBigGleam:!0,gleamKey:"IndustryNews"}}getEduDefaultBaselineGleam(){return{lightGleam:n.getImageUrl(o),darkGleam:n.getImageUrl(o),isBigGleam:!0,gleamKey:"Baseline_Edu"}}getDefaultBaselineBriefcaseWin10Gleam(){return{lightGleam:n.getImageUrl(s),darkGleam:n.getImageUrl(s),isBigGleam:!0,gleamKey:"Baseline_BriefCase"}}getDefaultBaselineBriefcaseWin11Gleam(){return{lightGleam:n.getImageUrl(h),darkGleam:n.getImageUrl(h),isBigGleam:!0,gleamKey:"Baseline_BriefCase_Win11"}}getDefaultBaselineSvgPeopleWin10Gleam(){return{lightGleam:n.getImageUrl(c),darkGleam:n.getImageUrl(c),isBigGleam:!0,gleamKey:"Baseline_People_Win10"}}getDefaultBaselineSvgPeopleWin11Gleam(){return{lightGleam:n.getImageUrl(l),darkGleam:n.getImageUrl(l),isBigGleam:!0,gleamKey:"Baseline_People_Win11"}}getDefaultBaselineSvgFileWin10Gleam(){return{lightGleam:n.getImageUrl(a),darkGleam:n.getImageUrl(a),isBigGleam:!0,gleamKey:"Baseline_File_Win10"}}getDefaultBaselineSvgFileWin11Gleam(){return{lightGleam:n.getImageUrl(v),darkGleam:n.getImageUrl(v),isBigGleam:!0,gleamKey:"Baseline_File_Win11"}}getDefaultWin10RotationGleams(){return this.defaultWin10RotationGleams||(this.defaultWin10RotationGleams=[this.getDefaultBaselineBriefcaseGleam(),this.getDefaultBaselineSvgPeopleWin10Gleam(),this.getDefaultBaselineSvgFileWin10Gleam()]),this.defaultWin10RotationGleams}getDefaultWin11RotationGleams(){return this.defaultWin11RotationGleams||(this.defaultWin11RotationGleams=[this.getDefaultBaselineBriefcaseWin11Gleam(),this.getDefaultBaselineSvgPeopleWin11Gleam(),this.getDefaultBaselineSvgFileWin11Gleam()]),this.defaultWin11RotationGleams}}t.MsbDsbGleamManager=ht})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(i){class r{constructor(n,t){this.msbTokenManager=n;this.msbHttpWrapper=t}async getMainPageAsync(t){const i=n.msbHost.isEduTenant()?"api/v1/dsb/edufeed":"api/v1/dsb/feed",u=r.buildUrl(i),{token:f,tokenJwtExp:e,tokenRefreshTime:o}=await this.refreshMsbTokenAsync(),s={"X-Client-LocalTime":n.getDateWithTimezone()};return await this.msbHttpWrapper.sendHttpAsync({method:"POST",url:u,body:JSON.stringify(t),headers:s,token:f,tokenJwtExp:e,tokenRefreshTime:o})}async dismissAnswerAsync(t,i){const r={answerType:t,answerId:i};const u=n.msbHost.urlUtils.getDsbUrl("api/v1/dsb/feed/dismiss"),{token:f,tokenJwtExp:e,tokenRefreshTime:o}=await this.refreshMsbTokenAsync();await this.msbHttpWrapper.sendHttpAsync({method:"POST",url:u,body:JSON.stringify(r),token:f,tokenJwtExp:e,tokenRefreshTime:o})}async flushSubstrateLoggingEventsAsync(t){const i={events:t};const u=r.buildUrl("api/v1/dsb/feed/3sevents"),f={"X-Client-LocalTime":n.getDateWithTimezone()},{token:e,tokenJwtExp:o,tokenRefreshTime:s}=await this.refreshMsbTokenAsync();await this.msbHttpWrapper.sendHttpAsync({method:"POST",url:u,body:JSON.stringify(i),headers:f,token:e,tokenJwtExp:o,tokenRefreshTime:s})}async getGroupPhotoAsync(t){const i=n.msbHost.urlUtils.getMsbUrl("v3/search/group/photo"),r=this.buildPhotoFetchPostRequestBody(t),{token:u,tokenJwtExp:f,tokenRefreshTime:e}=await this.refreshMsbTokenAsync(),{result:o}=await this.msbHttpWrapper.sendHttpAsync({method:"POST",url:i,body:r,token:u,tokenJwtExp:f,tokenRefreshTime:e});return o}async getFeedItemPreviewAsync(t,i,r,u){const f=n.msbHost.urlUtils.getDsbUrl("api/v1/dsb/feed/preview"),e=`previewType=${t}&previewUrl=${encodeURIComponent(i)}&previewProxyUrl=${encodeURIComponent(r)}&size=${u}`,o=`${f}?${e}`;const{token:s,tokenJwtExp:h,tokenRefreshTime:c}=await this.refreshMsbTokenAsync(),{result:l}=await this.msbHttpWrapper.sendHttpAsync({method:"GET",url:o,token:s,tokenJwtExp:h,tokenRefreshTime:c});return l}async getFileIconAsync(i){const r=n.getIconForTypeAsync(t.DEFAULT_FILE_ICON,"."+i,0);return new Promise(n=>{r(4,t=>{n(t)})})}async refreshMsbTokenAsync(){const t="MsbServiceClient::refreshMsbTokenAsync";if(n.config.msbEnableAccountManager)try{const{token:t,jwtExp:i,lastRefreshTime:r}=await n.msbHost.accountManager.refreshMsbTokenAsync();return{token:t,tokenJwtExp:i,tokenRefreshTime:r}}catch(i){throw new n.MsbNoMsbTokenError(t);}else return new Promise((i,r)=>{this.msbTokenManager.refreshMsbTokenAndCall(n=>{var t,r;const u=(t=BingAtWork===null||BingAtWork===void 0?void 0:BingAtWork.wsb)===null||t===void 0?void 0:t.wsbAccessTokenJwtExp,f=(r=BingAtWork===null||BingAtWork===void 0?void 0:BingAtWork.wsb)===null||r===void 0?void 0:r.wsbAccessTokenRefreshTime;return i({token:n,tokenJwtExp:u,tokenRefreshTime:f})},()=>r(new n.MsbNoMsbTokenError(t)),(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?[t]:undefined,t)})}buildPhotoFetchPostRequestBody(n){const t={clientContext:{clientType:"Wsb"},id:n};return JSON.stringify(t)}static buildUrl(n){switch(n){case"api/v1/dsb/feed":case"api/v1/dsb/edufeed":return r.buildFeedUrl(n);case"api/v1/dsb/feed/3sevents":return r.build3SEventMTUrl(n)}return undefined}static build3SEventMTUrl(t){const i=n.msbHost.urlUtils.getDsbUrl(t),u=r.getFeatureParams(t);return u!=null?`${i}?&${u}`:i}static buildFeedUrl(t){let i="";i=(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbResponseType)?`responseType=${n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbDsbResponseType}`:`responseType=0`;(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbIconType)&&(i=`${i}&iconType=${n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbIconType}`);const u=r.getFeatureParams(t);u!=null&&(i=`${i}&${u}`);const f=n.msbHost.urlUtils.getDsbUrl(t);return i?`${f}?${i}`:f}static getFeatureParams(n){const t=r.getFeatureFlagsToSend(n);if(t.length>0){const n=t.join(",");return`setflight=${n}&features=${n}`}return undefined}static getFeatureFlagsToSend(t){function i(n,t){n&&r.push(t)}const r=[];switch(t){case"api/v1/dsb/feed":case"api/v1/dsb/edufeed":{i(n.config.msbDsbFileReq,"msbdsbfilereq");i(n.config.msbDsbMtCacheOff,"msbdsbmtcacheoff");i(n.config.msbDsbIndustryNews&&n.isMsbInternalTenant(),"msbdsbmtindustrynews");i(n.config.msbDsbIndustryNewsTimeFrameOff,"msbdsbnwstmoff");i(n.config.msbDsbFileReqTeamsIntent,"msbdsbfrteam");i(!n.config.msbDsbUseServerGleam,"msbdsbtenantsetoff");i(n.config.undocked,"msbdsbmtwin11");i(n.config.msbDsbWide,"msbdsbwide");i(n.config.msbDsbPopularSearchSuggestionCardEnabled,"msbdsbpopss");i(n.config.msbDsbAcronymsTenantLevel,"msbdsbacrntnt");i(n.config.msbDsbAcronymsUserLevel,"msbdsbacrnusr");i(n.config.msbDsbAcronymsAll,"msbdsbacrnmix");i(n.config.msbDsbFileHero,"msbdsbfilehero");i(n.config.msbDsbFileSearchSuggestionsEnabled,"msbdsbfss");i(n.config.msbDsbFeedLikePeople,"msbdsbfeedlikeppl");i(n.config.msbDsbPeopleExplanationsEnabled,"msbdsbpxai");i(n.config.msbDsbPeopleShufflingEnabled,"msbdsbpshuf");i(n.config.msbDsbOrgV2,"msbdsborgv2");i(n.config.msbEnableIconUrl,"msbdsbrtnurllg");n.msbHost.isEduTenant()&&(i(n.config.msbDsbEnableEduScenario,"msbdsbeduscon"),i(n.config.msbDsbEnableAssignmentWebUrl,"msb3samwburl"));const t=n.config.msbDsbMaxM365Cards;i(t>=4,`msbdsbc${t}feed`);break}}return r}}i.MsbServiceClient=r})(i=t.ServiceClients||(t.ServiceClients={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){var i;(function(t){class i{composeDSBUrlParams(t){const i=n.getCurrentDate(),r=i.toLocaleString("en-US"),u=`clientDateTime=${encodeURIComponent(r)}&cc=${n.Host.getRegion()}&setlang=${n.getCurrentLanguage()}&dsbschemaversion=1.1`;return i<n.DateTimeReference&&n.log(`getCurrentDate() return incorrect time! getCurrentDate(): '${r}' `),n.msbHost.urlUtils.insertParameter(t,u)}async getImageOfTheDayAsync(){let t="/dsb/scenario?name=ImageOfTheDayOnly";t=this.composeDSBUrlParams(t);let i;try{const r=await fetch(t,{headers:n.Host.getCustomHeaders(null)});if(r.ok){try{i=await r.json()}catch(u){return n.DSBLogError("fetchWSBDSBCurrentImageOfTheDayData",`failed to read wsb dsb response ${JSON.stringify(i)}. Url: '${t}': ${u}.`),null}if(!i)throw`Invalid DSB content returned from '${t}'`;return i}n.DSBLogError("fetchWSBDSBCurrentImageOfTheDayData",`failed to fetch wsb dsb from ${t}`)}catch(r){return n.DSBLogError("fetchWSBDSBCurrentDayImageOfTheDayData",`failed to parse wsb dsb response ${JSON.stringify(i)}. Url: '${t}': ${r}.`),null}return null}}t.CommercialDsbServiceClient=i})(i=t.ServiceClients||(t.ServiceClients={}))})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){class t{constructor(){this.targetIndexAfterMoveFocus=null}reapplyKeyboardFocus(n){var i,r,u,f,e,o,s;const t=(i=this.selectableElementGroups)===null||i===void 0?void 0:i.findIndex(t=>{var i;return((i=t[0])===null||i===void 0?void 0:i.id)===n});if(t!==undefined){const c=(f=(u=(r=this.selectableElementGroups[t-1])===null||r===void 0?void 0:r[0])===null||u===void 0?void 0:u.id)===null||f===void 0?void 0:f.includes("msbdsb-dynamic-card");let h=t-1;if(!c){const n=(s=(o=(e=this.selectableElementGroups[t-2])===null||e===void 0?void 0:e[0])===null||o===void 0?void 0:o.id)===null||s===void 0?void 0:s.includes("msbdsb-feed-dismiss"),i=this.selectableElementGroups.length-1===t;i&&n&&(h=t-3)}this.targetIndexAfterMoveFocus=h}}buildInteractionModel(n){this.selectableElementGroups=this.buildInteractionModelInternal(n)}getSelectableItems(){const n=[];return this.selectableElementGroups?n.concat(...this.selectableElementGroups):n}getSelectableItemsByGroup(){var n;return(n=this.selectableElementGroups)!==null&&n!==void 0?n:[]}resetDismissMode(){this.targetIndexAfterMoveFocus=null}createNavTabNodeIterator(){const t=_ge(n.ROOT_CONTAINER_ID);return document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,{acceptNode(n){const t=n;return(t===null||t===void 0?void 0:t.getAttribute("tabindex"))=="-1"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}})}findAndUpdateSelectedItemId(){var n;const t=this.getSelectableItems().filter(n=>n.selected);this.prevSelectedItemId=(n=t===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.id}createSelectableItem(t,i=false){return{dsb:!0,id:t.id,selected:i,onSelected:()=>t.classList.add(n.MDSB_KEYBOARD_FOCUS_CLASS),onUnselected:()=>t.classList.remove(n.MDSB_KEYBOARD_FOCUS_CLASS)}}delayFocusingItem(t){sb_st(()=>{t.classList.add(n.MDSB_KEYBOARD_FOCUS_CLASS),t.focus()},1)}updateSelectedItemFocus(n,t){n.selected=!0;this.delayFocusingItem(t);this.resetDismissMode()}buildInteractionModelInternal(t){const r=[];t&&this.findAndUpdateSelectedItemId();const o=this.createNavTabNodeIterator();let e,u,i,f;while(e=o.nextNode()){const o=e;if(o.classList.contains(n.MDSB_LIST_CONTAINER_CLASS)){(i===null||i===void 0?void 0:i.length)&&r.push([...i]);u=o;i=[];continue}const s=o.id===this.prevSelectedItemId,t=this.createSelectableItem(o,s);if(t.selected&&this.delayFocusingItem(o),u===null||u===void 0?void 0:u.contains(e)){const f=r.length;(i===null||i===void 0?void 0:i.length)===0&&f===this.targetIndexAfterMoveFocus&&this.updateSelectedItemFocus(t,o);u.hasAttribute(n.MDSB_DELAY_BLUR_ATTRIBUTE)&&(t.hiddenAfterFocus=!0);u.hasAttribute(n.MDSB_PREVENT_SCROLL_ATTRIBUTE)&&(t.preventScroll=!0);t.id&&(i===null||i===void 0?void 0:i.push(t));continue}else(i===null||i===void 0?void 0:i.length)&&(r.push([...i]),u=undefined,i=[]);if(o.classList.contains("dismiss")){f=t;continue}else if(f&&o.classList.contains("msbdsb_feed_card_content")){const n=r.length;n===this.targetIndexAfterMoveFocus&&this.updateSelectedItemFocus(t,o);r.push([t]);r.push([f]);f=undefined}else r.length===this.targetIndexAfterMoveFocus&&this.updateSelectedItemFocus(t,o),r.push([t])}return(i===null||i===void 0?void 0:i.length)&&r.push([...i]),r}}n.KeyNavManager=t})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(n){n.ROOT_CONTAINER_ID="msb_dsb_root";n.MAINPAGE_CONTAINER_ID="msbdsb-mp";n.MAINPAGE_CONTAINER_SCROLL="msbdsb-mp-scroll";n.MYORGCHART_EXPANSION_STORAGE_KEY="msbdsb_moce";n.EDUCLASSES_EXPANSION_STORAGE_KEY="msbdsb_edu_cls_exp";n.EDUASSIGNMENTS_EXPANSION_STORAGE_KEY="msbdsb_edu_assi_exp";n.MDSB_KEYBOARD_FOCUS_CLASS="msbdsb_keyboard_selected";n.MDSB_LIST_CONTAINER_CLASS="msbdsb-keyboard-selectable-group";n.MDSB_INSTRUMENTED_ITEM_ATTRIBUTE="data-msb-dsb-inst-key";n.MDSB_DELAY_BLUR_ATTRIBUTE="data-msb-dsb-delay-blur";n.MDSB_PREVENT_SCROLL_ATTRIBUTE="data-msb-dsb-prevent-scroll";n.MDSB_BING_TRANSFER_ATTRIBUTE="data-msb-dsb-bing-transfer";n.MDSB_FEEDBACK_ELEMENT_CLASS="msbdsb-instrumented-feedback-element";n.VISIBLE_TOOLTIP_CLASS="msb-dsb-item-with-visible-feedback";n.TAB_NAVIGATION_TAB_INDEX=-1;n.RECOMMENDED_PEOPLE_DISPLAY_COUNT=4;n.PEOPLEHERO_PERSON_DISPLAY_COUNT=1;n.NUMBER_OF_PROFILE_COLOURS=30;n.MIN_NUMBER_OF_HERO_ITEMS=3;n.DEFAULT_SUGGESTION_CARD_CHAR_LIMIT=20;n.FILE_SEARCH_SUGGESTIONS_CHAR_LIMIT=17})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){var t;(function(t){t.DEFAULT_FILE_ICON=n.ScopeConfig[n.Scope.Documents].icon;t.MIDDLE_TIER_REFRESH_RATIO=2;t.BADGING_MT_HAS_NEW_CONTENT_KEY="badging-mt-new-content";const u=20,f=360,e="mdsb-last-refresh",i="last-scope",r="wide";class o{constructor(){this.inWsbAccountSwitching=!1;this.waitingForTenantEnabled=!1;this.isVisible=!1;this.dwellStartTime=-1;this.dwellEndTime=-1;this.dwellTime=-1;this.rootContainer=_ge(t.ROOT_CONTAINER_ID);this.isWideLayoutEnabled()&&this.setWideModeStyle(!0);this.keyNavManager=new t.KeyNavManager;n.msbDsbLogger=new t.MsbDsbLogger;n.msbDsbSubstrateLogger=new t.MsbDsbSubstrateLogger;this.cacheManager=new t.DataContext.CacheManager;this.msbServiceClient=n.config.msbDsbMockServiceClients?new t.ServiceClients.MsbServiceClientMock:new t.ServiceClients.MsbServiceClient(n.msbHost.tokenManager,n.msbHost.httpWrapper);this.commercialDsbServiceClient=n.config.msbDsbMockCommercialServiceClients?new t.ServiceClients.CommercialDsbServiceClientMock:new t.ServiceClients.CommercialDsbServiceClient;this.externalDataManager=new t.DataContext.ExternalDataManager(this.msbServiceClient,this.cacheManager,this.commercialDsbServiceClient);this.mainPageLayoutManager=n.config.msbDsbInformationArchitecture?new t.DataContext.MainPageLayoutManager:undefined;this.instrumentationManager=new t.InstrumentationManager(this.cacheManager);const i=new t.DataContext.RenderingMonitor(this.externalDataManager);this.recommendedPeopleViewDataManager=new t.DataContext.RecommendedPeopleViewManager(this.cacheManager);this.viewDataManager=new t.DataContext.ViewDataManager(this.externalDataManager,i,this.recommendedPeopleViewDataManager,this.mainPageLayoutManager);this.gleamManager=new t.MsbDsbGleamManager(this.cacheManager);this.loadLastSelectedScopeCacheAsync();this.msbDataModule=_w.BingAtWork;n.msbDsbFeedbackTracker=new t.MsbDsbFeedbackTracker(this.cacheManager,this.externalDataManager);n.Host.bindBootstrapDone(()=>this.render());n.Host.bindDismissed(()=>{n.isDynamicSearchContentPossible()&&this.externalDataManager.flushSubstrateLoggingEventsAsync(),n.config.wsbWebView2&&this.setVisibility(!1)});n.Host.bindDynamicSearchBoxUpdate(async()=>{if(this.clientQfBackgroundRefreshResolver=null,this.clientQfBackgroundRefreshRejector){const n=this.clientQfBackgroundRefreshRejector;this.clientQfBackgroundRefreshRejector=null;n()}if(this.shouldTryRefreshToken()){const t=()=>{var t;const i=n.msbHost.qfUtils.isClientQfBackgroundRefreshEnabled()&&this.msbDataModule&&typeof this.msbDataModule.fetchDataAndRefreshTrie=="function";if(i){this.clientQfBackgroundRefreshed=new Promise((n,t)=>{this.clientQfBackgroundRefreshResolver=n,this.clientQfBackgroundRefreshRejector=t});const n=n=>{const t=n===undefined||n;if(this.clientQfBackgroundRefreshResolver&&t){const n=this.clientQfBackgroundRefreshResolver;this.clientQfBackgroundRefreshResolver=null;this.clientQfBackgroundRefreshRejector=null;n()}};(t=this.msbDataModule)===null||t===void 0?void 0:t.fetchDataAndRefreshTrie(t=>{n(t)},t=>{n()})}};if(n.config.msbEnableAccountManager)try{await n.msbHost.accountManager.refreshMsbTokenAsync();t()}catch(i){}else return new Promise(i=>{n.msbHost.tokenManager.refreshMsbTokenAndCall(()=>{t(),i()},()=>{i()},(n.Host===null||n.Host===void 0?void 0:n.Host.isAuthInvestigation())?["MsbDsbHost::bindDynamicSearchBoxUpdate"]:undefined,"BindDynamicSearchBoxUpdate")})}});n.Host.bindShown(async()=>{if(n.msbHost.switchScope(),this.isMsbDsbShown()&&(this.externalDataManager.isBundleReloadColdStart()||this.externalDataManager.log3SRenderEvents(!1,!0),n.config.msbDsbBadging)){await this.setMtHasNewContentAsync(!1);const n=this.externalDataManager.getMainPageData();await this.gleamManager.updateBadgingInShownAsync(n)}});n.config.msbEnableAccountManager?(n.getAccessTokenManager().bindSelectedAccountChangedBeforeConnect(()=>{this.inWsbAccountSwitching=!0}),n.msbHost.accountManager.bindAccountStatusChanged(async t=>{this.inWsbAccountSwitching=!1;const{changeType:i}=t;i==="AccountSwitchStarted"&&this.refresh(2,3);(i==="TenantSettingsDone"||i==="TenantSettingsError")&&n.dsbManager.forceRefresh()})):(n.Host.bindAccountChanged(async()=>{await this.externalDataManager.clearMiddleTierResponseAsync()}),n.msbHost.tenantManager.bindTenantEnabled(()=>{n.isDynamicSearchContentBaseEnabled()&&this.checkAvailability()}))}isWideLayoutEnabled(){return n.config.msbDsbWide&&n.RuntimeConfig.AlwaysWide}isPeopleExplanationEnabled(){const t=n.uiLanguageCache.toLowerCase().startsWith("en-");return n.config.msbDsbPeopleExplanationsEnabled&&t}setWideModeStyle(n){n?this.rootContainer.classList.add(r):this.rootContainer.classList.remove(r)}isMsbDsbShown(t){const i=n.shouldShowDSBLayout(t);return i&&this.isEnabledInternal()}bindQueryChange(){n.Host.bindQueryChangedOrInitialized(async i=>{if(this.isMsbDsbShown(i))if(document.querySelector(`[data-id=${t.MAINPAGE_CONTAINER_ID}]`)||this.externalDataManager.isBundleReloadColdStart()){const r=this.instrumentationManager.getShownComponents(),i=await this.cacheManager.getDataAsync(t.DataContext.MiddleTierResponseTimeCacheKey),u=i==undefined?undefined:{cacheAge:n.getCurrentTime()-i};n.msbDsbLogger.logMainPageShownEvent(r,u);n.InstrumentationHelper.logClientInstEvent("ClientInst","MainPageShown",n.SequenceNumberManager.getSequenceNumber())}else n.msbDsbLogger.logError("Wsb Dsb Show DSB Content Failed"),n.InstrumentationHelper.logClientInstEvent("ClientInst","MainPageBlankShown",n.SequenceNumberManager.getSequenceNumber())})}isEnabled(){const t=this.isEnabledInternal();return n.msbHost.isTenantMsbEnabled()||(this.waitingForTenantEnabled=!0),t!==null&&t!==void 0?t:!1}isEnabledInternal(){return this.isOffWorkHour()?!1:n.msbHost.isTenantMsbEnabled()&&!n.msbHost.isGccTenant()}isOffWorkHour(){var t,i;const r=n.getCurrentDate().getHours(),u=(t=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbWorkStartHour)!==null&&t!==void 0?t:8,f=(i=n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.dsbWorkEndHour)!==null&&i!==void 0?i:17;return n.config.msbDsbOffHour&&(r<u||r>=f)}getUpdateIntervalMins(){return n.msbHost.isEduTenant()?f:u}getDynamicSearchBoxContent(){return this.gleamManager.getDynamicSearchBoxContent()}async refresh(t,i){if(!this.inWsbAccountSwitching)try{if(this.isEnabled()){const r=this.createRefreshParameters(t,i);if(r.shouldFetch&&!this.externalDataManager.canFetchMainPageData())return;n.LightweightStorage.setItem(e,n.getCurrentTime().toString());const u=n.getCurrentTime();n.msbDsbLogger.startNewRefresh(u);n.msbDsbSubstrateLogger.startNewRefresh(u);await this.externalDataManager.refreshAsync(r)}}catch(r){n.msbDsbLogger.logError("Wsb Dsb Uncaught Refresh Error",undefined,n.stringifyError(r),"MsbDsbHost::refresh")}}setVisibility(t){this.isVisible=t;n.setVisibility(this.rootContainer,t)}getVisibility(){return this.isVisible}safeCallAllowSuspension(){const t=()=>{sb_st(()=>{n.dsbManager.allowSuspension()},1)};if(this.clientQfBackgroundRefreshResolver&&this.clientQfBackgroundRefreshed){const n=this.clientQfBackgroundRefreshed;this.clientQfBackgroundRefreshed=null;n.then(()=>t()).catch(()=>{})}else t()}getSelectableItems(){var n,t;return(t=(n=this.keyNavManager)===null||n===void 0?void 0:n.getSelectableItems())!==null&&t!==void 0?t:[]}getSelectableItemsByGroup(){var n,t;return(t=(n=this.keyNavManager)===null||n===void 0?void 0:n.getSelectableItemsByGroup())!==null&&t!==void 0?t:[]}hasContent(){return!0}getCodexStatus(){return""}getInstrumentProps(){return this.instrumentationManager.getInstrumentProps()}getLocString(t,...i){return n.Host.getLocString(t,...i)}setLastSelectedScope(t){n.Host.switchToScope(t);this.setLastSelectedScopeCacheAsync(t);n.dsbManager.forceRefresh()}getLastSelectedScope(){return this.lastSelectedScope}async setMtHasNewContentAsync(n){await this.cacheManager.setDataAsync(t.BADGING_MT_HAS_NEW_CONTENT_KEY,n)}async getMtHasNewContentAsync(){return await this.cacheManager.getDataAsync(t.BADGING_MT_HAS_NEW_CONTENT_KEY)}setWsbQuery(t,i){var r,u;const f=(u=(r=n.ScopeConfig===null||n.ScopeConfig===void 0?void 0:n.ScopeConfig[i])===null||r===void 0?void 0:r.prefixes)===null||u===void 0?void 0:u[0],e=f?`${f}: ${t}`:t;n.Host.reformulateNonForcedMiniSerp(e,!0,undefined);n.Host.searchBoxHasFocus()||n.Host.setFocusInSearchBox(null,"msbDsb setWsbQuery")}getFormCode(t){return n.mapOSFormCode(t?"EDSB10":"MDSB10")}updateInteractionModel(n){var t;(t=this.keyNavManager)===null||t===void 0?void 0:t.buildInteractionModel(n)}getSuggestionsData(){return this.externalDataManager.getSuggestionsData()}async dismissAnswerAsync(n,t,i){await this.externalDataManager.dismissAnswerAsync(t,n,i)}getDismissedAnswers(){var n;return(n=this.externalDataManager.getDismissalHistory().dismissedAnswers)!==null&&n!==void 0?n:[]}createRefreshParameters(n,t){const i=(n&1)==1,r=i&&t!=2,u=(n&6)==2,f=t===1;return{shouldFetch:r,shouldRender:u,isBackgroundUpdate:f}}render(){n.safeExecute(()=>ReactDOM.render(React.createElement(t.Components.MsbDsbContainer),this.rootContainer),"MsbDsbHost_render")}shouldTryRefreshToken(){const t=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();return t!=1?!1:(n.TestHookUrlParameters===null||n.TestHookUrlParameters===void 0?void 0:n.TestHookUrlParameters.msbForceDsbTokenRefresh)?!0:n.msbHost.isTenantRecentlyEnabled()}checkAvailability(){this.waitingForTenantEnabled&&this.isEnabled()&&(this.waitingForTenantEnabled=!1,n.dsbManager.forceRefresh())}setDwellStartTime(n){this.dwellStartTime=n}setDwellEndTime(n){this.dwellEndTime=n}getDwellStartTime(){return this.dwellStartTime}getDwellEndTime(){return this.dwellEndTime}resetDwellTime(){this.dwellStartTime=-1;this.dwellEndTime=-1;this.dwellTime=-1}setDwellTime(n){this.dwellTime=n}getDwellTime(){return this.dwellTime}isDwellStarted(){return this.getDwellStartTime()!=-1}async setLastSelectedScopeCacheAsync(t){const r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();r==1&&(this.lastSelectedScope=t,await this.cacheManager.setDataAsync(i,t))}async loadLastSelectedScopeCacheAsync(){const r=n.AccessTokenManager===null||n.AccessTokenManager===void 0?void 0:n.AccessTokenManager.getWindowsAccountType();if(r==1){const t=await this.cacheManager.getDataAsync(i);this.lastSelectedScope=t?t:n.config.msbDsbFirstPeopleGleam?n.Scope.People:n.config.msbDsbFirstFileGleam?n.Scope.Documents:undefined}}instrumentDSBDwellTime(){}}t.MsbDsbHost=o})(t=n.MsbDsb||(n.MsbDsb={}))}(WSB||(WSB={})),function(n){const t="RWQ";class i{constructor(){this.getName=()=>"MsbDsbRecentQueryDataProvider"}fetch(n,i){if(n.enabledDataSources[t]){const n=this.getResponse();i(t,n)}}onRemove(t,i){n.msbDsbHost&&n.msbDsbHost.dismissAnswerAsync(t,"RecentQueries",!0).then(()=>{i&&i()}).catch(()=>{})}getResponse(){var t;let i=this.getQueries();const r=(t=n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.getDismissedAnswers())!==null&&t!==void 0?t:[];return i=i.filter(n=>!r.includes(n.id)),{queries:i,remove:this.onRemove}}getQueries(){var t,i;return n.MockUrlParameters&&typeof n.MockedRecentWorkQueriesData=="object"?n.MockedRecentWorkQueriesData:(i=(t=n.msbDsbHost===null||n.msbDsbHost===void 0?void 0:n.msbDsbHost.getSuggestionsData())===null||t===void 0?void 0:t.recentQueries)!==null&&i!==void 0?i:[]}}n.MsbDsbRecentQueryDataProvider=i}(WSB||(WSB={})),function(n){class t{parse(t,i,r,u,f,e){var o;const s=[];for(const r of(o=u===null||u===void 0?void 0:u.queries)!==null&&o!==void 0?o:[]){if(!f())break;n.safeExecute(()=>{const f=this.createSuggestionFromQuery(t,r,i),e={verb:"HideFromRecentHistory",displayName:n.Host.getLocString("HideFromRecentHistory"),executeSync:()=>{u.remove&&(u.remove(r.id,()=>{n.Host.refreshCurrentPane()}),delete u.remove)},icon:{content:"&#xE711",type:2}};n.setExtraVerbs(f,()=>[e],!1);s.push(f)},"RecentQuerySuggestionsParser")}e(r,s,null)}getSuggestionTypeForQuery(n){switch(n.canvas){case"Outlook":return"RSHOUT";case"Teams":return"RSHTMS";case"Sharepoint":return"RSHSP";case"BingWorkSearch":return"RSHB"}}createSuggestionFromQuery(t,i,r){const f=this.getSuggestionTypeForQuery(i),e=`recent_query${r}_${i.id}`,o=n.InstrumentedItem.createInstrumentedItem(r,f),s={type:0,content:n.getImageUrl("ODSWG.442929a6-6384-4694-91ac-b644cd4c77a3")},h=()=>{n.Host.switchToScope(n.Scope.Work,i.query)},u=n.createSuggestion(t,i.query,undefined,s,f,i.query,o,998,r,!0,e,h,!1,e);return u.lastLaunchTime=i.searchTime,u.tooltip=i.query,u.narratorText=i.query,u}}n.MsbDsbRecentQuerySuggestionsParser=t}(WSB||(WSB={}))